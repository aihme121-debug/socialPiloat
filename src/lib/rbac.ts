import { UserRole } from '@prisma/client'

export const ROLE_HIERARCHY: Record<UserRole, number> = {
  SUPER_ADMIN: 100,
  TENANT_ADMIN: 90,
  ORGANIZATION_ADMIN: 80,
  TEAM_MANAGER: 70,
  CONTENT_CREATOR: 60,
  SOCIAL_MEDIA_MANAGER: 60,
  ANALYST: 40,
  VIEWER: 20,
}

export const PERMISSIONS = {
  // User Management
  MANAGE_USERS: 'manage_users',
  VIEW_USERS: 'view_users',
  EDIT_USERS: 'edit_users',
  DELETE_USERS: 'delete_users',
  
  // Business Management
  MANAGE_BUSINESS: 'manage_business',
  VIEW_BUSINESS: 'view_business',
  EDIT_BUSINESS: 'edit_business',
  DELETE_BUSINESS: 'delete_business',
  
  // Content Management
  CREATE_CONTENT: 'create_content',
  EDIT_CONTENT: 'edit_content',
  DELETE_CONTENT: 'delete_content',
  APPROVE_CONTENT: 'approve_content',
  
  // Social Media
  CONNECT_SOCIAL_ACCOUNTS: 'connect_social_accounts',
  MANAGE_SOCIAL_ACCOUNTS: 'manage_social_accounts',
  POST_CONTENT: 'post_content',
  SCHEDULE_POSTS: 'schedule_posts',
  
  // Analytics
  VIEW_ANALYTICS: 'view_analytics',
  EXPORT_ANALYTICS: 'export_analytics',
  MANAGE_REPORTS: 'manage_reports',
  
  // CRM
  MANAGE_CUSTOMERS: 'manage_customers',
  VIEW_CUSTOMERS: 'view_customers',
  EDIT_CUSTOMERS: 'edit_customers',
  DELETE_CUSTOMERS: 'delete_customers',
  
  // Chat/Inbox
  VIEW_INBOX: 'view_inbox',
  REPLY_TO_MESSAGES: 'reply_to_messages',
  MANAGE_CHAT_SETTINGS: 'manage_chat_settings',
  
  // AI Features
  USE_AI_ASSISTANT: 'use_ai_assistant',
  MANAGE_AI_SETTINGS: 'manage_ai_settings',
  VIEW_AI_USAGE: 'view_ai_usage',
  
  // Payments
  VIEW_PAYMENTS: 'view_payments',
  MANAGE_PAYMENTS: 'manage_payments',
  VIEW_BILLING: 'view_billing',
  
  // Tenant Management
  MANAGE_TENANT: 'manage_tenant',
  VIEW_TENANT_SETTINGS: 'view_tenant_settings',
  EDIT_TENANT_SETTINGS: 'edit_tenant_settings',
}

export const ROLE_PERMISSIONS: Record<UserRole, string[]> = {
  SUPER_ADMIN: [
    PERMISSIONS.MANAGE_USERS,
    PERMISSIONS.VIEW_USERS,
    PERMISSIONS.EDIT_USERS,
    PERMISSIONS.DELETE_USERS,
    PERMISSIONS.MANAGE_BUSINESS,
    PERMISSIONS.VIEW_BUSINESS,
    PERMISSIONS.EDIT_BUSINESS,
    PERMISSIONS.DELETE_BUSINESS,
    PERMISSIONS.CREATE_CONTENT,
    PERMISSIONS.EDIT_CONTENT,
    PERMISSIONS.DELETE_CONTENT,
    PERMISSIONS.APPROVE_CONTENT,
    PERMISSIONS.CONNECT_SOCIAL_ACCOUNTS,
    PERMISSIONS.MANAGE_SOCIAL_ACCOUNTS,
    PERMISSIONS.POST_CONTENT,
    PERMISSIONS.SCHEDULE_POSTS,
    PERMISSIONS.VIEW_ANALYTICS,
    PERMISSIONS.EXPORT_ANALYTICS,
    PERMISSIONS.MANAGE_REPORTS,
    PERMISSIONS.MANAGE_CUSTOMERS,
    PERMISSIONS.VIEW_CUSTOMERS,
    PERMISSIONS.EDIT_CUSTOMERS,
    PERMISSIONS.DELETE_CUSTOMERS,
    PERMISSIONS.VIEW_INBOX,
    PERMISSIONS.REPLY_TO_MESSAGES,
    PERMISSIONS.MANAGE_CHAT_SETTINGS,
    PERMISSIONS.USE_AI_ASSISTANT,
    PERMISSIONS.MANAGE_AI_SETTINGS,
    PERMISSIONS.VIEW_AI_USAGE,
    PERMISSIONS.VIEW_PAYMENTS,
    PERMISSIONS.MANAGE_PAYMENTS,
    PERMISSIONS.VIEW_BILLING,
    PERMISSIONS.MANAGE_TENANT,
    PERMISSIONS.VIEW_TENANT_SETTINGS,
    PERMISSIONS.EDIT_TENANT_SETTINGS,
  ],
  TENANT_ADMIN: [
    PERMISSIONS.MANAGE_USERS,
    PERMISSIONS.VIEW_USERS,
    PERMISSIONS.EDIT_USERS,
    PERMISSIONS.DELETE_USERS,
    PERMISSIONS.MANAGE_BUSINESS,
    PERMISSIONS.VIEW_BUSINESS,
    PERMISSIONS.EDIT_BUSINESS,
    PERMISSIONS.CREATE_CONTENT,
    PERMISSIONS.EDIT_CONTENT,
    PERMISSIONS.DELETE_CONTENT,
    PERMISSIONS.APPROVE_CONTENT,
    PERMISSIONS.CONNECT_SOCIAL_ACCOUNTS,
    PERMISSIONS.MANAGE_SOCIAL_ACCOUNTS,
    PERMISSIONS.POST_CONTENT,
    PERMISSIONS.SCHEDULE_POSTS,
    PERMISSIONS.VIEW_ANALYTICS,
    PERMISSIONS.EXPORT_ANALYTICS,
    PERMISSIONS.MANAGE_REPORTS,
    PERMISSIONS.MANAGE_CUSTOMERS,
    PERMISSIONS.VIEW_CUSTOMERS,
    PERMISSIONS.EDIT_CUSTOMERS,
    PERMISSIONS.DELETE_CUSTOMERS,
    PERMISSIONS.VIEW_INBOX,
    PERMISSIONS.REPLY_TO_MESSAGES,
    PERMISSIONS.MANAGE_CHAT_SETTINGS,
    PERMISSIONS.USE_AI_ASSISTANT,
    PERMISSIONS.MANAGE_AI_SETTINGS,
    PERMISSIONS.VIEW_AI_USAGE,
    PERMISSIONS.VIEW_PAYMENTS,
    PERMISSIONS.MANAGE_PAYMENTS,
    PERMISSIONS.VIEW_BILLING,
    PERMISSIONS.VIEW_TENANT_SETTINGS,
    PERMISSIONS.EDIT_TENANT_SETTINGS,
  ],
  ORGANIZATION_ADMIN: [
    PERMISSIONS.VIEW_USERS,
    PERMISSIONS.EDIT_USERS,
    PERMISSIONS.MANAGE_BUSINESS,
    PERMISSIONS.VIEW_BUSINESS,
    PERMISSIONS.EDIT_BUSINESS,
    PERMISSIONS.CREATE_CONTENT,
    PERMISSIONS.EDIT_CONTENT,
    PERMISSIONS.DELETE_CONTENT,
    PERMISSIONS.APPROVE_CONTENT,
    PERMISSIONS.CONNECT_SOCIAL_ACCOUNTS,
    PERMISSIONS.MANAGE_SOCIAL_ACCOUNTS,
    PERMISSIONS.POST_CONTENT,
    PERMISSIONS.SCHEDULE_POSTS,
    PERMISSIONS.VIEW_ANALYTICS,
    PERMISSIONS.EXPORT_ANALYTICS,
    PERMISSIONS.MANAGE_REPORTS,
    PERMISSIONS.MANAGE_CUSTOMERS,
    PERMISSIONS.VIEW_CUSTOMERS,
    PERMISSIONS.EDIT_CUSTOMERS,
    PERMISSIONS.VIEW_INBOX,
    PERMISSIONS.REPLY_TO_MESSAGES,
    PERMISSIONS.MANAGE_CHAT_SETTINGS,
    PERMISSIONS.USE_AI_ASSISTANT,
    PERMISSIONS.MANAGE_AI_SETTINGS,
    PERMISSIONS.VIEW_AI_USAGE,
    PERMISSIONS.VIEW_PAYMENTS,
    PERMISSIONS.VIEW_BILLING,
    PERMISSIONS.VIEW_TENANT_SETTINGS,
  ],
  TEAM_MANAGER: [
    PERMISSIONS.VIEW_USERS,
    PERMISSIONS.VIEW_BUSINESS,
    PERMISSIONS.EDIT_BUSINESS,
    PERMISSIONS.CREATE_CONTENT,
    PERMISSIONS.EDIT_CONTENT,
    PERMISSIONS.DELETE_CONTENT,
    PERMISSIONS.APPROVE_CONTENT,
    PERMISSIONS.CONNECT_SOCIAL_ACCOUNTS,
    PERMISSIONS.MANAGE_SOCIAL_ACCOUNTS,
    PERMISSIONS.POST_CONTENT,
    PERMISSIONS.SCHEDULE_POSTS,
    PERMISSIONS.VIEW_ANALYTICS,
    PERMISSIONS.EXPORT_ANALYTICS,
    PERMISSIONS.MANAGE_REPORTS,
    PERMISSIONS.MANAGE_CUSTOMERS,
    PERMISSIONS.VIEW_CUSTOMERS,
    PERMISSIONS.EDIT_CUSTOMERS,
    PERMISSIONS.VIEW_INBOX,
    PERMISSIONS.REPLY_TO_MESSAGES,
    PERMISSIONS.MANAGE_CHAT_SETTINGS,
    PERMISSIONS.USE_AI_ASSISTANT,
    PERMISSIONS.MANAGE_AI_SETTINGS,
    PERMISSIONS.VIEW_AI_USAGE,
    PERMISSIONS.VIEW_PAYMENTS,
    PERMISSIONS.VIEW_BILLING,
  ],
  CONTENT_CREATOR: [
    PERMISSIONS.CREATE_CONTENT,
    PERMISSIONS.EDIT_CONTENT,
    PERMISSIONS.DELETE_CONTENT,
    PERMISSIONS.VIEW_ANALYTICS,
    PERMISSIONS.VIEW_CUSTOMERS,
    PERMISSIONS.VIEW_INBOX,
    PERMISSIONS.REPLY_TO_MESSAGES,
    PERMISSIONS.USE_AI_ASSISTANT,
    PERMISSIONS.VIEW_AI_USAGE,
  ],
  SOCIAL_MEDIA_MANAGER: [
    PERMISSIONS.CREATE_CONTENT,
    PERMISSIONS.EDIT_CONTENT,
    PERMISSIONS.DELETE_CONTENT,
    PERMISSIONS.APPROVE_CONTENT,
    PERMISSIONS.CONNECT_SOCIAL_ACCOUNTS,
    PERMISSIONS.MANAGE_SOCIAL_ACCOUNTS,
    PERMISSIONS.POST_CONTENT,
    PERMISSIONS.SCHEDULE_POSTS,
    PERMISSIONS.VIEW_ANALYTICS,
    PERMISSIONS.EXPORT_ANALYTICS,
    PERMISSIONS.VIEW_CUSTOMERS,
    PERMISSIONS.VIEW_INBOX,
    PERMISSIONS.REPLY_TO_MESSAGES,
    PERMISSIONS.USE_AI_ASSISTANT,
    PERMISSIONS.MANAGE_AI_SETTINGS,
    PERMISSIONS.VIEW_AI_USAGE,
  ],
  ANALYST: [
    PERMISSIONS.VIEW_ANALYTICS,
    PERMISSIONS.EXPORT_ANALYTICS,
    PERMISSIONS.MANAGE_REPORTS,
    PERMISSIONS.VIEW_CUSTOMERS,
    PERMISSIONS.VIEW_INBOX,
    PERMISSIONS.VIEW_AI_USAGE,
    PERMISSIONS.VIEW_PAYMENTS,
    PERMISSIONS.VIEW_BILLING,
  ],
  VIEWER: [
    PERMISSIONS.VIEW_USERS,
    PERMISSIONS.VIEW_BUSINESS,
    PERMISSIONS.VIEW_ANALYTICS,
    PERMISSIONS.VIEW_CUSTOMERS,
    PERMISSIONS.VIEW_INBOX,
    PERMISSIONS.VIEW_AI_USAGE,
    PERMISSIONS.VIEW_PAYMENTS,
    PERMISSIONS.VIEW_BILLING,
    PERMISSIONS.VIEW_TENANT_SETTINGS,
  ],
}

export function hasPermission(userRole: UserRole, permission: string): boolean {
  const permissions = ROLE_PERMISSIONS[userRole] || []
  return permissions.includes(permission)
}

export function hasRole(userRole: UserRole, requiredRole: UserRole): boolean {
  const userLevel = ROLE_HIERARCHY[userRole] || 0
  const requiredLevel = ROLE_HIERARCHY[requiredRole] || 0
  return userLevel >= requiredLevel
}

export function getRolePermissions(userRole: UserRole): string[] {
  return ROLE_PERMISSIONS[userRole] || []
}