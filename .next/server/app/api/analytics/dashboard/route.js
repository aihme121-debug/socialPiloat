"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/analytics/dashboard/route";
exports.ids = ["app/api/analytics/dashboard/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("querystring");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalytics%2Fdashboard%2Froute&page=%2Fapi%2Fanalytics%2Fdashboard%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalytics%2Fdashboard%2Froute.ts&appDir=I%3A%5CTRAE%20Solo%5CSocialPiloat%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=I%3A%5CTRAE%20Solo%5CSocialPiloat&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalytics%2Fdashboard%2Froute&page=%2Fapi%2Fanalytics%2Fdashboard%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalytics%2Fdashboard%2Froute.ts&appDir=I%3A%5CTRAE%20Solo%5CSocialPiloat%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=I%3A%5CTRAE%20Solo%5CSocialPiloat&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var I_TRAE_Solo_SocialPiloat_src_app_api_analytics_dashboard_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/analytics/dashboard/route.ts */ \"(rsc)/./src/app/api/analytics/dashboard/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/analytics/dashboard/route\",\n        pathname: \"/api/analytics/dashboard\",\n        filename: \"route\",\n        bundlePath: \"app/api/analytics/dashboard/route\"\n    },\n    resolvedPagePath: \"I:\\\\TRAE Solo\\\\SocialPiloat\\\\src\\\\app\\\\api\\\\analytics\\\\dashboard\\\\route.ts\",\n    nextConfigOutput,\n    userland: I_TRAE_Solo_SocialPiloat_src_app_api_analytics_dashboard_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/analytics/dashboard/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhbmFseXRpY3MlMkZkYXNoYm9hcmQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmFuYWx5dGljcyUyRmRhc2hib2FyZCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmFuYWx5dGljcyUyRmRhc2hib2FyZCUyRnJvdXRlLnRzJmFwcERpcj1JJTNBJTVDVFJBRSUyMFNvbG8lNUNTb2NpYWxQaWxvYXQlNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUklM0ElNUNUUkFFJTIwU29sbyU1Q1NvY2lhbFBpbG9hdCZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUMwQjtBQUN2RztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL3NvY2lhbHBpbG9hdC1haS8/ZDY4MyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJJOlxcXFxUUkFFIFNvbG9cXFxcU29jaWFsUGlsb2F0XFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGFuYWx5dGljc1xcXFxkYXNoYm9hcmRcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2FuYWx5dGljcy9kYXNoYm9hcmQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hbmFseXRpY3MvZGFzaGJvYXJkXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9hbmFseXRpY3MvZGFzaGJvYXJkL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiSTpcXFxcVFJBRSBTb2xvXFxcXFNvY2lhbFBpbG9hdFxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxhbmFseXRpY3NcXFxcZGFzaGJvYXJkXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2FuYWx5dGljcy9kYXNoYm9hcmQvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0LCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalytics%2Fdashboard%2Froute&page=%2Fapi%2Fanalytics%2Fdashboard%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalytics%2Fdashboard%2Froute.ts&appDir=I%3A%5CTRAE%20Solo%5CSocialPiloat%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=I%3A%5CTRAE%20Solo%5CSocialPiloat&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/analytics/dashboard/route.ts":
/*!**************************************************!*\
  !*** ./src/app/api/analytics/dashboard/route.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./src/lib/auth.ts\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _lib_services_facebook_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/services/facebook-service */ \"(rsc)/./src/lib/services/facebook-service.ts\");\n/* harmony import */ var _lib_error_handling_error_handler__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/error-handling/error-handler */ \"(rsc)/./src/lib/error-handling/error-handler.ts\");\n/* harmony import */ var _lib_logging_logger_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/lib/logging/logger-service */ \"(rsc)/./src/lib/logging/logger-service.ts\");\n\n\n\n\n\n\n\nasync function GET(request) {\n    try {\n        const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_1__.getServerSession)(_lib_auth__WEBPACK_IMPORTED_MODULE_2__.authOptions);\n        if (!session?.user?.id && !session?.user?.email) {\n            throw new _lib_error_handling_error_handler__WEBPACK_IMPORTED_MODULE_5__.AuthenticationError(\"Authentication required to access dashboard analytics\");\n        }\n        // Get user with business and social accounts data\n        const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__.prisma.user.findUnique({\n            where: session.user.email ? {\n                email: session.user.email\n            } : {\n                id: session.user.id\n            },\n            include: {\n                business: {\n                    include: {\n                        socialAccounts: {\n                            where: {\n                                isActive: true\n                            },\n                            select: {\n                                id: true,\n                                platform: true,\n                                accountId: true,\n                                accessToken: true,\n                                expiresAt: true,\n                                settings: true\n                            }\n                        }\n                    }\n                }\n            }\n        });\n        if (!user?.business) {\n            throw new _lib_error_handling_error_handler__WEBPACK_IMPORTED_MODULE_5__.ValidationError(\"No business associated with user account\");\n        }\n        const businessId = user.business.id;\n        const now = new Date();\n        const thirtyDaysAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\n        const sevenDaysAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\n        // Fetch social media analytics from connected accounts\n        const socialAnalytics = await fetchSocialMediaAnalytics(user.business.socialAccounts, thirtyDaysAgo, now);\n        // Fetch local database metrics\n        const [totalPosts, scheduledPosts, publishedPosts, socialAccountsCount, recentPosts] = await Promise.all([\n            // Total posts created\n            _lib_prisma__WEBPACK_IMPORTED_MODULE_3__.prisma.post.count({\n                where: {\n                    businessId: businessId,\n                    createdAt: {\n                        gte: thirtyDaysAgo\n                    }\n                }\n            }),\n            // Scheduled posts\n            _lib_prisma__WEBPACK_IMPORTED_MODULE_3__.prisma.post.count({\n                where: {\n                    businessId: businessId,\n                    status: \"SCHEDULED\",\n                    scheduledAt: {\n                        gte: now\n                    }\n                }\n            }),\n            // Published posts\n            _lib_prisma__WEBPACK_IMPORTED_MODULE_3__.prisma.post.count({\n                where: {\n                    businessId: businessId,\n                    status: \"PUBLISHED\",\n                    publishedAt: {\n                        gte: thirtyDaysAgo\n                    }\n                }\n            }),\n            // Connected social accounts\n            _lib_prisma__WEBPACK_IMPORTED_MODULE_3__.prisma.socialAccount.count({\n                where: {\n                    businessId: businessId,\n                    isActive: true\n                }\n            }),\n            // Recent posts (last 5)\n            _lib_prisma__WEBPACK_IMPORTED_MODULE_3__.prisma.post.findMany({\n                where: {\n                    businessId: businessId\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                },\n                take: 5,\n                include: {\n                    content: true\n                }\n            })\n        ]);\n        // Calculate combined metrics\n        const totalFollowers = socialAnalytics.totalFollowers;\n        const totalEngagement = socialAnalytics.totalEngagement;\n        const totalReach = socialAnalytics.totalReach;\n        const engagementRate = totalReach > 0 ? (totalEngagement / totalReach * 100).toFixed(1) : \"0.0\";\n        // Calculate follower growth\n        const followerGrowth = calculateGrowthRate(socialAnalytics.followerHistory);\n        // Format recent activity\n        const recentActivity = recentPosts.map((post)=>({\n                id: post.id,\n                type: post.content?.contentType || \"post\",\n                content: post.content?.contentText?.substring(0, 100) + \"...\" || 0,\n                platform: post.platforms[0] || \"Unknown\",\n                status: post.status,\n                createdAt: post.createdAt,\n                metrics: post.performanceMetrics || getPostMetrics(post.id, socialAnalytics.postAnalytics)\n            }));\n        const response = {\n            metrics: {\n                totalPosts,\n                scheduledPosts,\n                publishedPosts,\n                socialAccounts: socialAccountsCount,\n                engagementRate: parseFloat(engagementRate),\n                totalFollowers,\n                followerGrowth: followerGrowth.toFixed(1),\n                totalReach,\n                totalEngagement\n            },\n            recentActivity,\n            platformDistribution: socialAnalytics.platformDistribution,\n            followerGrowth: socialAnalytics.followerHistory,\n            topPosts: socialAnalytics.topPosts,\n            timeRange: {\n                start: thirtyDaysAgo.toISOString(),\n                end: now.toISOString()\n            }\n        };\n        console.log(\"Dashboard analytics response:\", JSON.stringify(response, null, 2));\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(response);\n    } catch (error) {\n        console.error(\"Dashboard analytics error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function fetchSocialMediaAnalytics(socialAccounts, startDate, endDate) {\n    const facebookService = new _lib_services_facebook_service__WEBPACK_IMPORTED_MODULE_4__.FacebookService();\n    let totalFollowers = 0;\n    let totalEngagement = 0;\n    let totalReach = 0;\n    const platformDistribution = {};\n    const followerHistory = [];\n    const postAnalytics = [];\n    const topPosts = [];\n    for (const account of socialAccounts){\n        try {\n            if (account.platform === \"FACEBOOK\" || account.platform === \"INSTAGRAM\") {\n                // Check if token is expired\n                if (account.expiresAt && new Date(account.expiresAt) < new Date()) {\n                    console.log(`Token expired for ${account.platform} account ${account.id}`);\n                    continue;\n                }\n                const analytics = await facebookService.getAccountAnalytics(account.accountId, account.accessToken, startDate, endDate);\n                totalFollowers += analytics.followers || 0;\n                totalEngagement += analytics.totalEngagement || 0;\n                totalReach += analytics.totalReach || 0;\n                // Update platform distribution\n                platformDistribution[account.platform] = (platformDistribution[account.platform] || 0) + 1;\n                // Add to follower history\n                if (analytics.followerHistory) {\n                    followerHistory.push(...analytics.followerHistory);\n                }\n                // Add post analytics\n                if (analytics.posts) {\n                    postAnalytics.push(...analytics.posts);\n                }\n                // Add top posts\n                if (analytics.topPosts) {\n                    topPosts.push(...analytics.topPosts);\n                }\n            }\n        } catch (error) {\n            console.error(`Error fetching analytics for ${account.platform} account ${account.id}:`, error);\n            // Log to monitoring service but continue with other accounts\n            _lib_logging_logger_service__WEBPACK_IMPORTED_MODULE_6__.logger.error(\"External service error fetching social media analytics\", {\n                platform: account.platform,\n                accountId: account.id,\n                error: error instanceof Error ? error.message : \"Unknown error\"\n            });\n        // Continue with other accounts even if one fails\n        }\n    }\n    // Sort and limit top posts\n    const sortedTopPosts = topPosts.sort((a, b)=>(b.engagement || 0) - (a.engagement || 0)).slice(0, 5);\n    // Aggregate follower history by date\n    const aggregatedFollowerHistory = aggregateFollowerHistory(followerHistory);\n    return {\n        totalFollowers,\n        totalEngagement,\n        totalReach,\n        platformDistribution,\n        followerHistory: aggregatedFollowerHistory,\n        postAnalytics,\n        topPosts: sortedTopPosts\n    };\n}\nfunction aggregateFollowerHistory(history) {\n    const aggregated = {};\n    history.forEach((item)=>{\n        const date = new Date(item.date).toISOString().split(\"T\")[0];\n        aggregated[date] = (aggregated[date] || 0) + (item.followers || 0);\n    });\n    return Object.entries(aggregated).map(([date, followers])=>({\n            date,\n            followers\n        })).sort((a, b)=>new Date(a.date).getTime() - new Date(b.date).getTime());\n}\nfunction calculateGrowthRate(followerHistory) {\n    if (followerHistory.length < 2) return 0;\n    const first = followerHistory[0].followers;\n    const last = followerHistory[followerHistory.length - 1].followers;\n    return first > 0 ? (last - first) / first * 100 : 0;\n}\nfunction getPostMetrics(postId, postAnalytics) {\n    const post = postAnalytics.find((p)=>p.id === postId);\n    return post ? {\n        likes: post.likes || 0,\n        comments: post.comments || 0,\n        shares: post.shares || 0,\n        views: post.views || 0\n    } : {};\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hbmFseXRpY3MvZGFzaGJvYXJkL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUF3RDtBQUNYO0FBQ0o7QUFDSDtBQUM0QjtBQUMwRDtBQUN0RTtBQUUvQyxlQUFlUSxJQUFJQyxPQUFnQjtJQUN4QyxJQUFJO1FBQ0YsTUFBTUMsVUFBVSxNQUFNVCwyREFBZ0JBLENBQUNDLGtEQUFXQTtRQUVsRCxJQUFJLENBQUNRLFNBQVNDLE1BQU1DLE1BQU0sQ0FBQ0YsU0FBU0MsTUFBTUUsT0FBTztZQUMvQyxNQUFNLElBQUlQLGtGQUFtQkEsQ0FBQztRQUNoQztRQUVBLGtEQUFrRDtRQUNsRCxNQUFNSyxPQUFPLE1BQU1SLCtDQUFNQSxDQUFDUSxJQUFJLENBQUNHLFVBQVUsQ0FBQztZQUN4Q0MsT0FBT0wsUUFBUUMsSUFBSSxDQUFDRSxLQUFLLEdBQUc7Z0JBQUVBLE9BQU9ILFFBQVFDLElBQUksQ0FBQ0UsS0FBSztZQUFDLElBQUk7Z0JBQUVELElBQUlGLFFBQVFDLElBQUksQ0FBQ0MsRUFBRTtZQUFDO1lBQ2xGSSxTQUFTO2dCQUNQQyxVQUFVO29CQUNSRCxTQUFTO3dCQUNQRSxnQkFBZ0I7NEJBQ2RILE9BQU87Z0NBQUVJLFVBQVU7NEJBQUs7NEJBQ3hCQyxRQUFRO2dDQUNOUixJQUFJO2dDQUNKUyxVQUFVO2dDQUNWQyxXQUFXO2dDQUNYQyxhQUFhO2dDQUNiQyxXQUFXO2dDQUNYQyxVQUFVOzRCQUNaO3dCQUNGO29CQUNGO2dCQUNGO1lBQ0Y7UUFDRjtRQUVBLElBQUksQ0FBQ2QsTUFBTU0sVUFBVTtZQUNuQixNQUFNLElBQUlaLDhFQUFlQSxDQUFDO1FBQzVCO1FBRUEsTUFBTXFCLGFBQWFmLEtBQUtNLFFBQVEsQ0FBQ0wsRUFBRTtRQUNuQyxNQUFNZSxNQUFNLElBQUlDO1FBQ2hCLE1BQU1DLGdCQUFnQixJQUFJRCxLQUFLRCxJQUFJRyxPQUFPLEtBQUssS0FBSyxLQUFLLEtBQUssS0FBSztRQUNuRSxNQUFN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QUFjOEMsSUFBSSxDQUFDQyxDQUFBQSxJQUFLQSxFQUFFMUcsRUFBRSxLQUFLd0c7SUFDOUMsT0FBTzNFLE9BQU87UUFDWjhFLE9BQU85RSxLQUFLOEUsS0FBSyxJQUFJO1FBQ3JCQyxVQUFVL0UsS0FBSytFLFFBQVEsSUFBSTtRQUMzQkMsUUFBUWhGLEtBQUtnRixNQUFNLElBQUk7UUFDdkJDLE9BQU9qRixLQUFLaUYsS0FBSyxJQUFJO0lBQ3ZCLElBQUksQ0FBQztBQUNQIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc29jaWFscGlsb2F0LWFpLy4vc3JjL2FwcC9hcGkvYW5hbHl0aWNzL2Rhc2hib2FyZC9yb3V0ZS50cz8xOTM3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBnZXRTZXJ2ZXJTZXNzaW9uIH0gZnJvbSAnbmV4dC1hdXRoJztcbmltcG9ydCB7IGF1dGhPcHRpb25zIH0gZnJvbSAnQC9saWIvYXV0aCc7XG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICdAL2xpYi9wcmlzbWEnO1xuaW1wb3J0IHsgRmFjZWJvb2tTZXJ2aWNlIH0gZnJvbSAnQC9saWIvc2VydmljZXMvZmFjZWJvb2stc2VydmljZSc7XG5pbXBvcnQgeyBhcGlIYW5kbGVyLCBWYWxpZGF0aW9uRXJyb3IsIEF1dGhlbnRpY2F0aW9uRXJyb3IsIEV4dGVybmFsU2VydmljZUVycm9yIH0gZnJvbSAnQC9saWIvZXJyb3ItaGFuZGxpbmcvZXJyb3ItaGFuZGxlcic7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICdAL2xpYi9sb2dnaW5nL2xvZ2dlci1zZXJ2aWNlJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlcnZlclNlc3Npb24oYXV0aE9wdGlvbnMpO1xuICAgIFxuICAgIGlmICghc2Vzc2lvbj8udXNlcj8uaWQgJiYgIXNlc3Npb24/LnVzZXI/LmVtYWlsKSB7XG4gICAgICB0aHJvdyBuZXcgQXV0aGVudGljYXRpb25FcnJvcignQXV0aGVudGljYXRpb24gcmVxdWlyZWQgdG8gYWNjZXNzIGRhc2hib2FyZCBhbmFseXRpY3MnKTtcbiAgICB9XG5cbiAgICAvLyBHZXQgdXNlciB3aXRoIGJ1c2luZXNzIGFuZCBzb2NpYWwgYWNjb3VudHMgZGF0YVxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHtcbiAgICAgIHdoZXJlOiBzZXNzaW9uLnVzZXIuZW1haWwgPyB7IGVtYWlsOiBzZXNzaW9uLnVzZXIuZW1haWwgfSA6IHsgaWQ6IHNlc3Npb24udXNlci5pZCB9LFxuICAgICAgaW5jbHVkZTogeyBcbiAgICAgICAgYnVzaW5lc3M6IHtcbiAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICBzb2NpYWxBY2NvdW50czoge1xuICAgICAgICAgICAgICB3aGVyZTogeyBpc0FjdGl2ZTogdHJ1ZSB9LFxuICAgICAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBwbGF0Zm9ybTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgYWNjZXNzVG9rZW46IHRydWUsXG4gICAgICAgICAgICAgICAgZXhwaXJlc0F0OiB0cnVlLFxuICAgICAgICAgICAgICAgIHNldHRpbmdzOiB0cnVlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmICghdXNlcj8uYnVzaW5lc3MpIHtcbiAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoJ05vIGJ1c2luZXNzIGFzc29jaWF0ZWQgd2l0aCB1c2VyIGFjY291bnQnKTtcbiAgICB9XG5cbiAgICBjb25zdCBidXNpbmVzc0lkID0gdXNlci5idXNpbmVzcy5pZDtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IHRoaXJ0eURheXNBZ28gPSBuZXcgRGF0ZShub3cuZ2V0VGltZSgpIC0gMzAgKiAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICBjb25zdCBzZXZlbkRheXNBZ28gPSBuZXcgRGF0ZShub3cuZ2V0VGltZSgpIC0gNyAqIDI0ICogNjAgKiA2MCAqIDEwMDApO1xuXG4gICAgLy8gRmV0Y2ggc29jaWFsIG1lZGlhIGFuYWx5dGljcyBmcm9tIGNvbm5lY3RlZCBhY2NvdW50c1xuICAgIGNvbnN0IHNvY2lhbEFuYWx5dGljcyA9IGF3YWl0IGZldGNoU29jaWFsTWVkaWFBbmFseXRpY3ModXNlci5idXNpbmVzcy5zb2NpYWxBY2NvdW50cywgdGhpcnR5RGF5c0Fnbywgbm93KTtcbiAgICBcbiAgICAvLyBGZXRjaCBsb2NhbCBkYXRhYmFzZSBtZXRyaWNzXG4gICAgY29uc3QgW1xuICAgICAgdG90YWxQb3N0cyxcbiAgICAgIHNjaGVkdWxlZFBvc3RzLFxuICAgICAgcHVibGlzaGVkUG9zdHMsXG4gICAgICBzb2NpYWxBY2NvdW50c0NvdW50LFxuICAgICAgcmVjZW50UG9zdHNcbiAgICBdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgLy8gVG90YWwgcG9zdHMgY3JlYXRlZFxuICAgICAgcHJpc21hLnBvc3QuY291bnQoe1xuICAgICAgICB3aGVyZTogeyBcbiAgICAgICAgICBidXNpbmVzc0lkOiBidXNpbmVzc0lkLFxuICAgICAgICAgIGNyZWF0ZWRBdDogeyBndGU6IHRoaXJ0eURheXNBZ28gfVxuICAgICAgICB9XG4gICAgICB9KSxcbiAgICAgIFxuICAgICAgLy8gU2NoZWR1bGVkIHBvc3RzXG4gICAgICBwcmlzbWEucG9zdC5jb3VudCh7XG4gICAgICAgIHdoZXJlOiB7IFxuICAgICAgICAgIGJ1c2luZXNzSWQ6IGJ1c2luZXNzSWQsXG4gICAgICAgICAgc3RhdHVzOiAnU0NIRURVTEVEJyxcbiAgICAgICAgICBzY2hlZHVsZWRBdDogeyBndGU6IG5vdyB9XG4gICAgICAgIH1cbiAgICAgIH0pLFxuICAgICAgXG4gICAgICAvLyBQdWJsaXNoZWQgcG9zdHNcbiAgICAgIHByaXNtYS5wb3N0LmNvdW50KHtcbiAgICAgICAgd2hlcmU6IHsgXG4gICAgICAgICAgYnVzaW5lc3NJZDogYnVzaW5lc3NJZCxcbiAgICAgICAgICBzdGF0dXM6ICdQVUJMSVNIRUQnLFxuICAgICAgICAgIHB1Ymxpc2hlZEF0OiB7IGd0ZTogdGhpcnR5RGF5c0FnbyB9XG4gICAgICAgIH1cbiAgICAgIH0pLFxuICAgICAgXG4gICAgICAvLyBDb25uZWN0ZWQgc29jaWFsIGFjY291bnRzXG4gICAgICBwcmlzbWEuc29jaWFsQWNjb3VudC5jb3VudCh7XG4gICAgICAgIHdoZXJlOiB7IFxuICAgICAgICAgIGJ1c2luZXNzSWQ6IGJ1c2luZXNzSWQsXG4gICAgICAgICAgaXNBY3RpdmU6IHRydWUgXG4gICAgICAgIH1cbiAgICAgIH0pLFxuICAgICAgXG4gICAgICAvLyBSZWNlbnQgcG9zdHMgKGxhc3QgNSlcbiAgICAgIHByaXNtYS5wb3N0LmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgYnVzaW5lc3NJZDogYnVzaW5lc3NJZCB9LFxuICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICAgIHRha2U6IDUsXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBjb250ZW50OiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgXSk7XG5cbiAgICAvLyBDYWxjdWxhdGUgY29tYmluZWQgbWV0cmljc1xuICAgIGNvbnN0IHRvdGFsRm9sbG93ZXJzID0gc29jaWFsQW5hbHl0aWNzLnRvdGFsRm9sbG93ZXJzO1xuICAgIGNvbnN0IHRvdGFsRW5nYWdlbWVudCA9IHNvY2lhbEFuYWx5dGljcy50b3RhbEVuZ2FnZW1lbnQ7XG4gICAgY29uc3QgdG90YWxSZWFjaCA9IHNvY2lhbEFuYWx5dGljcy50b3RhbFJlYWNoO1xuICAgIGNvbnN0IGVuZ2FnZW1lbnRSYXRlID0gdG90YWxSZWFjaCA+IDAgPyAoKHRvdGFsRW5nYWdlbWVudCAvIHRvdGFsUmVhY2gpICogMTAwKS50b0ZpeGVkKDEpIDogJzAuMCc7XG4gICAgXG4gICAgLy8gQ2FsY3VsYXRlIGZvbGxvd2VyIGdyb3d0aFxuICAgIGNvbnN0IGZvbGxvd2VyR3Jvd3RoID0gY2FsY3VsYXRlR3Jvd3RoUmF0ZShzb2NpYWxBbmFseXRpY3MuZm9sbG93ZXJIaXN0b3J5KTtcblxuICAgIC8vIEZvcm1hdCByZWNlbnQgYWN0aXZpdHlcbiAgICBjb25zdCByZWNlbnRBY3Rpdml0eSA9IHJlY2VudFBvc3RzLm1hcChwb3N0ID0+ICh7XG4gICAgICBpZDogcG9zdC5pZCxcbiAgICAgIHR5cGU6IHBvc3QuY29udGVudD8uY29udGVudFR5cGUgfHwgJ3Bvc3QnLFxuICAgICAgY29udGVudDogcG9zdC5jb250ZW50Py5jb250ZW50VGV4dD8uc3Vic3RyaW5nKDAsIDEwMCkgKyAnLi4uJyB8fCAnTm8gY29udGVudCcsXG4gICAgICBwbGF0Zm9ybTogcG9zdC5wbGF0Zm9ybXNbMF0gfHwgJ1Vua25vd24nLFxuICAgICAgc3RhdHVzOiBwb3N0LnN0YXR1cyxcbiAgICAgIGNyZWF0ZWRBdDogcG9zdC5jcmVhdGVkQXQsXG4gICAgICBtZXRyaWNzOiBwb3N0LnBlcmZvcm1hbmNlTWV0cmljcyB8fCBnZXRQb3N0TWV0cmljcyhwb3N0LmlkLCBzb2NpYWxBbmFseXRpY3MucG9zdEFuYWx5dGljcylcbiAgICB9KSk7XG5cbiAgICBjb25zdCByZXNwb25zZSA9IHtcbiAgICAgIG1ldHJpY3M6IHtcbiAgICAgICAgdG90YWxQb3N0cyxcbiAgICAgICAgc2NoZWR1bGVkUG9zdHMsXG4gICAgICAgIHB1Ymxpc2hlZFBvc3RzLFxuICAgICAgICBzb2NpYWxBY2NvdW50czogc29jaWFsQWNjb3VudHNDb3VudCxcbiAgICAgICAgZW5nYWdlbWVudFJhdGU6IHBhcnNlRmxvYXQoZW5nYWdlbWVudFJhdGUpLFxuICAgICAgICB0b3RhbEZvbGxvd2VycyxcbiAgICAgICAgZm9sbG93ZXJHcm93dGg6IGZvbGxvd2VyR3Jvd3RoLnRvRml4ZWQoMSksXG4gICAgICAgIHRvdGFsUmVhY2gsXG4gICAgICAgIHRvdGFsRW5nYWdlbWVudFxuICAgICAgfSxcbiAgICAgIHJlY2VudEFjdGl2aXR5LFxuICAgICAgcGxhdGZvcm1EaXN0cmlidXRpb246IHNvY2lhbEFuYWx5dGljcy5wbGF0Zm9ybURpc3RyaWJ1dGlvbixcbiAgICAgIGZvbGxvd2VyR3Jvd3RoOiBzb2NpYWxBbmFseXRpY3MuZm9sbG93ZXJIaXN0b3J5LFxuICAgICAgdG9wUG9zdHM6IHNvY2lhbEFuYWx5dGljcy50b3BQb3N0cyxcbiAgICAgIHRpbWVSYW5nZToge1xuICAgICAgICBzdGFydDogdGhpcnR5RGF5c0Fnby50b0lTT1N0cmluZygpLFxuICAgICAgICBlbmQ6IG5vdy50b0lTT1N0cmluZygpXG4gICAgICB9XG4gICAgfTtcblxuICAgIGNvbnNvbGUubG9nKCdEYXNoYm9hcmQgYW5hbHl0aWNzIHJlc3BvbnNlOicsIEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlLCBudWxsLCAyKSk7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3BvbnNlKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdEYXNoYm9hcmQgYW5hbHl0aWNzIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBmZXRjaFNvY2lhbE1lZGlhQW5hbHl0aWNzKHNvY2lhbEFjY291bnRzOiBhbnlbXSwgc3RhcnREYXRlOiBEYXRlLCBlbmREYXRlOiBEYXRlKSB7XG4gIGNvbnN0IGZhY2Vib29rU2VydmljZSA9IG5ldyBGYWNlYm9va1NlcnZpY2UoKTtcbiAgbGV0IHRvdGFsRm9sbG93ZXJzID0gMDtcbiAgbGV0IHRvdGFsRW5nYWdlbWVudCA9IDA7XG4gIGxldCB0b3RhbFJlYWNoID0gMDtcbiAgY29uc3QgcGxhdGZvcm1EaXN0cmlidXRpb246IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcbiAgY29uc3QgZm9sbG93ZXJIaXN0b3J5OiBhbnlbXSA9IFtdO1xuICBjb25zdCBwb3N0QW5hbHl0aWNzOiBhbnlbXSA9IFtdO1xuICBjb25zdCB0b3BQb3N0czogYW55W10gPSBbXTtcblxuICBmb3IgKGNvbnN0IGFjY291bnQgb2Ygc29jaWFsQWNjb3VudHMpIHtcbiAgICB0cnkge1xuICAgICAgaWYgKGFjY291bnQucGxhdGZvcm0gPT09ICdGQUNFQk9PSycgfHwgYWNjb3VudC5wbGF0Zm9ybSA9PT0gJ0lOU1RBR1JBTScpIHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdG9rZW4gaXMgZXhwaXJlZFxuICAgICAgICBpZiAoYWNjb3VudC5leHBpcmVzQXQgJiYgbmV3IERhdGUoYWNjb3VudC5leHBpcmVzQXQpIDwgbmV3IERhdGUoKSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGBUb2tlbiBleHBpcmVkIGZvciAke2FjY291bnQucGxhdGZvcm19IGFjY291bnQgJHthY2NvdW50LmlkfWApO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYW5hbHl0aWNzID0gYXdhaXQgZmFjZWJvb2tTZXJ2aWNlLmdldEFjY291bnRBbmFseXRpY3MoXG4gICAgICAgICAgYWNjb3VudC5hY2NvdW50SWQsXG4gICAgICAgICAgYWNjb3VudC5hY2Nlc3NUb2tlbixcbiAgICAgICAgICBzdGFydERhdGUsXG4gICAgICAgICAgZW5kRGF0ZVxuICAgICAgICApO1xuXG4gICAgICAgIHRvdGFsRm9sbG93ZXJzICs9IGFuYWx5dGljcy5mb2xsb3dlcnMgfHwgMDtcbiAgICAgICAgdG90YWxFbmdhZ2VtZW50ICs9IGFuYWx5dGljcy50b3RhbEVuZ2FnZW1lbnQgfHwgMDtcbiAgICAgICAgdG90YWxSZWFjaCArPSBhbmFseXRpY3MudG90YWxSZWFjaCB8fCAwO1xuICAgICAgICBcbiAgICAgICAgLy8gVXBkYXRlIHBsYXRmb3JtIGRpc3RyaWJ1dGlvblxuICAgICAgICBwbGF0Zm9ybURpc3RyaWJ1dGlvblthY2NvdW50LnBsYXRmb3JtXSA9IChwbGF0Zm9ybURpc3RyaWJ1dGlvblthY2NvdW50LnBsYXRmb3JtXSB8fCAwKSArIDE7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgdG8gZm9sbG93ZXIgaGlzdG9yeVxuICAgICAgICBpZiAoYW5hbHl0aWNzLmZvbGxvd2VySGlzdG9yeSkge1xuICAgICAgICAgIGZvbGxvd2VySGlzdG9yeS5wdXNoKC4uLmFuYWx5dGljcy5mb2xsb3dlckhpc3RvcnkpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgcG9zdCBhbmFseXRpY3NcbiAgICAgICAgaWYgKGFuYWx5dGljcy5wb3N0cykge1xuICAgICAgICAgIHBvc3RBbmFseXRpY3MucHVzaCguLi5hbmFseXRpY3MucG9zdHMpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgdG9wIHBvc3RzXG4gICAgICAgIGlmIChhbmFseXRpY3MudG9wUG9zdHMpIHtcbiAgICAgICAgICB0b3BQb3N0cy5wdXNoKC4uLmFuYWx5dGljcy50b3BQb3N0cyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgZmV0Y2hpbmcgYW5hbHl0aWNzIGZvciAke2FjY291bnQucGxhdGZvcm19IGFjY291bnQgJHthY2NvdW50LmlkfTpgLCBlcnJvcik7XG4gICAgICAvLyBMb2cgdG8gbW9uaXRvcmluZyBzZXJ2aWNlIGJ1dCBjb250aW51ZSB3aXRoIG90aGVyIGFjY291bnRzXG4gICAgICBsb2dnZXIuZXJyb3IoJ0V4dGVybmFsIHNlcnZpY2UgZXJyb3IgZmV0Y2hpbmcgc29jaWFsIG1lZGlhIGFuYWx5dGljcycsIHtcbiAgICAgICAgcGxhdGZvcm06IGFjY291bnQucGxhdGZvcm0sXG4gICAgICAgIGFjY291bnRJZDogYWNjb3VudC5pZCxcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICB9KTtcbiAgICAgIC8vIENvbnRpbnVlIHdpdGggb3RoZXIgYWNjb3VudHMgZXZlbiBpZiBvbmUgZmFpbHNcbiAgICB9XG4gIH1cblxuICAvLyBTb3J0IGFuZCBsaW1pdCB0b3AgcG9zdHNcbiAgY29uc3Qgc29ydGVkVG9wUG9zdHMgPSB0b3BQb3N0c1xuICAgIC5zb3J0KChhLCBiKSA9PiAoYi5lbmdhZ2VtZW50IHx8IDApIC0gKGEuZW5nYWdlbWVudCB8fCAwKSlcbiAgICAuc2xpY2UoMCwgNSk7XG5cbiAgLy8gQWdncmVnYXRlIGZvbGxvd2VyIGhpc3RvcnkgYnkgZGF0ZVxuICBjb25zdCBhZ2dyZWdhdGVkRm9sbG93ZXJIaXN0b3J5ID0gYWdncmVnYXRlRm9sbG93ZXJIaXN0b3J5KGZvbGxvd2VySGlzdG9yeSk7XG5cbiAgcmV0dXJuIHtcbiAgICB0b3RhbEZvbGxvd2VycyxcbiAgICB0b3RhbEVuZ2FnZW1lbnQsXG4gICAgdG90YWxSZWFjaCxcbiAgICBwbGF0Zm9ybURpc3RyaWJ1dGlvbixcbiAgICBmb2xsb3dlckhpc3Rvcnk6IGFnZ3JlZ2F0ZWRGb2xsb3dlckhpc3RvcnksXG4gICAgcG9zdEFuYWx5dGljcyxcbiAgICB0b3BQb3N0czogc29ydGVkVG9wUG9zdHNcbiAgfTtcbn1cblxuZnVuY3Rpb24gYWdncmVnYXRlRm9sbG93ZXJIaXN0b3J5KGhpc3Rvcnk6IGFueVtdKTogYW55W10ge1xuICBjb25zdCBhZ2dyZWdhdGVkOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG4gIFxuICBoaXN0b3J5LmZvckVhY2goaXRlbSA9PiB7XG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGl0ZW0uZGF0ZSkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xuICAgIGFnZ3JlZ2F0ZWRbZGF0ZV0gPSAoYWdncmVnYXRlZFtkYXRlXSB8fCAwKSArIChpdGVtLmZvbGxvd2VycyB8fCAwKTtcbiAgfSk7XG5cbiAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKGFnZ3JlZ2F0ZWQpXG4gICAgLm1hcCgoW2RhdGUsIGZvbGxvd2Vyc10pID0+ICh7IGRhdGUsIGZvbGxvd2VycyB9KSlcbiAgICAuc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYS5kYXRlKS5nZXRUaW1lKCkgLSBuZXcgRGF0ZShiLmRhdGUpLmdldFRpbWUoKSk7XG59XG5cbmZ1bmN0aW9uIGNhbGN1bGF0ZUdyb3d0aFJhdGUoZm9sbG93ZXJIaXN0b3J5OiBhbnlbXSk6IG51bWJlciB7XG4gIGlmIChmb2xsb3dlckhpc3RvcnkubGVuZ3RoIDwgMikgcmV0dXJuIDA7XG4gIFxuICBjb25zdCBmaXJzdCA9IGZvbGxvd2VySGlzdG9yeVswXS5mb2xsb3dlcnM7XG4gIGNvbnN0IGxhc3QgPSBmb2xsb3dlckhpc3RvcnlbZm9sbG93ZXJIaXN0b3J5Lmxlbmd0aCAtIDFdLmZvbGxvd2VycztcbiAgXG4gIHJldHVybiBmaXJzdCA+IDAgPyAoKGxhc3QgLSBmaXJzdCkgLyBmaXJzdCkgKiAxMDAgOiAwO1xufVxuXG5mdW5jdGlvbiBnZXRQb3N0TWV0cmljcyhwb3N0SWQ6IHN0cmluZywgcG9zdEFuYWx5dGljczogYW55W10pOiBhbnkge1xuICBjb25zdCBwb3N0ID0gcG9zdEFuYWx5dGljcy5maW5kKHAgPT4gcC5pZCA9PT0gcG9zdElkKTtcbiAgcmV0dXJuIHBvc3QgPyB7XG4gICAgbGlrZXM6IHBvc3QubGlrZXMgfHwgMCxcbiAgICBjb21tZW50czogcG9zdC5jb21tZW50cyB8fCAwLFxuICAgIHNoYXJlczogcG9zdC5zaGFyZXMgfHwgMCxcbiAgICB2aWV3czogcG9zdC52aWV3cyB8fCAwXG4gIH0gOiB7fTtcbn0iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiZ2V0U2VydmVyU2Vzc2lvbiIsImF1dGhPcHRpb25zIiwicHJpc21hIiwiRmFjZWJvb2tTZXJ2aWNlIiwiVmFsaWRhdGlvbkVycm9yIiwiQXV0aGVudGljYXRpb25FcnJvciIsImxvZ2dlciIsIkdFVCIsInJlcXVlc3QiLCJzZXNzaW9uIiwidXNlciIsImlkIiwiZW1haWwiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJpbmNsdWRlIiwiYnVzaW5lc3MiLCJzb2NpYWxBY2NvdW50cyIsImlzQWN0aXZlIiwic2VsZWN0IiwicGxhdGZvcm0iLCJhY2NvdW50SWQiLCJhY2Nlc3NUb2tlbiIsImV4cGlyZXNBdCIsInNldHRpbmdzIiwiYnVzaW5lc3NJZCIsIm5vdyIsIkRhdGUiLCJ0aGlydHlEYXlzQWdvIiwiZ2V0VGltZSIsInNldmVuRGF5c0FnbyIsInNvY2lhbEFuYWx5dGljcyIsImZldGNoU29jaWFsTWVkaWFBbmFseXRpY3MiLCJ0b3RhbFBvc3RzIiwic2NoZWR1bGVkUG9zdHMiLCJwdWJsaXNoZWRQb3N0cyIsInNvY2lhbEFjY291bnRzQ291bnQiLCJyZWNlbnRQb3N0cyIsIlByb21pc2UiLCJhbGwiLCJwb3N0IiwiY291bnQiLCJjcmVhdGVkQXQiLCJndGUiLCJzdGF0dXMiLCJzY2hlZHVsZWRBdCIsInB1Ymxpc2hlZEF0Iiwic29jaWFsQWNjb3VudCIsImZpbmRNYW55Iiwib3JkZXJCeSIsInRha2UiLCJjb250ZW50IiwidG90YWxGb2xsb3dlcnMiLCJ0b3RhbEVuZ2FnZW1lbnQiLCJ0b3RhbFJlYWNoIiwiZW5nYWdlbWVudFJhdGUiLCJ0b0ZpeGVkIiwiZm9sbG93ZXJHcm93dGgiLCJjYWxjdWxhdGVHcm93dGhSYXRlIiwiZm9sbG93ZXJIaXN0b3J5IiwicmVjZW50QWN0aXZpdHkiLCJtYXAiLCJ0eXBlIiwiY29udGVudFR5cGUiLCJjb250ZW50VGV4dCIsInN1YnN0cmluZyIsInBsYXRmb3JtcyIsIm1ldHJpY3MiLCJwZXJmb3JtYW5jZU1ldHJpY3MiLCJnZXRQb3N0TWV0cmljcyIsInBvc3RBbmFseXRpY3MiLCJyZXNwb25zZSIsInBhcnNlRmxvYXQiLCJwbGF0Zm9ybURpc3RyaWJ1dGlvbiIsInRvcFBvc3RzIiwidGltZVJhbmdlIiwic3RhcnQiLCJ0b0lTT1N0cmluZyIsImVuZCIsImNvbnNvbGUiLCJsb2ciLCJKU09OIiwic3RyaW5naWZ5IiwianNvbiIsImVycm9yIiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsImZhY2Vib29rU2VydmljZSIsImFjY291bnQiLCJhbmFseXRpY3MiLCJnZXRBY2NvdW50QW5hbHl0aWNzIiwiZm9sbG93ZXJzIiwicHVzaCIsInBvc3RzIiwiRXJyb3IiLCJtZXNzYWdlIiwic29ydGVkVG9wUG9zdHMiLCJzb3J0IiwiYSIsImIiLCJlbmdhZ2VtZW50Iiwic2xpY2UiLCJhZ2dyZWdhdGVkRm9sbG93ZXJIaXN0b3J5IiwiYWdncmVnYXRlRm9sbG93ZXJIaXN0b3J5IiwiaGlzdG9yeSIsImFnZ3JlZ2F0ZWQiLCJmb3JFYWNoIiwiaXRlbSIsImRhdGUiLCJzcGxpdCIsIk9iamVjdCIsImVudHJpZXMiLCJsZW5ndGgiLCJmaXJzdCIsImxhc3QiLCJwb3N0SWQiLCJmaW5kIiwicCIsImxpa2VzIiwiY29tbWVudHMiLCJzaGFyZXMiLCJ2aWV3cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/analytics/dashboard/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authOptions: () => (/* binding */ authOptions)\n/* harmony export */ });\n/* harmony import */ var _auth_prisma_adapter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @auth/prisma-adapter */ \"(rsc)/./node_modules/@auth/prisma-adapter/index.js\");\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n/* harmony import */ var next_auth_providers_google__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth/providers/google */ \"(rsc)/./node_modules/next-auth/providers/google.js\");\n/* harmony import */ var next_auth_providers_facebook__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next-auth/providers/facebook */ \"(rsc)/./node_modules/next-auth/providers/facebook.js\");\n/* harmony import */ var next_auth_providers_twitter__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next-auth/providers/twitter */ \"(rsc)/./node_modules/next-auth/providers/twitter.js\");\n/* harmony import */ var next_auth_providers_linkedin__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next-auth/providers/linkedin */ \"(rsc)/./node_modules/next-auth/providers/linkedin.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n\n\n\n\n\n\n\n\nconst authOptions = {\n    adapter: (0,_auth_prisma_adapter__WEBPACK_IMPORTED_MODULE_0__.PrismaAdapter)(_lib_prisma__WEBPACK_IMPORTED_MODULE_7__.prisma),\n    providers: [\n        (0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n            name: \"credentials\",\n            credentials: {\n                email: {\n                    label: \"Email\",\n                    type: \"email\"\n                },\n                password: {\n                    label: \"Password\",\n                    type: \"password\"\n                }\n            },\n            async authorize (credentials) {\n                if (!credentials?.email || !credentials?.password) {\n                    return null;\n                }\n                const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_7__.prisma.user.findUnique({\n                    where: {\n                        email: credentials.email\n                    }\n                });\n                if (!user || !user.passwordHash) {\n                    return null;\n                }\n                const isPasswordValid = await bcryptjs__WEBPACK_IMPORTED_MODULE_6__[\"default\"].compare(credentials.password, user.passwordHash);\n                if (!isPasswordValid) {\n                    return null;\n                }\n                return {\n                    id: user.id,\n                    email: user.email,\n                    name: user.name,\n                    role: user.role,\n                    businessId: user.businessId,\n                    image: user.avatar,\n                    tenantId: user.tenantId\n                };\n            }\n        }),\n        (0,next_auth_providers_google__WEBPACK_IMPORTED_MODULE_2__[\"default\"])({\n            clientId: process.env.GOOGLE_CLIENT_ID || \"\",\n            clientSecret: process.env.GOOGLE_CLIENT_SECRET || \"\"\n        }),\n        (0,next_auth_providers_facebook__WEBPACK_IMPORTED_MODULE_3__[\"default\"])({\n            clientId: process.env.FACEBOOK_CLIENT_ID || \"\",\n            clientSecret: process.env.FACEBOOK_CLIENT_SECRET || \"\"\n        }),\n        (0,next_auth_providers_twitter__WEBPACK_IMPORTED_MODULE_4__[\"default\"])({\n            clientId: process.env.TWITTER_CLIENT_ID || \"\",\n            clientSecret: process.env.TWITTER_CLIENT_SECRET || \"\",\n            version: \"2.0\"\n        }),\n        (0,next_auth_providers_linkedin__WEBPACK_IMPORTED_MODULE_5__[\"default\"])({\n            clientId: process.env.LINKEDIN_CLIENT_ID || \"\",\n            clientSecret: process.env.LINKEDIN_CLIENT_SECRET || \"\"\n        })\n    ],\n    session: {\n        strategy: \"jwt\"\n    },\n    callbacks: {\n        async jwt ({ token, user, account }) {\n            if (user) {\n                token.role = user.role;\n                token.businessId = user.businessId;\n                token.id = user.id;\n                token.email = user.email || \"\";\n            }\n            if (account) {\n                token.accessToken = account.access_token;\n                token.provider = account.provider;\n                token.providerAccountId = account.providerAccountId;\n            }\n            return token;\n        },\n        async session ({ session, token }) {\n            if (token) {\n                session.user.id = token.id;\n                session.user.role = token.role;\n                session.user.businessId = token.businessId;\n                session.user.email = token.email;\n                session.accessToken = token.accessToken;\n                session.provider = token.provider;\n                session.providerAccountId = token.providerAccountId;\n            }\n            return session;\n        },\n        async signIn ({ user, account, profile }) {\n            if (account && user) {\n                // Store social account information\n                const existingAccount = await _lib_prisma__WEBPACK_IMPORTED_MODULE_7__.prisma.socialAccount.findFirst({\n                    where: {\n                        platform: account.provider,\n                        accountId: account.providerAccountId\n                    }\n                });\n                if (!existingAccount && user.businessId) {\n                    await _lib_prisma__WEBPACK_IMPORTED_MODULE_7__.prisma.socialAccount.create({\n                        data: {\n                            businessId: user.businessId,\n                            platform: account.provider,\n                            accountId: account.providerAccountId,\n                            accountName: profile?.name || account.providerAccountId || \"Unknown Account\",\n                            accessToken: account.access_token,\n                            refreshToken: account.refresh_token,\n                            expiresAt: account.expires_at ? new Date(account.expires_at * 1000) : undefined\n                        }\n                    });\n                }\n            }\n            return true;\n        }\n    },\n    pages: {\n        signIn: \"/auth/signin\",\n        error: \"/auth/error\"\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFLbkIsUUFBUWtCLFVBQVUsR0FBRyxRQUFRRTt3QkFDeEU7b0JBQ0Y7Z0JBQ0Y7WUFDRjtZQUNBLE9BQU87UUFDVDtJQUNGO0lBQ0FDLE9BQU87UUFDTGhCLFFBQVE7UUFDUmlCLE9BQU87SUFDVDtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zb2NpYWxwaWxvYXQtYWkvLi9zcmMvbGliL2F1dGgudHM/NjY5MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXV0aE9wdGlvbnMgfSBmcm9tICduZXh0LWF1dGgnO1xyXG5pbXBvcnQgeyBQcmlzbWFBZGFwdGVyIH0gZnJvbSAnQGF1dGgvcHJpc21hLWFkYXB0ZXInO1xyXG5pbXBvcnQgQ3JlZGVudGlhbHNQcm92aWRlciBmcm9tICduZXh0LWF1dGgvcHJvdmlkZXJzL2NyZWRlbnRpYWxzJztcclxuaW1wb3J0IEdvb2dsZVByb3ZpZGVyIGZyb20gJ25leHQtYXV0aC9wcm92aWRlcnMvZ29vZ2xlJztcclxuaW1wb3J0IEZhY2Vib29rUHJvdmlkZXIgZnJvbSAnbmV4dC1hdXRoL3Byb3ZpZGVycy9mYWNlYm9vayc7XHJcbmltcG9ydCBUd2l0dGVyUHJvdmlkZXIgZnJvbSAnbmV4dC1hdXRoL3Byb3ZpZGVycy90d2l0dGVyJztcclxuaW1wb3J0IExpbmtlZEluUHJvdmlkZXIgZnJvbSAnbmV4dC1hdXRoL3Byb3ZpZGVycy9saW5rZWRpbic7XHJcbmltcG9ydCBiY3J5cHQgZnJvbSAnYmNyeXB0anMnO1xyXG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICdAL2xpYi9wcmlzbWEnO1xyXG5pbXBvcnQgeyBTb2NpYWxQbGF0Zm9ybSB9IGZyb20gJ0BwcmlzbWEvY2xpZW50JztcclxuaW1wb3J0IHsgVXNlclJvbGUgfSBmcm9tICdAL2xpYi9hdXRoLXR5cGVzJztcclxuXHJcbmV4cG9ydCBjb25zdCBhdXRoT3B0aW9uczogTmV4dEF1dGhPcHRpb25zID0ge1xyXG4gIGFkYXB0ZXI6IFByaXNtYUFkYXB0ZXIocHJpc21hKSBhcyBhbnksXHJcbiAgcHJvdmlkZXJzOiBbXHJcbiAgICBDcmVkZW50aWFsc1Byb3ZpZGVyKHtcclxuICAgICAgbmFtZTogJ2NyZWRlbnRpYWxzJyxcclxuICAgICAgY3JlZGVudGlhbHM6IHtcclxuICAgICAgICBlbWFpbDogeyBsYWJlbDogJ0VtYWlsJywgdHlwZTogJ2VtYWlsJyB9LFxyXG4gICAgICAgIHBhc3N3b3JkOiB7IGxhYmVsOiAnUGFzc3dvcmQnLCB0eXBlOiAncGFzc3dvcmQnIH1cclxuICAgICAgfSxcclxuICAgICAgYXN5bmMgYXV0aG9yaXplKGNyZWRlbnRpYWxzKSB7XHJcbiAgICAgICAgaWYgKCFjcmVkZW50aWFscz8uZW1haWwgfHwgIWNyZWRlbnRpYWxzPy5wYXNzd29yZCkge1xyXG4gICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICB3aGVyZTogeyBlbWFpbDogY3JlZGVudGlhbHMuZW1haWwgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXVzZXIgfHwgIXVzZXIucGFzc3dvcmRIYXNoKSB7XHJcbiAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGlzUGFzc3dvcmRWYWxpZCA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKGNyZWRlbnRpYWxzLnBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkSGFzaCk7XHJcbiAgICAgICAgaWYgKCFpc1Bhc3N3b3JkVmFsaWQpIHtcclxuICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIGlkOiB1c2VyLmlkLFxyXG4gICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXHJcbiAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUsXHJcbiAgICAgICAgICByb2xlOiB1c2VyLnJvbGUsXHJcbiAgICAgICAgICBidXNpbmVzc0lkOiB1c2VyLmJ1c2luZXNzSWQsXHJcbiAgICAgICAgICBpbWFnZTogdXNlci5hdmF0YXIsXHJcbiAgICAgICAgICB0ZW5hbnRJZDogdXNlci50ZW5hbnRJZFxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgIH0pLFxyXG4gICAgR29vZ2xlUHJvdmlkZXIoe1xyXG4gICAgICBjbGllbnRJZDogcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9JRCB8fCAnJyxcclxuICAgICAgY2xpZW50U2VjcmV0OiBwcm9jZXNzLmVudi5HT09HTEVfQ0xJRU5UX1NFQ1JFVCB8fCAnJyxcclxuICAgIH0pLFxyXG4gICAgRmFjZWJvb2tQcm92aWRlcih7XHJcbiAgICAgIGNsaWVudElkOiBwcm9jZXNzLmVudi5GQUNFQk9PS19DTElFTlRfSUQgfHwgJycsXHJcbiAgICAgIGNsaWVudFNlY3JldDogcHJvY2Vzcy5lbnYuRkFDRUJPT0tfQ0xJRU5UX1NFQ1JFVCB8fCAnJyxcclxuICAgIH0pLFxyXG4gICAgVHdpdHRlclByb3ZpZGVyKHtcclxuICAgICAgY2xpZW50SWQ6IHByb2Nlc3MuZW52LlRXSVRURVJfQ0xJRU5UX0lEIHx8ICcnLFxyXG4gICAgICBjbGllbnRTZWNyZXQ6IHByb2Nlc3MuZW52LlRXSVRURVJfQ0xJRU5UX1NFQ1JFVCB8fCAnJyxcclxuICAgICAgdmVyc2lvbjogJzIuMCcsXHJcbiAgICB9KSxcclxuICAgIExpbmtlZEluUHJvdmlkZXIoe1xyXG4gICAgICBjbGllbnRJZDogcHJvY2Vzcy5lbnYuTElOS0VESU5fQ0xJRU5UX0lEIHx8ICcnLFxyXG4gICAgICBjbGllbnRTZWNyZXQ6IHByb2Nlc3MuZW52LkxJTktFRElOX0NMSUVOVF9TRUNSRVQgfHwgJycsXHJcbiAgICB9KSxcclxuICBdLFxyXG4gIHNlc3Npb246IHtcclxuICAgIHN0cmF0ZWd5OiAnand0JyxcclxuICB9LFxyXG4gIGNhbGxiYWNrczoge1xyXG4gICAgYXN5bmMgand0KHsgdG9rZW4sIHVzZXIsIGFjY291bnQgfSkge1xyXG4gICAgICBpZiAodXNlcikge1xyXG4gICAgICAgIHRva2VuLnJvbGUgPSB1c2VyLnJvbGU7XHJcbiAgICAgICAgdG9rZW4uYnVzaW5lc3NJZCA9IHVzZXIuYnVzaW5lc3NJZDtcclxuICAgICAgICB0b2tlbi5pZCA9IHVzZXIuaWQ7XHJcbiAgICAgICAgdG9rZW4uZW1haWwgPSB1c2VyLmVtYWlsIHx8ICcnO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBpZiAoYWNjb3VudCkge1xyXG4gICAgICAgIHRva2VuLmFjY2Vzc1Rva2VuID0gYWNjb3VudC5hY2Nlc3NfdG9rZW47XHJcbiAgICAgICAgdG9rZW4ucHJvdmlkZXIgPSBhY2NvdW50LnByb3ZpZGVyO1xyXG4gICAgICAgIHRva2VuLnByb3ZpZGVyQWNjb3VudElkID0gYWNjb3VudC5wcm92aWRlckFjY291bnRJZDtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHRva2VuO1xyXG4gICAgfSxcclxuICAgIGFzeW5jIHNlc3Npb24oeyBzZXNzaW9uLCB0b2tlbiB9KSB7XHJcbiAgICAgIGlmICh0b2tlbikge1xyXG4gICAgICAgIHNlc3Npb24udXNlci5pZCA9IHRva2VuLmlkIGFzIHN0cmluZztcclxuICAgICAgICBzZXNzaW9uLnVzZXIucm9sZSA9IHRva2VuLnJvbGUgYXMgVXNlclJvbGU7XHJcbiAgICAgICAgc2Vzc2lvbi51c2VyLmJ1c2luZXNzSWQgPSB0b2tlbi5idXNpbmVzc0lkIGFzIHN0cmluZztcclxuICAgICAgICBzZXNzaW9uLnVzZXIuZW1haWwgPSB0b2tlbi5lbWFpbCBhcyBzdHJpbmc7XHJcbiAgICAgICAgc2Vzc2lvbi5hY2Nlc3NUb2tlbiA9IHRva2VuLmFjY2Vzc1Rva2VuIGFzIHN0cmluZztcclxuICAgICAgICBzZXNzaW9uLnByb3ZpZGVyID0gdG9rZW4ucHJvdmlkZXIgYXMgc3RyaW5nO1xyXG4gICAgICAgIHNlc3Npb24ucHJvdmlkZXJBY2NvdW50SWQgPSB0b2tlbi5wcm92aWRlckFjY291bnRJZCBhcyBzdHJpbmc7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHNlc3Npb247XHJcbiAgICB9LFxyXG4gICAgYXN5bmMgc2lnbkluKHsgdXNlciwgYWNjb3VudCwgcHJvZmlsZSB9KSB7XHJcbiAgICAgIGlmIChhY2NvdW50ICYmIHVzZXIpIHtcclxuICAgICAgICAvLyBTdG9yZSBzb2NpYWwgYWNjb3VudCBpbmZvcm1hdGlvblxyXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nQWNjb3VudCA9IGF3YWl0IHByaXNtYS5zb2NpYWxBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICBwbGF0Zm9ybTogYWNjb3VudC5wcm92aWRlciBhcyBTb2NpYWxQbGF0Zm9ybSxcclxuICAgICAgICAgICAgYWNjb3VudElkOiBhY2NvdW50LnByb3ZpZGVyQWNjb3VudElkIGFzIHN0cmluZyxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKCFleGlzdGluZ0FjY291bnQgJiYgdXNlci5idXNpbmVzc0lkKSB7XHJcbiAgICAgICAgICBhd2FpdCBwcmlzbWEuc29jaWFsQWNjb3VudC5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgYnVzaW5lc3NJZDogdXNlci5idXNpbmVzc0lkIGFzIHN0cmluZyxcclxuICAgICAgICAgICAgICBwbGF0Zm9ybTogYWNjb3VudC5wcm92aWRlciBhcyBTb2NpYWxQbGF0Zm9ybSxcclxuICAgICAgICAgICAgICBhY2NvdW50SWQ6IGFjY291bnQucHJvdmlkZXJBY2NvdW50SWQgYXMgc3RyaW5nLFxyXG4gICAgICAgICAgICAgIGFjY291bnROYW1lOiAocHJvZmlsZSBhcyBhbnkpPy5uYW1lIHx8IGFjY291bnQucHJvdmlkZXJBY2NvdW50SWQgfHwgJ1Vua25vd24gQWNjb3VudCcsXHJcbiAgICAgICAgICAgICAgYWNjZXNzVG9rZW46IGFjY291bnQuYWNjZXNzX3Rva2VuIGFzIHN0cmluZyxcclxuICAgICAgICAgICAgICByZWZyZXNoVG9rZW46IGFjY291bnQucmVmcmVzaF90b2tlbiBhcyBzdHJpbmcsXHJcbiAgICAgICAgICAgICAgZXhwaXJlc0F0OiBhY2NvdW50LmV4cGlyZXNfYXQgPyBuZXcgRGF0ZShhY2NvdW50LmV4cGlyZXNfYXQgKiAxMDAwKSA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgcGFnZXM6IHtcclxuICAgIHNpZ25JbjogJy9hdXRoL3NpZ25pbicsXHJcbiAgICBlcnJvcjogJy9hdXRoL2Vycm9yJyxcclxuICB9LFxyXG59OyJdLCJuYW1lcyI6WyJQcmlzbWFBZGFwdGVyIiwiQ3JlZGVudGlhbHNQcm92aWRlciIsIkdvb2dsZVByb3ZpZGVyIiwiRmFjZWJvb2tQcm92aWRlciIsIlR3aXR0ZXJQcm92aWRlciIsIkxpbmtlZEluUHJvdmlkZXIiLCJiY3J5cHQiLCJwcmlzbWEiLCJhdXRoT3B0aW9ucyIsImFkYXB0ZXIiLCJwcm92aWRlcnMiLCJuYW1lIiwiY3JlZGVudGlhbHMiLCJlbWFpbCIsImxhYmVsIiwidHlwZSIsInBhc3N3b3JkIiwiYXV0aG9yaXplIiwidXNlciIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsInBhc3N3b3JkSGFzaCIsImlzUGFzc3dvcmRWYWxpZCIsImNvbXBhcmUiLCJpZCIsInJvbGUiLCJidXNpbmVzc0lkIiwiaW1hZ2UiLCJhdmF0YXIiLCJ0ZW5hbnRJZCIsImNsaWVudElkIiwicHJvY2VzcyIsImVudiIsIkdPT0dMRV9DTElFTlRfSUQiLCJjbGllbnRTZWNyZXQiLCJHT09HTEVfQ0xJRU5UX1NFQ1JFVCIsIkZBQ0VCT09LX0NMSUVOVF9JRCIsIkZBQ0VCT09LX0NMSUVOVF9TRUNSRVQiLCJUV0lUVEVSX0NMSUVOVF9JRCIsIlRXSVRURVJfQ0xJRU5UX1NFQ1JFVCIsInZlcnNpb24iLCJMSU5LRURJTl9DTElFTlRfSUQiLCJMSU5LRURJTl9DTElFTlRfU0VDUkVUIiwic2Vzc2lvbiIsInN0cmF0ZWd5IiwiY2FsbGJhY2tzIiwiand0IiwidG9rZW4iLCJhY2NvdW50IiwiYWNjZXNzVG9rZW4iLCJhY2Nlc3NfdG9rZW4iLCJwcm92aWRlciIsInByb3ZpZGVyQWNjb3VudElkIiwic2lnbkluIiwicHJvZmlsZSIsImV4aXN0aW5nQWNjb3VudCIsInNvY2lhbEFjY291bnQiLCJmaW5kRmlyc3QiLCJwbGF0Zm9ybSIsImFjY291bnRJZCIsImNyZWF0ZSIsImRhdGEiLCJhY2NvdW50TmFtZSIsInJlZnJlc2hUb2tlbiIsInJlZnJlc2hfdG9rZW4iLCJleHBpcmVzQXQiLCJleHBpcmVzX2F0IiwiRGF0ZSIsInVuZGVmaW5lZCIsInBhZ2VzIiwiZXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/db.ts":
/*!***********************!*\
  !*** ./src/lib/db.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   db: () => (/* binding */ db)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nif (process.platform === \"win32\" && process.env.PRISMA_QUERY_ENGINE_LIBRARY) {\n    delete process.env.PRISMA_QUERY_ENGINE_LIBRARY;\n}\nconst dbUrl = process.env.DATABASE_URL;\nif (dbUrl && /supabase\\.com/.test(dbUrl) && !/sslmode=/.test(dbUrl)) {\n    if (dbUrl.includes(\"?\")) {\n        process.env.DATABASE_URL = `${dbUrl}&sslmode=require`;\n    } else {\n        process.env.DATABASE_URL = `${dbUrl}?sslmode=require`;\n    }\n}\nconst db = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nif (true) globalForPrisma.prisma = db;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2RiLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE2QztBQUU3QyxNQUFNQyxrQkFBa0JDO0FBSXhCLElBQUlDLFFBQVFDLFFBQVEsS0FBSyxXQUFXRCxRQUFRRSxHQUFHLENBQUNDLDJCQUEyQixFQUFFO0lBQzNFLE9BQU9ILFFBQVFFLEdBQUcsQ0FBQ0MsMkJBQTJCO0FBQ2hEO0FBRUEsTUFBTUMsUUFBUUosUUFBUUUsR0FBRyxDQUFDRyxZQUFZO0FBQ3RDLElBQUlELFNBQVMsZ0JBQWdCRSxJQUFJLENBQUNGLFVBQVUsQ0FBQyxXQUFXRSxJQUFJLENBQUNGLFFBQVE7SUFDbkUsSUFBSUEsTUFBTUcsUUFBUSxDQUFDLE1BQU07UUFDdkJQLFFBQVFFLEdBQUcsQ0FBQ0csWUFBWSxHQUFHLENBQUMsRUFBRUQsTUFBTSxnQkFBZ0IsQ0FBQztJQUN2RCxPQUFPO1FBQ0xKLFFBQVFFLEdBQUcsQ0FBQ0csWUFBWSxHQUFHLENBQUMsRUFBRUQsTUFBTSxnQkFBZ0IsQ0FBQztJQUN2RDtBQUNGO0FBRU8sTUFBTUksS0FBS1YsZ0JBQWdCVyxNQUFNLElBQUksSUFBSVosd0RBQVlBLEdBQUU7QUFFOUQsSUFBSUcsSUFBeUIsRUFBY0YsZ0JBQWdCVyxNQUFNLEdBQUdEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc29jaWFscGlsb2F0LWFpLy4vc3JjL2xpYi9kYi50cz85ZTRmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50J1xyXG5cclxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcclxuICBwcmlzbWE6IFByaXNtYUNsaWVudCB8IHVuZGVmaW5lZFxyXG59XHJcblxyXG5pZiAocHJvY2Vzcy5wbGF0Zm9ybSA9PT0gJ3dpbjMyJyAmJiBwcm9jZXNzLmVudi5QUklTTUFfUVVFUllfRU5HSU5FX0xJQlJBUlkpIHtcclxuICBkZWxldGUgcHJvY2Vzcy5lbnYuUFJJU01BX1FVRVJZX0VOR0lORV9MSUJSQVJZXHJcbn1cclxuXHJcbmNvbnN0IGRiVXJsID0gcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMXHJcbmlmIChkYlVybCAmJiAvc3VwYWJhc2VcXC5jb20vLnRlc3QoZGJVcmwpICYmICEvc3NsbW9kZT0vLnRlc3QoZGJVcmwpKSB7XHJcbiAgaWYgKGRiVXJsLmluY2x1ZGVzKCc/JykpIHtcclxuICAgIHByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTCA9IGAke2RiVXJsfSZzc2xtb2RlPXJlcXVpcmVgXHJcbiAgfSBlbHNlIHtcclxuICAgIHByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTCA9IGAke2RiVXJsfT9zc2xtb2RlPXJlcXVpcmVgXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZGIgPSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID8/IG5ldyBQcmlzbWFDbGllbnQoKVxyXG5cclxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPSBkYiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJnbG9iYWxGb3JQcmlzbWEiLCJnbG9iYWxUaGlzIiwicHJvY2VzcyIsInBsYXRmb3JtIiwiZW52IiwiUFJJU01BX1FVRVJZX0VOR0lORV9MSUJSQVJZIiwiZGJVcmwiLCJEQVRBQkFTRV9VUkwiLCJ0ZXN0IiwiaW5jbHVkZXMiLCJkYiIsInByaXNtYSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/error-handling/error-handler.ts":
/*!*************************************************!*\
  !*** ./src/lib/error-handling/error-handler.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AuthenticationError: () => (/* binding */ AuthenticationError),\n/* harmony export */   AuthorizationError: () => (/* binding */ AuthorizationError),\n/* harmony export */   ConflictError: () => (/* binding */ ConflictError),\n/* harmony export */   CustomError: () => (/* binding */ CustomError),\n/* harmony export */   ExternalServiceError: () => (/* binding */ ExternalServiceError),\n/* harmony export */   NotFoundError: () => (/* binding */ NotFoundError),\n/* harmony export */   RateLimitError: () => (/* binding */ RateLimitError),\n/* harmony export */   ValidationError: () => (/* binding */ ValidationError),\n/* harmony export */   apiHandler: () => (/* binding */ apiHandler),\n/* harmony export */   checkRateLimit: () => (/* binding */ checkRateLimit),\n/* harmony export */   handleApiError: () => (/* binding */ handleApiError),\n/* harmony export */   sanitizeInput: () => (/* binding */ sanitizeInput),\n/* harmony export */   validateRequestData: () => (/* binding */ validateRequestData)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_monitoring_monitoring_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/monitoring/monitoring-service */ \"(rsc)/./src/lib/monitoring/monitoring-service.ts\");\n/* harmony import */ var _lib_security_security_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/security/security-service */ \"(rsc)/./src/lib/security/security-service.ts\");\n\n\n\nconst securityService = new _lib_security_security_service__WEBPACK_IMPORTED_MODULE_2__.SecurityService();\nclass CustomError extends Error {\n    constructor(message, statusCode = 500, code, details){\n        super(message);\n        this.statusCode = statusCode;\n        this.isOperational = true;\n        this.code = code;\n        this.details = details;\n        Error.captureStackTrace(this, this.constructor);\n    }\n}\nclass ValidationError extends CustomError {\n    constructor(message, details){\n        super(message, 400, \"VALIDATION_ERROR\", details);\n    }\n}\nclass AuthenticationError extends CustomError {\n    constructor(message = \"Authentication required\"){\n        super(message, 401, \"AUTHENTICATION_ERROR\");\n    }\n}\nclass AuthorizationError extends CustomError {\n    constructor(message = \"Access denied\"){\n        super(message, 403, \"AUTHORIZATION_ERROR\");\n    }\n}\nclass NotFoundError extends CustomError {\n    constructor(resource){\n        super(`${resource} not found`, 404, \"NOT_FOUND_ERROR\");\n    }\n}\nclass ConflictError extends CustomError {\n    constructor(message){\n        super(message, 409, \"CONFLICT_ERROR\");\n    }\n}\nclass RateLimitError extends CustomError {\n    constructor(message = \"Too many requests\"){\n        super(message, 429, \"RATE_LIMIT_ERROR\");\n    }\n}\nclass ExternalServiceError extends CustomError {\n    constructor(service, message){\n        super(message || `${service} service unavailable`, 503, \"EXTERNAL_SERVICE_ERROR\", {\n            service\n        });\n    }\n}\n/**\r\n * Global error handler for API routes\r\n */ function handleApiError(error) {\n    let appError;\n    if (error instanceof CustomError) {\n        appError = error;\n    } else if (error instanceof Error) {\n        appError = new CustomError(error.message, 500, \"INTERNAL_ERROR\");\n    } else {\n        appError = new CustomError(\"An unexpected error occurred\", 500, \"UNKNOWN_ERROR\");\n    }\n    // Log error to monitoring service\n    _lib_monitoring_monitoring_service__WEBPACK_IMPORTED_MODULE_1__.monitoringService.logError(appError, {\n        statusCode: appError.statusCode,\n        code: appError.code,\n        details: appError.details,\n        stack: appError.stack\n    });\n    // Log security events for certain error types\n    if (appError.statusCode === 401 || appError.statusCode === 403) {\n        securityService.logSecurityEvent({\n            type: \"authentication_error\",\n            severity: appError.statusCode === 403 ? \"high\" : \"medium\",\n            message: appError.message,\n            metadata: appError.details\n        });\n    }\n    if (appError.statusCode === 429) {\n        securityService.logSecurityEvent({\n            type: \"rate_limit_exceeded\",\n            severity: \"medium\",\n            message: appError.message,\n            metadata: appError.details\n        });\n    }\n    return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n        error: {\n            message: appError.message,\n            code: appError.code,\n            statusCode: appError.statusCode,\n            details: appError.isOperational ? appError.details : undefined\n        }\n    }, {\n        status: appError.statusCode\n    });\n}\n/**\r\n * Async wrapper for API route handlers\r\n */ function apiHandler(handler) {\n    return async (req)=>{\n        try {\n            return await handler(req);\n        } catch (error) {\n            return handleApiError(error);\n        }\n    };\n}\n/**\r\n * Validate request data\r\n */ function validateRequestData(data, schema) {\n    const errors = {};\n    const validatedData = {};\n    for (const [key, validator] of Object.entries(schema)){\n        const value = data[key];\n        if (value === undefined || value === null) {\n            errors[key] = `${key} is required`;\n            continue;\n        }\n        const validatorFn = validator;\n        if (!validatorFn(value)) {\n            errors[key] = `${key} is invalid`;\n            continue;\n        }\n        validatedData[key] = value;\n    }\n    if (Object.keys(errors).length > 0) {\n        throw new ValidationError(\"Validation failed\", errors);\n    }\n    return validatedData;\n}\n/**\r\n * Rate limiting helper\r\n */ function checkRateLimit(clientId) {\n    const rateLimit = securityService.checkRateLimit(clientId);\n    if (!rateLimit.allowed) {\n        throw new RateLimitError(`Rate limit exceeded. Try again in ${Math.ceil((rateLimit.resetTime - Date.now()) / 1000)} seconds.`);\n    }\n}\n/**\r\n * Sanitize input data\r\n */ function sanitizeInput(data) {\n    const sanitized = {};\n    for (const [key, value] of Object.entries(data)){\n        if (typeof value === \"string\") {\n            const suspiciousCheck = securityService.checkSuspiciousPatterns(value);\n            if (suspiciousCheck.isSuspicious) {\n                throw new ValidationError(`Suspicious input detected in ${key}: ${suspiciousCheck.reason}`);\n            }\n            sanitized[key] = securityService.sanitizeInput(value);\n        } else if (typeof value === \"object\" && value !== null) {\n            sanitized[key] = sanitizeInput(value);\n        } else {\n            sanitized[key] = value;\n        }\n    }\n    return sanitized;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2Vycm9yLWhhbmRsaW5nL2Vycm9yLWhhbmRsZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUEyQztBQUM2QjtBQUNOO0FBRWxFLE1BQU1HLGtCQUFrQixJQUFJRCwyRUFBZUE7QUFTcEMsTUFBTUUsb0JBQW9CQztJQU0vQkMsWUFDRUMsT0FBZSxFQUNmQyxhQUFxQixHQUFHLEVBQ3hCQyxJQUFhLEVBQ2JDLE9BQTZCLENBQzdCO1FBQ0EsS0FBSyxDQUFDSDtRQUNOLElBQUksQ0FBQ0MsVUFBVSxHQUFHQTtRQUNsQixJQUFJLENBQUNHLGFBQWEsR0FBRztRQUNyQixJQUFJLENBQUNGLElBQUksR0FBR0E7UUFDWixJQUFJLENBQUNDLE9BQU8sR0FBR0E7UUFFZkwsTUFBTU8saUJBQWlCLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQ04sV0FBVztJQUNoRDtBQUNGO0FBRU8sTUFBTU8sd0JBQXdCVDtJQUNuQ0UsWUFBWUMsT0FBZSxFQUFFRyxPQUE2QixDQUFFO1FBQzFELEtBQUssQ0FBQ0gsU0FBUyxLQUFLLG9CQUFvQkc7SUFDMUM7QUFDRjtBQUVPLE1BQU1JLDRCQUE0QlY7SUFDdkNFLFlBQVlDLFVBQWtCLHlCQUF5QixDQUFFO1FBQ3ZELEtBQUssQ0FBQ0EsU0FBUyxLQUFLO0lBQ3RCO0FBQ0Y7QUFFTyxNQUFNUSwyQkFBMkJYO0lBQ3RDRSxZQUFZQyxVQUFrQixlQUFlLENBQUU7UUFDN0MsS0FBSyxDQUFDQSxTQUFTLEtBQUs7SUFDdEI7QUFDRjtBQUVPLE1BQU1TLHNCQUFzQlo7SUFDakNFLFlBQVlXLFFBQWdCLENBQUU7UUFDNUIsS0FBSyxDQUFDLENBQUMsRUFBRUEsU0FBUyxVQUFVLENBQUMsRUFBRSxLQUFLO0lBQ3RDO0FBQ0Y7QUFFTyxNQUFNQyxzQkFBc0JkO0lBQ2pDRSxZQUFZQyxPQUFlLENBQUU7UUFDM0IsS0FBSyxDQUFDQSxTQUFTLEtBQUs7SUFDdEI7QUFDRjtBQUVPLE1BQU1ZLHVCQUF1QmY7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LGdCQUFnQixxQkFBcUIyQjtJQUNqRDtJQUVBLE9BQU9DO0FBQ1Q7QUFFQTs7Q0FFQyxHQUNNLFNBQVNTLGVBQWVDLFFBQWdCO0lBQzdDLE1BQU1DLFlBQVlqRCxnQkFBZ0IrQyxjQUFjLENBQUNDO0lBRWpELElBQUksQ0FBQ0MsVUFBVUMsT0FBTyxFQUFFO1FBQ3RCLE1BQU0sSUFBSWxDLGVBQWUsQ0FBQyxrQ0FBa0MsRUFBRW1DLEtBQUtDLElBQUksQ0FBQyxDQUFDSCxVQUFVSSxTQUFTLEdBQUdDLEtBQUtDLEdBQUcsRUFBQyxJQUFLLE1BQU0sU0FBUyxDQUFDO0lBQy9IO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLFNBQVNDLGNBQWNyQixJQUF5QjtJQUNyRCxNQUFNc0IsWUFBaUMsQ0FBQztJQUV4QyxLQUFLLE1BQU0sQ0FBQ2xCLEtBQUtJLE1BQU0sSUFBSUYsT0FBT0MsT0FBTyxDQUFDUCxNQUFPO1FBQy9DLElBQUksT0FBT1EsVUFBVSxVQUFVO1lBQzdCLE1BQU1lLGtCQUFrQjFELGdCQUFnQjJELHVCQUF1QixDQUFDaEI7WUFDaEUsSUFBSWUsZ0JBQWdCRSxZQUFZLEVBQUU7Z0JBQ2hDLE1BQU0sSUFBSWxELGdCQUFnQixDQUFDLDZCQUE2QixFQUFFNkIsSUFBSSxFQUFFLEVBQUVtQixnQkFBZ0JHLE1BQU0sQ0FBQyxDQUFDO1lBQzVGO1lBQ0FKLFNBQVMsQ0FBQ2xCLElBQUksR0FBR3ZDLGdCQUFnQndELGFBQWEsQ0FBQ2I7UUFDakQsT0FBTyxJQUFJLE9BQU9BLFVBQVUsWUFBWUEsVUFBVSxNQUFNO1lBQ3REYyxTQUFTLENBQUNsQixJQUFJLEdBQUdpQixjQUFjYjtRQUNqQyxPQUFPO1lBQ0xjLFNBQVMsQ0FBQ2xCLElBQUksR0FBR0k7UUFDbkI7SUFDRjtJQUVBLE9BQU9jO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zb2NpYWxwaWxvYXQtYWkvLi9zcmMvbGliL2Vycm9yLWhhbmRsaW5nL2Vycm9yLWhhbmRsZXIudHM/MDJiNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XHJcbmltcG9ydCB7IG1vbml0b3JpbmdTZXJ2aWNlIH0gZnJvbSAnQC9saWIvbW9uaXRvcmluZy9tb25pdG9yaW5nLXNlcnZpY2UnO1xyXG5pbXBvcnQgeyBTZWN1cml0eVNlcnZpY2UgfSBmcm9tICdAL2xpYi9zZWN1cml0eS9zZWN1cml0eS1zZXJ2aWNlJztcclxuXHJcbmNvbnN0IHNlY3VyaXR5U2VydmljZSA9IG5ldyBTZWN1cml0eVNlcnZpY2UoKTtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQXBwRXJyb3IgZXh0ZW5kcyBFcnJvciB7XHJcbiAgc3RhdHVzQ29kZTogbnVtYmVyO1xyXG4gIGlzT3BlcmF0aW9uYWw6IGJvb2xlYW47XHJcbiAgY29kZT86IHN0cmluZztcclxuICBkZXRhaWxzPzogUmVjb3JkPHN0cmluZywgYW55PjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEN1c3RvbUVycm9yIGV4dGVuZHMgRXJyb3IgaW1wbGVtZW50cyBBcHBFcnJvciB7XHJcbiAgc3RhdHVzQ29kZTogbnVtYmVyO1xyXG4gIGlzT3BlcmF0aW9uYWw6IGJvb2xlYW47XHJcbiAgY29kZT86IHN0cmluZztcclxuICBkZXRhaWxzPzogUmVjb3JkPHN0cmluZywgYW55PjtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBtZXNzYWdlOiBzdHJpbmcsXHJcbiAgICBzdGF0dXNDb2RlOiBudW1iZXIgPSA1MDAsXHJcbiAgICBjb2RlPzogc3RyaW5nLFxyXG4gICAgZGV0YWlscz86IFJlY29yZDxzdHJpbmcsIGFueT5cclxuICApIHtcclxuICAgIHN1cGVyKG1lc3NhZ2UpO1xyXG4gICAgdGhpcy5zdGF0dXNDb2RlID0gc3RhdHVzQ29kZTtcclxuICAgIHRoaXMuaXNPcGVyYXRpb25hbCA9IHRydWU7XHJcbiAgICB0aGlzLmNvZGUgPSBjb2RlO1xyXG4gICAgdGhpcy5kZXRhaWxzID0gZGV0YWlscztcclxuXHJcbiAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBWYWxpZGF0aW9uRXJyb3IgZXh0ZW5kcyBDdXN0b21FcnJvciB7XHJcbiAgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nLCBkZXRhaWxzPzogUmVjb3JkPHN0cmluZywgYW55Pikge1xyXG4gICAgc3VwZXIobWVzc2FnZSwgNDAwLCAnVkFMSURBVElPTl9FUlJPUicsIGRldGFpbHMpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEF1dGhlbnRpY2F0aW9uRXJyb3IgZXh0ZW5kcyBDdXN0b21FcnJvciB7XHJcbiAgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nID0gJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkJykge1xyXG4gICAgc3VwZXIobWVzc2FnZSwgNDAxLCAnQVVUSEVOVElDQVRJT05fRVJST1InKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBBdXRob3JpemF0aW9uRXJyb3IgZXh0ZW5kcyBDdXN0b21FcnJvciB7XHJcbiAgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nID0gJ0FjY2VzcyBkZW5pZWQnKSB7XHJcbiAgICBzdXBlcihtZXNzYWdlLCA0MDMsICdBVVRIT1JJWkFUSU9OX0VSUk9SJyk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgTm90Rm91bmRFcnJvciBleHRlbmRzIEN1c3RvbUVycm9yIHtcclxuICBjb25zdHJ1Y3RvcihyZXNvdXJjZTogc3RyaW5nKSB7XHJcbiAgICBzdXBlcihgJHtyZXNvdXJjZX0gbm90IGZvdW5kYCwgNDA0LCAnTk9UX0ZPVU5EX0VSUk9SJyk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQ29uZmxpY3RFcnJvciBleHRlbmRzIEN1c3RvbUVycm9yIHtcclxuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcpIHtcclxuICAgIHN1cGVyKG1lc3NhZ2UsIDQwOSwgJ0NPTkZMSUNUX0VSUk9SJyk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgUmF0ZUxpbWl0RXJyb3IgZXh0ZW5kcyBDdXN0b21FcnJvciB7XHJcbiAgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nID0gJ1RvbyBtYW55IHJlcXVlc3RzJykge1xyXG4gICAgc3VwZXIobWVzc2FnZSwgNDI5LCAnUkFURV9MSU1JVF9FUlJPUicpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEV4dGVybmFsU2VydmljZUVycm9yIGV4dGVuZHMgQ3VzdG9tRXJyb3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNlcnZpY2U6IHN0cmluZywgbWVzc2FnZT86IHN0cmluZykge1xyXG4gICAgc3VwZXIobWVzc2FnZSB8fCBgJHtzZXJ2aWNlfSBzZXJ2aWNlIHVuYXZhaWxhYmxlYCwgNTAzLCAnRVhURVJOQUxfU0VSVklDRV9FUlJPUicsIHsgc2VydmljZSB9KTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHbG9iYWwgZXJyb3IgaGFuZGxlciBmb3IgQVBJIHJvdXRlc1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZUFwaUVycm9yKGVycm9yOiB1bmtub3duKTogTmV4dFJlc3BvbnNlIHtcclxuICBsZXQgYXBwRXJyb3I6IEFwcEVycm9yO1xyXG5cclxuICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBDdXN0b21FcnJvcikge1xyXG4gICAgYXBwRXJyb3IgPSBlcnJvcjtcclxuICB9IGVsc2UgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcclxuICAgIGFwcEVycm9yID0gbmV3IEN1c3RvbUVycm9yKGVycm9yLm1lc3NhZ2UsIDUwMCwgJ0lOVEVSTkFMX0VSUk9SJyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGFwcEVycm9yID0gbmV3IEN1c3RvbUVycm9yKCdBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkJywgNTAwLCAnVU5LTk9XTl9FUlJPUicpO1xyXG4gIH1cclxuXHJcbiAgLy8gTG9nIGVycm9yIHRvIG1vbml0b3Jpbmcgc2VydmljZVxyXG4gIG1vbml0b3JpbmdTZXJ2aWNlLmxvZ0Vycm9yKGFwcEVycm9yLCB7XHJcbiAgICBzdGF0dXNDb2RlOiBhcHBFcnJvci5zdGF0dXNDb2RlLFxyXG4gICAgY29kZTogYXBwRXJyb3IuY29kZSxcclxuICAgIGRldGFpbHM6IGFwcEVycm9yLmRldGFpbHMsXHJcbiAgICBzdGFjazogYXBwRXJyb3Iuc3RhY2ssXHJcbiAgfSk7XHJcblxyXG4gIC8vIExvZyBzZWN1cml0eSBldmVudHMgZm9yIGNlcnRhaW4gZXJyb3IgdHlwZXNcclxuICBpZiAoYXBwRXJyb3Iuc3RhdHVzQ29kZSA9PT0gNDAxIHx8IGFwcEVycm9yLnN0YXR1c0NvZGUgPT09IDQwMykge1xyXG4gICAgc2VjdXJpdHlTZXJ2aWNlLmxvZ1NlY3VyaXR5RXZlbnQoe1xyXG4gICAgICB0eXBlOiAnYXV0aGVudGljYXRpb25fZXJyb3InLFxyXG4gICAgICBzZXZlcml0eTogYXBwRXJyb3Iuc3RhdHVzQ29kZSA9PT0gNDAzID8gJ2hpZ2gnIDogJ21lZGl1bScsXHJcbiAgICAgIG1lc3NhZ2U6IGFwcEVycm9yLm1lc3NhZ2UsXHJcbiAgICAgIG1ldGFkYXRhOiBhcHBFcnJvci5kZXRhaWxzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBpZiAoYXBwRXJyb3Iuc3RhdHVzQ29kZSA9PT0gNDI5KSB7XHJcbiAgICBzZWN1cml0eVNlcnZpY2UubG9nU2VjdXJpdHlFdmVudCh7XHJcbiAgICAgIHR5cGU6ICdyYXRlX2xpbWl0X2V4Y2VlZGVkJyxcclxuICAgICAgc2V2ZXJpdHk6ICdtZWRpdW0nLFxyXG4gICAgICBtZXNzYWdlOiBhcHBFcnJvci5tZXNzYWdlLFxyXG4gICAgICBtZXRhZGF0YTogYXBwRXJyb3IuZGV0YWlscyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAge1xyXG4gICAgICBlcnJvcjoge1xyXG4gICAgICAgIG1lc3NhZ2U6IGFwcEVycm9yLm1lc3NhZ2UsXHJcbiAgICAgICAgY29kZTogYXBwRXJyb3IuY29kZSxcclxuICAgICAgICBzdGF0dXNDb2RlOiBhcHBFcnJvci5zdGF0dXNDb2RlLFxyXG4gICAgICAgIGRldGFpbHM6IGFwcEVycm9yLmlzT3BlcmF0aW9uYWwgPyBhcHBFcnJvci5kZXRhaWxzIDogdW5kZWZpbmVkLFxyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICAgIHsgc3RhdHVzOiBhcHBFcnJvci5zdGF0dXNDb2RlIH1cclxuICApO1xyXG59XHJcblxyXG4vKipcclxuICogQXN5bmMgd3JhcHBlciBmb3IgQVBJIHJvdXRlIGhhbmRsZXJzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gYXBpSGFuZGxlcihoYW5kbGVyOiAocmVxOiBSZXF1ZXN0KSA9PiBQcm9taXNlPFJlc3BvbnNlPikge1xyXG4gIHJldHVybiBhc3luYyAocmVxOiBSZXF1ZXN0KTogUHJvbWlzZTxSZXNwb25zZT4gPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgcmV0dXJuIGF3YWl0IGhhbmRsZXIocmVxKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHJldHVybiBoYW5kbGVBcGlFcnJvcihlcnJvcik7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlIHJlcXVlc3QgZGF0YVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlUmVxdWVzdERhdGE8VD4oXHJcbiAgZGF0YTogYW55LFxyXG4gIHNjaGVtYTogUmVjb3JkPGtleW9mIFQsICh2YWx1ZTogYW55KSA9PiBib29sZWFuPlxyXG4pOiBUIHtcclxuICBjb25zdCBlcnJvcnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcclxuICBjb25zdCB2YWxpZGF0ZWREYXRhOiBQYXJ0aWFsPFQ+ID0ge307XHJcblxyXG4gIGZvciAoY29uc3QgW2tleSwgdmFsaWRhdG9yXSBvZiBPYmplY3QuZW50cmllcyhzY2hlbWEpKSB7XHJcbiAgICBjb25zdCB2YWx1ZSA9IGRhdGFba2V5XTtcclxuICAgIFxyXG4gICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwpIHtcclxuICAgICAgZXJyb3JzW2tleV0gPSBgJHtrZXl9IGlzIHJlcXVpcmVkYDtcclxuICAgICAgY29udGludWU7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdmFsaWRhdG9yRm4gPSB2YWxpZGF0b3IgYXMgKHZhbHVlOiBhbnkpID0+IGJvb2xlYW47XHJcbiAgICBpZiAoIXZhbGlkYXRvckZuKHZhbHVlKSkge1xyXG4gICAgICBlcnJvcnNba2V5XSA9IGAke2tleX0gaXMgaW52YWxpZGA7XHJcbiAgICAgIGNvbnRpbnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHZhbGlkYXRlZERhdGFba2V5IGFzIGtleW9mIFRdID0gdmFsdWU7XHJcbiAgfVxyXG5cclxuICBpZiAoT2JqZWN0LmtleXMoZXJyb3JzKS5sZW5ndGggPiAwKSB7XHJcbiAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKCdWYWxpZGF0aW9uIGZhaWxlZCcsIGVycm9ycyk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gdmFsaWRhdGVkRGF0YSBhcyBUO1xyXG59XHJcblxyXG4vKipcclxuICogUmF0ZSBsaW1pdGluZyBoZWxwZXJcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjaGVja1JhdGVMaW1pdChjbGllbnRJZDogc3RyaW5nKTogdm9pZCB7XHJcbiAgY29uc3QgcmF0ZUxpbWl0ID0gc2VjdXJpdHlTZXJ2aWNlLmNoZWNrUmF0ZUxpbWl0KGNsaWVudElkKTtcclxuICBcclxuICBpZiAoIXJhdGVMaW1pdC5hbGxvd2VkKSB7XHJcbiAgICB0aHJvdyBuZXcgUmF0ZUxpbWl0RXJyb3IoYFJhdGUgbGltaXQgZXhjZWVkZWQuIFRyeSBhZ2FpbiBpbiAke01hdGguY2VpbCgocmF0ZUxpbWl0LnJlc2V0VGltZSAtIERhdGUubm93KCkpIC8gMTAwMCl9IHNlY29uZHMuYCk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogU2FuaXRpemUgaW5wdXQgZGF0YVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHNhbml0aXplSW5wdXQoZGF0YTogUmVjb3JkPHN0cmluZywgYW55Pik6IFJlY29yZDxzdHJpbmcsIGFueT4ge1xyXG4gIGNvbnN0IHNhbml0aXplZDogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xyXG4gIFxyXG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGRhdGEpKSB7XHJcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgICBjb25zdCBzdXNwaWNpb3VzQ2hlY2sgPSBzZWN1cml0eVNlcnZpY2UuY2hlY2tTdXNwaWNpb3VzUGF0dGVybnModmFsdWUpO1xyXG4gICAgICBpZiAoc3VzcGljaW91c0NoZWNrLmlzU3VzcGljaW91cykge1xyXG4gICAgICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoYFN1c3BpY2lvdXMgaW5wdXQgZGV0ZWN0ZWQgaW4gJHtrZXl9OiAke3N1c3BpY2lvdXNDaGVjay5yZWFzb259YCk7XHJcbiAgICAgIH1cclxuICAgICAgc2FuaXRpemVkW2tleV0gPSBzZWN1cml0eVNlcnZpY2Uuc2FuaXRpemVJbnB1dCh2YWx1ZSk7XHJcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgc2FuaXRpemVkW2tleV0gPSBzYW5pdGl6ZUlucHV0KHZhbHVlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNhbml0aXplZFtrZXldID0gdmFsdWU7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiBzYW5pdGl6ZWQ7XHJcbn0iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwibW9uaXRvcmluZ1NlcnZpY2UiLCJTZWN1cml0eVNlcnZpY2UiLCJzZWN1cml0eVNlcnZpY2UiLCJDdXN0b21FcnJvciIsIkVycm9yIiwiY29uc3RydWN0b3IiLCJtZXNzYWdlIiwic3RhdHVzQ29kZSIsImNvZGUiLCJkZXRhaWxzIiwiaXNPcGVyYXRpb25hbCIsImNhcHR1cmVTdGFja1RyYWNlIiwiVmFsaWRhdGlvbkVycm9yIiwiQXV0aGVudGljYXRpb25FcnJvciIsIkF1dGhvcml6YXRpb25FcnJvciIsIk5vdEZvdW5kRXJyb3IiLCJyZXNvdXJjZSIsIkNvbmZsaWN0RXJyb3IiLCJSYXRlTGltaXRFcnJvciIsIkV4dGVybmFsU2VydmljZUVycm9yIiwic2VydmljZSIsImhhbmRsZUFwaUVycm9yIiwiZXJyb3IiLCJhcHBFcnJvciIsImxvZ0Vycm9yIiwic3RhY2siLCJsb2dTZWN1cml0eUV2ZW50IiwidHlwZSIsInNldmVyaXR5IiwibWV0YWRhdGEiLCJqc29uIiwidW5kZWZpbmVkIiwic3RhdHVzIiwiYXBpSGFuZGxlciIsImhhbmRsZXIiLCJyZXEiLCJ2YWxpZGF0ZVJlcXVlc3REYXRhIiwiZGF0YSIsInNjaGVtYSIsImVycm9ycyIsInZhbGlkYXRlZERhdGEiLCJrZXkiLCJ2YWxpZGF0b3IiLCJPYmplY3QiLCJlbnRyaWVzIiwidmFsdWUiLCJ2YWxpZGF0b3JGbiIsImtleXMiLCJsZW5ndGgiLCJjaGVja1JhdGVMaW1pdCIsImNsaWVudElkIiwicmF0ZUxpbWl0IiwiYWxsb3dlZCIsIk1hdGgiLCJjZWlsIiwicmVzZXRUaW1lIiwiRGF0ZSIsIm5vdyIsInNhbml0aXplSW5wdXQiLCJzYW5pdGl6ZWQiLCJzdXNwaWNpb3VzQ2hlY2siLCJjaGVja1N1c3BpY2lvdXNQYXR0ZXJucyIsImlzU3VzcGljaW91cyIsInJlYXNvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/error-handling/error-handler.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/logging/logger-service.ts":
/*!*******************************************!*\
  !*** ./src/lib/logging/logger-service.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LogLevel: () => (/* binding */ LogLevel),\n/* harmony export */   LoggerService: () => (/* binding */ LoggerService),\n/* harmony export */   logger: () => (/* binding */ logger)\n/* harmony export */ });\n/* harmony import */ var _lib_monitoring_monitoring_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/monitoring/monitoring-service */ \"(rsc)/./src/lib/monitoring/monitoring-service.ts\");\n/* harmony import */ var _lib_security_security_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/security/security-service */ \"(rsc)/./src/lib/security/security-service.ts\");\n\n\nconst securityService = new _lib_security_security_service__WEBPACK_IMPORTED_MODULE_1__.SecurityService();\nvar LogLevel;\n(function(LogLevel) {\n    LogLevel[\"DEBUG\"] = \"debug\";\n    LogLevel[\"INFO\"] = \"info\";\n    LogLevel[\"WARN\"] = \"warn\";\n    LogLevel[\"ERROR\"] = \"error\";\n    LogLevel[\"FATAL\"] = \"fatal\";\n})(LogLevel || (LogLevel = {}));\nclass LoggerService {\n    constructor(){\n        this.logs = [];\n        this.maxLogsInMemory = 1000;\n        this.config = {\n            level: \"info\",\n            enableConsole: \"development\" !== \"production\",\n            enableFile: \"development\" === \"production\",\n            enableRemote: \"development\" === \"production\",\n            maxFileSize: 10 * 1024 * 1024,\n            maxFiles: 5\n        };\n    }\n    static getInstance() {\n        if (!LoggerService.instance) {\n            LoggerService.instance = new LoggerService();\n        }\n        return LoggerService.instance;\n    }\n    /**\r\n   * Set logger configuration\r\n   */ setConfig(config) {\n        this.config = {\n            ...this.config,\n            ...config\n        };\n    }\n    /**\r\n   * Create log entry\r\n   */ createLogEntry(level, message, context, error, metadata) {\n        return {\n            timestamp: new Date().toISOString(),\n            level,\n            message,\n            context,\n            error,\n            metadata\n        };\n    }\n    /**\r\n   * Check if log level should be logged\r\n   */ shouldLog(level) {\n        const levels = [\n            \"debug\",\n            \"info\",\n            \"warn\",\n            \"error\",\n            \"fatal\"\n        ];\n        const configLevelIndex = levels.indexOf(this.config.level);\n        const logLevelIndex = levels.indexOf(level);\n        return logLevelIndex >= configLevelIndex;\n    }\n    /**\r\n   * Log to console\r\n   */ logToConsole(entry) {\n        if (!this.config.enableConsole) return;\n        const logMessage = `[${entry.timestamp}] [${entry.level.toUpperCase()}] ${entry.message}`;\n        switch(entry.level){\n            case \"debug\":\n                console.debug(logMessage, entry.context || \"\", entry.error || \"\");\n                break;\n            case \"info\":\n                console.info(logMessage, entry.context || \"\", entry.error || \"\");\n                break;\n            case \"warn\":\n                console.warn(logMessage, entry.context || \"\", entry.error || \"\");\n                break;\n            case \"error\":\n            case \"fatal\":\n                console.error(logMessage, entry.context || \"\", entry.error || \"\");\n                break;\n        }\n    }\n    /**\r\n   * Log to file (simplified version - in production would use proper file rotation)\r\n   */ async logToFile(entry) {\n        if (!this.config.enableFile) return;\n        // In a real implementation, this would write to a file with rotation\n        // For now, we'll store in memory and send to monitoring service\n        this.logs.push(entry);\n        // Keep only recent logs in memory\n        if (this.logs.length > this.maxLogsInMemory) {\n            this.logs = this.logs.slice(-this.maxLogsInMemory);\n        }\n        // Send errors to monitoring service\n        if (entry.level === \"error\" || entry.level === \"fatal\") {\n            _lib_monitoring_monitoring_service__WEBPACK_IMPORTED_MODULE_0__.monitoringService.logError(entry.error || new Error(entry.message), {\n                level: entry.level,\n                context: entry.context,\n                userId: entry.userId,\n                sessionId: entry.sessionId,\n                requestId: entry.requestId\n            });\n        }\n    }\n    /**\r\n   * Log to remote service\r\n   */ async logToRemote(entry) {\n        if (!this.config.enableRemote) return;\n        try {\n            // In production, this would send to external logging service\n            // For now, we'll send to monitoring service\n            if (entry.level === \"error\" || entry.level === \"fatal\") {\n                _lib_monitoring_monitoring_service__WEBPACK_IMPORTED_MODULE_0__.monitoringService.logError(entry.error || new Error(entry.message), {\n                    level: entry.level,\n                    context: entry.context,\n                    userId: entry.userId,\n                    sessionId: entry.sessionId,\n                    requestId: entry.requestId\n                });\n            }\n        } catch (error) {\n            console.error(\"Failed to send log to remote service:\", error);\n        }\n    }\n    /**\r\n   * Main logging method\r\n   */ async log(level, message, context, error, metadata) {\n        if (!this.shouldLog(level)) return;\n        const entry = this.createLogEntry(level, message, context, error, metadata);\n        this.logToConsole(entry);\n        await this.logToFile(entry);\n        await this.logToRemote(entry);\n    }\n    /**\r\n   * Debug logging\r\n   */ async debug(message, context, metadata) {\n        await this.log(\"debug\", message, context, undefined, metadata);\n    }\n    /**\r\n   * Info logging\r\n   */ async info(message, context, metadata) {\n        await this.log(\"info\", message, context, undefined, metadata);\n    }\n    /**\r\n   * Warning logging\r\n   */ async warn(message, context, metadata) {\n        await this.log(\"warn\", message, context, undefined, metadata);\n    }\n    /**\r\n   * Error logging\r\n   */ async error(message, error, context, metadata) {\n        await this.log(\"error\", message, context, error, metadata);\n    }\n    /**\r\n   * Fatal logging\r\n   */ async fatal(message, error, context, metadata) {\n        await this.log(\"fatal\", message, context, error, metadata);\n    }\n    /**\r\n   * Log API request\r\n   */ async logRequest(method, url, statusCode, responseTime, userId, requestId, metadata) {\n        const message = `${method} ${url} ${statusCode} ${responseTime}ms`;\n        const context = {\n            method,\n            url,\n            statusCode,\n            responseTime,\n            userId,\n            requestId\n        };\n        const level = statusCode >= 500 ? \"error\" : statusCode >= 400 ? \"warn\" : \"info\";\n        await this.log(level, message, context, undefined, metadata);\n    }\n    /**\r\n   * Log security event\r\n   */ async logSecurityEvent(type, severity, message, details) {\n        const context = {\n            type,\n            severity,\n            details\n        };\n        const level = severity === \"critical\" ? \"fatal\" : severity === \"high\" ? \"error\" : severity === \"medium\" ? \"warn\" : \"info\";\n        await this.log(level, `Security: ${message}`, context);\n        // Also log to security service\n        securityService.logSecurityEvent({\n            type,\n            severity,\n            message,\n            metadata: details\n        });\n    }\n    /**\r\n   * Get recent logs\r\n   */ getRecentLogs(level, limit = 100) {\n        let logs = this.logs;\n        if (level) {\n            logs = logs.filter((log)=>log.level === level);\n        }\n        return logs.slice(-limit);\n    }\n    /**\r\n   * Clear logs\r\n   */ clearLogs() {\n        this.logs = [];\n    }\n}\nconst logger = LoggerService.getInstance();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2xvZ2dpbmcvbG9nZ2VyLXNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBd0U7QUFDTjtBQUVsRSxNQUFNRSxrQkFBa0IsSUFBSUQsMkVBQWVBOztVQUUvQkU7Ozs7OztHQUFBQSxhQUFBQTtBQTZCTCxNQUFNQztJQU1YLGFBQXNCO2FBSGRDLE9BQW1CLEVBQUU7YUFDckJDLGtCQUFrQjtRQUd4QixJQUFJLENBQUNDLE1BQU0sR0FBRztZQUNaQyxLQUFLO1lBQ0xDLGVBQWVDLGtCQUF5QjtZQUN4Q0MsWUFBWUQsa0JBQXlCO1lBQ3JDRSxjQUFjRixrQkFBeUI7WUFDdkNHLGFBQWEsS0FBSyxPQUFPO1lBQ3pCQyxVQUFVO1FBQ1o7SUFDRjtJQUVBLE9BQU9DLGNBQTZCO1FBQ2xDLElBQUksQ0FBQ1gsY0FBY1ksUUFBUSxFQUFFO1lBQzNCWixjQUFjWSxRQUFRLEdBQUcsSUFBSVo7UUFDL0I7UUFDQSxPQUFPQSxjQUFjWSxRQUFRO0lBQy9CO0lBRUE7O0dBRUMsR0FDREMsVUFBVVYsTUFBNkIsRUFBUTtRQUM3QyxJQUFJLENBQUNBLE1BQU0sR0FBRztZQUFFLEdBQUcsSUFBSSxDQUFDQSxNQUFNO1lBQUUsR0FBR0EsTUFBTTtRQUFDO0lBQzVDO0lBRUE7O0dBRUMsR0FDRCxlQUNFQyxLQUFlLEVBQ2ZXLE9BQWUsRUFDZkMsT0FBNkIsRUFDN0JDLEtBQWEsRUFDYkMsUUFBOEIsRUFDcEI7UUFDVixPQUFPO1lBQ0xDLFdBQVcsSUFBSUMsT0FBT0MsV0FBVztZQUNqQ2pCO1lBQ0FXO1lBQ0FDO1lBQ0FDO1lBQ0FDO1FBQ0Y7SUFDRjtJQUVBOztHQUVDLEdBQ0QsVUFBa0JkLEtBQWUsRUFBVztRQUMxQyxNQUFNbUIsU0FBUzs7Ozs7O1NBQThFO1FBQzdGLE1BQU1DLG1CQUFtQkQsT0FBT0UsT0FBTyxDQUFDLElBQUksQ0FBQ3RCLE1BQU0sQ0FBQ0MsS0FBSztRQUN6RCxNQUFNc0IsZ0JBQWdCSCxPQUFPRSxPQUFPLENBQUNyQjtR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R0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovL3NvY2lhbHBpbG9hdC1haS8uL3NyYy9saWIvbG9nZ2luZy9sb2dnZXItc2VydmljZS50cz9hMjk4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG1vbml0b3JpbmdTZXJ2aWNlIH0gZnJvbSAnQC9saWIvbW9uaXRvcmluZy9tb25pdG9yaW5nLXNlcnZpY2UnO1xyXG5pbXBvcnQgeyBTZWN1cml0eVNlcnZpY2UgfSBmcm9tICdAL2xpYi9zZWN1cml0eS9zZWN1cml0eS1zZXJ2aWNlJztcclxuXHJcbmNvbnN0IHNlY3VyaXR5U2VydmljZSA9IG5ldyBTZWN1cml0eVNlcnZpY2UoKTtcclxuXHJcbmV4cG9ydCBlbnVtIExvZ0xldmVsIHtcclxuICBERUJVRyA9ICdkZWJ1ZycsXHJcbiAgSU5GTyA9ICdpbmZvJyxcclxuICBXQVJOID0gJ3dhcm4nLFxyXG4gIEVSUk9SID0gJ2Vycm9yJyxcclxuICBGQVRBTCA9ICdmYXRhbCcsXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgTG9nRW50cnkge1xyXG4gIHRpbWVzdGFtcDogc3RyaW5nO1xyXG4gIGxldmVsOiBMb2dMZXZlbDtcclxuICBtZXNzYWdlOiBzdHJpbmc7XHJcbiAgY29udGV4dD86IFJlY29yZDxzdHJpbmcsIGFueT47XHJcbiAgZXJyb3I/OiBFcnJvcjtcclxuICB1c2VySWQ/OiBzdHJpbmc7XHJcbiAgc2Vzc2lvbklkPzogc3RyaW5nO1xyXG4gIHJlcXVlc3RJZD86IHN0cmluZztcclxuICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT47XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgTG9nZ2VyQ29uZmlnIHtcclxuICBsZXZlbDogTG9nTGV2ZWw7XHJcbiAgZW5hYmxlQ29uc29sZTogYm9vbGVhbjtcclxuICBlbmFibGVGaWxlOiBib29sZWFuO1xyXG4gIGVuYWJsZVJlbW90ZTogYm9vbGVhbjtcclxuICBtYXhGaWxlU2l6ZTogbnVtYmVyO1xyXG4gIG1heEZpbGVzOiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBMb2dnZXJTZXJ2aWNlIHtcclxuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogTG9nZ2VyU2VydmljZTtcclxuICBwcml2YXRlIGNvbmZpZzogTG9nZ2VyQ29uZmlnO1xyXG4gIHByaXZhdGUgbG9nczogTG9nRW50cnlbXSA9IFtdO1xyXG4gIHByaXZhdGUgbWF4TG9nc0luTWVtb3J5ID0gMTAwMDtcclxuXHJcbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMuY29uZmlnID0ge1xyXG4gICAgICBsZXZlbDogTG9nTGV2ZWwuSU5GTyxcclxuICAgICAgZW5hYmxlQ29uc29sZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyxcclxuICAgICAgZW5hYmxlRmlsZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyxcclxuICAgICAgZW5hYmxlUmVtb3RlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nLFxyXG4gICAgICBtYXhGaWxlU2l6ZTogMTAgKiAxMDI0ICogMTAyNCwgLy8gMTBNQlxyXG4gICAgICBtYXhGaWxlczogNSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogTG9nZ2VyU2VydmljZSB7XHJcbiAgICBpZiAoIUxvZ2dlclNlcnZpY2UuaW5zdGFuY2UpIHtcclxuICAgICAgTG9nZ2VyU2VydmljZS5pbnN0YW5jZSA9IG5ldyBMb2dnZXJTZXJ2aWNlKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gTG9nZ2VyU2VydmljZS5pbnN0YW5jZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNldCBsb2dnZXIgY29uZmlndXJhdGlvblxyXG4gICAqL1xyXG4gIHNldENvbmZpZyhjb25maWc6IFBhcnRpYWw8TG9nZ2VyQ29uZmlnPik6IHZvaWQge1xyXG4gICAgdGhpcy5jb25maWcgPSB7IC4uLnRoaXMuY29uZmlnLCAuLi5jb25maWcgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZSBsb2cgZW50cnlcclxuICAgKi9cclxuICBwcml2YXRlIGNyZWF0ZUxvZ0VudHJ5KFxyXG4gICAgbGV2ZWw6IExvZ0xldmVsLFxyXG4gICAgbWVzc2FnZTogc3RyaW5nLFxyXG4gICAgY29udGV4dD86IFJlY29yZDxzdHJpbmcsIGFueT4sXHJcbiAgICBlcnJvcj86IEVycm9yLFxyXG4gICAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XHJcbiAgKTogTG9nRW50cnkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIGxldmVsLFxyXG4gICAgICBtZXNzYWdlLFxyXG4gICAgICBjb250ZXh0LFxyXG4gICAgICBlcnJvcixcclxuICAgICAgbWV0YWRhdGEsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2sgaWYgbG9nIGxldmVsIHNob3VsZCBiZSBsb2dnZWRcclxuICAgKi9cclxuICBwcml2YXRlIHNob3VsZExvZyhsZXZlbDogTG9nTGV2ZWwpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IGxldmVscyA9IFtMb2dMZXZlbC5ERUJVRywgTG9nTGV2ZWwuSU5GTywgTG9nTGV2ZWwuV0FSTiwgTG9nTGV2ZWwuRVJST1IsIExvZ0xldmVsLkZBVEFMXTtcclxuICAgIGNvbnN0IGNvbmZpZ0xldmVsSW5kZXggPSBsZXZlbHMuaW5kZXhPZih0aGlzLmNvbmZpZy5sZXZlbCk7XHJcbiAgICBjb25zdCBsb2dMZXZlbEluZGV4ID0gbGV2ZWxzLmluZGV4T2YobGV2ZWwpO1xyXG4gICAgXHJcbiAgICByZXR1cm4gbG9nTGV2ZWxJbmRleCA+PSBjb25maWdMZXZlbEluZGV4O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTG9nIHRvIGNvbnNvbGVcclxuICAgKi9cclxuICBwcml2YXRlIGxvZ1RvQ29uc29sZShlbnRyeTogTG9nRW50cnkpOiB2b2lkIHtcclxuICAgIGlmICghdGhpcy5jb25maWcuZW5hYmxlQ29uc29sZSkgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IGxvZ01lc3NhZ2UgPSBgWyR7ZW50cnkudGltZXN0YW1wfV0gWyR7ZW50cnkubGV2ZWwudG9VcHBlckNhc2UoKX1dICR7ZW50cnkubWVzc2FnZX1gO1xyXG4gICAgXHJcbiAgICBzd2l0Y2ggKGVudHJ5LmxldmVsKSB7XHJcbiAgICAgIGNhc2UgTG9nTGV2ZWwuREVCVUc6XHJcbiAgICAgICAgY29uc29sZS5kZWJ1Zyhsb2dNZXNzYWdlLCBlbnRyeS5jb250ZXh0IHx8ICcnLCBlbnRyeS5lcnJvciB8fCAnJyk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgTG9nTGV2ZWwuSU5GTzpcclxuICAgICAgICBjb25zb2xlLmluZm8obG9nTWVzc2FnZSwgZW50cnkuY29udGV4dCB8fCAnJywgZW50cnkuZXJyb3IgfHwgJycpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIExvZ0xldmVsLldBUk46XHJcbiAgICAgICAgY29uc29sZS53YXJuKGxvZ01lc3NhZ2UsIGVudHJ5LmNvbnRleHQgfHwgJycsIGVudHJ5LmVycm9yIHx8ICcnKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBMb2dMZXZlbC5FUlJPUjpcclxuICAgICAgY2FzZSBMb2dMZXZlbC5GQVRBTDpcclxuICAgICAgICBjb25zb2xlLmVycm9yKGxvZ01lc3NhZ2UsIGVudHJ5LmNvbnRleHQgfHwgJycsIGVudHJ5LmVycm9yIHx8ICcnKTtcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIExvZyB0byBmaWxlIChzaW1wbGlmaWVkIHZlcnNpb24gLSBpbiBwcm9kdWN0aW9uIHdvdWxkIHVzZSBwcm9wZXIgZmlsZSByb3RhdGlvbilcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGxvZ1RvRmlsZShlbnRyeTogTG9nRW50cnkpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGlmICghdGhpcy5jb25maWcuZW5hYmxlRmlsZSkgcmV0dXJuO1xyXG5cclxuICAgIC8vIEluIGEgcmVhbCBpbXBsZW1lbnRhdGlvbiwgdGhpcyB3b3VsZCB3cml0ZSB0byBhIGZpbGUgd2l0aCByb3RhdGlvblxyXG4gICAgLy8gRm9yIG5vdywgd2UnbGwgc3RvcmUgaW4gbWVtb3J5IGFuZCBzZW5kIHRvIG1vbml0b3Jpbmcgc2VydmljZVxyXG4gICAgdGhpcy5sb2dzLnB1c2goZW50cnkpO1xyXG4gICAgXHJcbiAgICAvLyBLZWVwIG9ubHkgcmVjZW50IGxvZ3MgaW4gbWVtb3J5XHJcbiAgICBpZiAodGhpcy5sb2dzLmxlbmd0aCA+IHRoaXMubWF4TG9nc0luTWVtb3J5KSB7XHJcbiAgICAgIHRoaXMubG9ncyA9IHRoaXMubG9ncy5zbGljZSgtdGhpcy5tYXhMb2dzSW5NZW1vcnkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNlbmQgZXJyb3JzIHRvIG1vbml0b3Jpbmcgc2VydmljZVxyXG4gICAgaWYgKGVudHJ5LmxldmVsID09PSBMb2dMZXZlbC5FUlJPUiB8fCBlbnRyeS5sZXZlbCA9PT0gTG9nTGV2ZWwuRkFUQUwpIHtcclxuICAgICAgbW9uaXRvcmluZ1NlcnZpY2UubG9nRXJyb3IoZW50cnkuZXJyb3IgfHwgbmV3IEVycm9yKGVudHJ5Lm1lc3NhZ2UpLCB7XHJcbiAgICAgICAgbGV2ZWw6IGVudHJ5LmxldmVsLFxyXG4gICAgICAgIGNvbnRleHQ6IGVudHJ5LmNvbnRleHQsXHJcbiAgICAgICAgdXNlcklkOiBlbnRyeS51c2VySWQsXHJcbiAgICAgICAgc2Vzc2lvbklkOiBlbnRyeS5zZXNzaW9uSWQsXHJcbiAgICAgICAgcmVxdWVzdElkOiBlbnRyeS5yZXF1ZXN0SWQsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTG9nIHRvIHJlbW90ZSBzZXJ2aWNlXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBsb2dUb1JlbW90ZShlbnRyeTogTG9nRW50cnkpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGlmICghdGhpcy5jb25maWcuZW5hYmxlUmVtb3RlKSByZXR1cm47XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gSW4gcHJvZHVjdGlvbiwgdGhpcyB3b3VsZCBzZW5kIHRvIGV4dGVybmFsIGxvZ2dpbmcgc2VydmljZVxyXG4gICAgICAvLyBGb3Igbm93LCB3ZSdsbCBzZW5kIHRvIG1vbml0b3Jpbmcgc2VydmljZVxyXG4gICAgICBpZiAoZW50cnkubGV2ZWwgPT09IExvZ0xldmVsLkVSUk9SIHx8IGVudHJ5LmxldmVsID09PSBMb2dMZXZlbC5GQVRBTCkge1xyXG4gICAgICAgIG1vbml0b3JpbmdTZXJ2aWNlLmxvZ0Vycm9yKGVudHJ5LmVycm9yIHx8IG5ldyBFcnJvcihlbnRyeS5tZXNzYWdlKSwge1xyXG4gICAgICAgICAgbGV2ZWw6IGVudHJ5LmxldmVsLFxyXG4gICAgICAgICAgY29udGV4dDogZW50cnkuY29udGV4dCxcclxuICAgICAgICAgIHVzZXJJZDogZW50cnkudXNlcklkLFxyXG4gICAgICAgICAgc2Vzc2lvbklkOiBlbnRyeS5zZXNzaW9uSWQsXHJcbiAgICAgICAgICByZXF1ZXN0SWQ6IGVudHJ5LnJlcXVlc3RJZCxcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHNlbmQgbG9nIHRvIHJlbW90ZSBzZXJ2aWNlOicsIGVycm9yKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE1haW4gbG9nZ2luZyBtZXRob2RcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGxvZyhcclxuICAgIGxldmVsOiBMb2dMZXZlbCxcclxuICAgIG1lc3NhZ2U6IHN0cmluZyxcclxuICAgIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+LFxyXG4gICAgZXJyb3I/OiBFcnJvcixcclxuICAgIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PlxyXG4gICk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgaWYgKCF0aGlzLnNob3VsZExvZyhsZXZlbCkpIHJldHVybjtcclxuXHJcbiAgICBjb25zdCBlbnRyeSA9IHRoaXMuY3JlYXRlTG9nRW50cnkobGV2ZWwsIG1lc3NhZ2UsIGNvbnRleHQsIGVycm9yLCBtZXRhZGF0YSk7XHJcbiAgICBcclxuICAgIHRoaXMubG9nVG9Db25zb2xlKGVudHJ5KTtcclxuICAgIGF3YWl0IHRoaXMubG9nVG9GaWxlKGVudHJ5KTtcclxuICAgIGF3YWl0IHRoaXMubG9nVG9SZW1vdGUoZW50cnkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGVidWcgbG9nZ2luZ1xyXG4gICAqL1xyXG4gIGFzeW5jIGRlYnVnKG1lc3NhZ2U6IHN0cmluZywgY29udGV4dD86IFJlY29yZDxzdHJpbmcsIGFueT4sIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55Pik6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgYXdhaXQgdGhpcy5sb2coTG9nTGV2ZWwuREVCVUcsIG1lc3NhZ2UsIGNvbnRleHQsIHVuZGVmaW5lZCwgbWV0YWRhdGEpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSW5mbyBsb2dnaW5nXHJcbiAgICovXHJcbiAgYXN5bmMgaW5mbyhtZXNzYWdlOiBzdHJpbmcsIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+LCBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGF3YWl0IHRoaXMubG9nKExvZ0xldmVsLklORk8sIG1lc3NhZ2UsIGNvbnRleHQsIHVuZGVmaW5lZCwgbWV0YWRhdGEpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogV2FybmluZyBsb2dnaW5nXHJcbiAgICovXHJcbiAgYXN5bmMgd2FybihtZXNzYWdlOiBzdHJpbmcsIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+LCBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGF3YWl0IHRoaXMubG9nKExvZ0xldmVsLldBUk4sIG1lc3NhZ2UsIGNvbnRleHQsIHVuZGVmaW5lZCwgbWV0YWRhdGEpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRXJyb3IgbG9nZ2luZ1xyXG4gICAqL1xyXG4gIGFzeW5jIGVycm9yKG1lc3NhZ2U6IHN0cmluZywgZXJyb3I/OiBFcnJvciwgY29udGV4dD86IFJlY29yZDxzdHJpbmcsIGFueT4sIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55Pik6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgYXdhaXQgdGhpcy5sb2coTG9nTGV2ZWwuRVJST1IsIG1lc3NhZ2UsIGNvbnRleHQsIGVycm9yLCBtZXRhZGF0YSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGYXRhbCBsb2dnaW5nXHJcbiAgICovXHJcbiAgYXN5bmMgZmF0YWwobWVzc2FnZTogc3RyaW5nLCBlcnJvcj86IEVycm9yLCBjb250ZXh0PzogUmVjb3JkPHN0cmluZywgYW55PiwgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBhd2FpdCB0aGlzLmxvZyhMb2dMZXZlbC5GQVRBTCwgbWVzc2FnZSwgY29udGV4dCwgZXJyb3IsIG1ldGFkYXRhKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIExvZyBBUEkgcmVxdWVzdFxyXG4gICAqL1xyXG4gIGFzeW5jIGxvZ1JlcXVlc3QoXHJcbiAgICBtZXRob2Q6IHN0cmluZyxcclxuICAgIHVybDogc3RyaW5nLFxyXG4gICAgc3RhdHVzQ29kZTogbnVtYmVyLFxyXG4gICAgcmVzcG9uc2VUaW1lOiBudW1iZXIsXHJcbiAgICB1c2VySWQ/OiBzdHJpbmcsXHJcbiAgICByZXF1ZXN0SWQ/OiBzdHJpbmcsXHJcbiAgICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT5cclxuICApOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGNvbnN0IG1lc3NhZ2UgPSBgJHttZXRob2R9ICR7dXJsfSAke3N0YXR1c0NvZGV9ICR7cmVzcG9uc2VUaW1lfW1zYDtcclxuICAgIGNvbnN0IGNvbnRleHQgPSB7XHJcbiAgICAgIG1ldGhvZCxcclxuICAgICAgdXJsLFxyXG4gICAgICBzdGF0dXNDb2RlLFxyXG4gICAgICByZXNwb25zZVRpbWUsXHJcbiAgICAgIHVzZXJJZCxcclxuICAgICAgcmVxdWVzdElkLFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBsZXZlbCA9IHN0YXR1c0NvZGUgPj0gNTAwID8gTG9nTGV2ZWwuRVJST1IgOiBcclxuICAgICAgICAgICAgICAgICAgc3RhdHVzQ29kZSA+PSA0MDAgPyBMb2dMZXZlbC5XQVJOIDogXHJcbiAgICAgICAgICAgICAgICAgIExvZ0xldmVsLklORk87XHJcblxyXG4gICAgYXdhaXQgdGhpcy5sb2cobGV2ZWwsIG1lc3NhZ2UsIGNvbnRleHQsIHVuZGVmaW5lZCwgbWV0YWRhdGEpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTG9nIHNlY3VyaXR5IGV2ZW50XHJcbiAgICovXHJcbiAgYXN5bmMgbG9nU2VjdXJpdHlFdmVudChcclxuICAgIHR5cGU6IHN0cmluZyxcclxuICAgIHNldmVyaXR5OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ2NyaXRpY2FsJyxcclxuICAgIG1lc3NhZ2U6IHN0cmluZyxcclxuICAgIGRldGFpbHM/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XHJcbiAgKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBjb25zdCBjb250ZXh0ID0ge1xyXG4gICAgICB0eXBlLFxyXG4gICAgICBzZXZlcml0eSxcclxuICAgICAgZGV0YWlscyxcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgbGV2ZWwgPSBzZXZlcml0eSA9PT0gJ2NyaXRpY2FsJyA/IExvZ0xldmVsLkZBVEFMIDpcclxuICAgICAgICAgICAgICAgICAgc2V2ZXJpdHkgPT09ICdoaWdoJyA/IExvZ0xldmVsLkVSUk9SIDpcclxuICAgICAgICAgICAgICAgICAgc2V2ZXJpdHkgPT09ICdtZWRpdW0nID8gTG9nTGV2ZWwuV0FSTiA6XHJcbiAgICAgICAgICAgICAgICAgIExvZ0xldmVsLklORk87XHJcblxyXG4gICAgYXdhaXQgdGhpcy5sb2cobGV2ZWwsIGBTZWN1cml0eTogJHttZXNzYWdlfWAsIGNvbnRleHQpO1xyXG4gICAgXHJcbiAgICAvLyBBbHNvIGxvZyB0byBzZWN1cml0eSBzZXJ2aWNlXHJcbiAgICBzZWN1cml0eVNlcnZpY2UubG9nU2VjdXJpdHlFdmVudCh7XHJcbiAgICAgIHR5cGUsXHJcbiAgICAgIHNldmVyaXR5LFxyXG4gICAgICBtZXNzYWdlLFxyXG4gICAgICBtZXRhZGF0YTogZGV0YWlscyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHJlY2VudCBsb2dzXHJcbiAgICovXHJcbiAgZ2V0UmVjZW50TG9ncyhsZXZlbD86IExvZ0xldmVsLCBsaW1pdDogbnVtYmVyID0gMTAwKTogTG9nRW50cnlbXSB7XHJcbiAgICBsZXQgbG9ncyA9IHRoaXMubG9ncztcclxuICAgIFxyXG4gICAgaWYgKGxldmVsKSB7XHJcbiAgICAgIGxvZ3MgPSBsb2dzLmZpbHRlcihsb2cgPT4gbG9nLmxldmVsID09PSBsZXZlbCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBsb2dzLnNsaWNlKC1saW1pdCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDbGVhciBsb2dzXHJcbiAgICovXHJcbiAgY2xlYXJMb2dzKCk6IHZvaWQge1xyXG4gICAgdGhpcy5sb2dzID0gW107XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgbG9nZ2VyID0gTG9nZ2VyU2VydmljZS5nZXRJbnN0YW5jZSgpOyJdLCJuYW1lcyI6WyJtb25pdG9yaW5nU2VydmljZSIsIlNlY3VyaXR5U2VydmljZSIsInNlY3VyaXR5U2VydmljZSIsIkxvZ0xldmVsIiwiTG9nZ2VyU2VydmljZSIsImxvZ3MiLCJtYXhMb2dzSW5NZW1vcnkiLCJjb25maWciLCJsZXZlbCIsImVuYWJsZUNvbnNvbGUiLCJwcm9jZXNzIiwiZW5hYmxlRmlsZSIsImVuYWJsZVJlbW90ZSIsIm1heEZpbGVTaXplIiwibWF4RmlsZXMiLCJnZXRJbnN0YW5jZSIsImluc3RhbmNlIiwic2V0Q29uZmlnIiwiY3JlYXRlTG9nRW50cnkiLCJtZXNzYWdlIiwiY29udGV4dCIsImVycm9yIiwibWV0YWRhdGEiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJzaG91bGRMb2ciLCJsZXZlbHMiLCJjb25maWdMZXZlbEluZGV4IiwiaW5kZXhPZiIsImxvZ0xldmVsSW5kZXgiLCJsb2dUb0NvbnNvbGUiLCJlbnRyeSIsImxvZ01lc3NhZ2UiLCJ0b1VwcGVyQ2FzZSIsImNvbnNvbGUiLCJkZWJ1ZyIsImluZm8iLCJ3YXJuIiwibG9nVG9GaWxlIiwicHVzaCIsImxlbmd0aCIsInNsaWNlIiwibG9nRXJyb3IiLCJFcnJvciIsInVzZXJJZCIsInNlc3Npb25JZCIsInJlcXVlc3RJZCIsImxvZ1RvUmVtb3RlIiwibG9nIiwidW5kZWZpbmVkIiwiZmF0YWwiLCJsb2dSZXF1ZXN0IiwibWV0aG9kIiwidXJsIiwic3RhdHVzQ29kZSIsInJlc3BvbnNlVGltZSIsImxvZ1NlY3VyaXR5RXZlbnQiLCJ0eXBlIiwic2V2ZXJpdHkiLCJkZXRhaWxzIiwiZ2V0UmVjZW50TG9ncyIsImxpbWl0IiwiZmlsdGVyIiwiY2xlYXJMb2dzIiwibG9nZ2VyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/logging/logger-service.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/monitoring/monitoring-service.ts":
/*!**************************************************!*\
  !*** ./src/lib/monitoring/monitoring-service.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MonitoringService: () => (/* binding */ MonitoringService),\n/* harmony export */   monitoringService: () => (/* binding */ monitoringService)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./src/lib/auth.ts\");\n\n\nclass MonitoringService {\n    constructor(){\n        this.metrics = new Map();\n        this.startTime = Date.now();\n    }\n    static getInstance() {\n        if (!MonitoringService.instance) {\n            MonitoringService.instance = new MonitoringService();\n        }\n        return MonitoringService.instance;\n    }\n    /**\r\n   * Record a metric\r\n   */ recordMetric(name, value) {\n        this.metrics.set(name, (this.metrics.get(name) || 0) + value);\n    }\n    /**\r\n   * Get all metrics\r\n   */ getMetrics() {\n        return Object.fromEntries(this.metrics);\n    }\n    /**\r\n   * Perform comprehensive health check\r\n   */ async performHealthCheck() {\n        const startTime = Date.now();\n        const checks = {\n            database: await this.checkDatabase(),\n            authentication: await this.checkAuthentication(),\n            external_services: await this.checkExternalServices()\n        };\n        // Determine overall status\n        let status = \"healthy\";\n        const allChecks = [\n            checks.database.status,\n            checks.authentication.status,\n            checks.external_services.status\n        ];\n        if (allChecks.includes(\"unhealthy\")) {\n            status = \"unhealthy\";\n        } else if (allChecks.includes(\"degraded\")) {\n            status = \"degraded\";\n        }\n        return {\n            status,\n            timestamp: new Date().toISOString(),\n            checks,\n            metrics: {\n                uptime: Date.now() - this.startTime,\n                total_requests: this.metrics.get(\"total_requests\") || 0,\n                error_rate: this.calculateErrorRate(),\n                average_response_time: this.metrics.get(\"avg_response_time\") || 0\n            }\n        };\n    }\n    /**\r\n   * Check database connectivity\r\n   */ async checkDatabase() {\n        const startTime = Date.now();\n        try {\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.$queryRaw`SELECT 1`;\n            return {\n                status: \"healthy\",\n                responseTime: Date.now() - startTime\n            };\n        } catch (error) {\n            return {\n                status: \"unhealthy\",\n                responseTime: Date.now() - startTime,\n                error: error instanceof Error ? error.message : \"Unknown database error\"\n            };\n        }\n    }\n    /**\r\n   * Check authentication system\r\n   */ async checkAuthentication() {\n        try {\n            // Test authentication configuration\n            const authConfig = await _lib_auth__WEBPACK_IMPORTED_MODULE_1__.authOptions;\n            if (!authConfig.providers || authConfig.providers.length === 0) {\n                throw new Error(\"No authentication providers configured\");\n            }\n            return {\n                status: \"healthy\"\n            };\n        } catch (error) {\n            return {\n                status: \"unhealthy\",\n                error: error instanceof Error ? error.message : \"Unknown authentication error\"\n            };\n        }\n    }\n    /**\r\n   * Check external services\r\n   */ async checkExternalServices() {\n        const services = {\n            facebook: await this.checkFacebookAPI(),\n            instagram: await this.checkInstagramAPI()\n        };\n        const statuses = Object.values(services).map((s)=>s.status);\n        let overallStatus = \"healthy\";\n        if (statuses.includes(\"unhealthy\")) {\n            overallStatus = \"unhealthy\";\n        } else if (statuses.includes(\"healthy\") && statuses.includes(\"unhealthy\")) {\n            overallStatus = \"degraded\";\n        }\n        return {\n            status: overallStatus,\n            services\n        };\n    }\n    /**\r\n   * Check Facebook API connectivity\r\n   */ async checkFacebookAPI() {\n        try {\n            // Simple Facebook API health check\n            const response = await fetch(\"https://graph.facebook.com/v18.0/me\", {\n                method: \"GET\",\n                headers: {\n                    \"Accept\": \"application/json\"\n                }\n            });\n            return {\n                status: response.ok ? \"healthy\" : \"unhealthy\",\n                responseTime: response.headers.get(\"x-response-time\") ? parseInt(response.headers.get(\"x-response-time\")) : undefined\n            };\n        } catch (error) {\n            return {\n                status: \"unhealthy\",\n                error: error instanceof Error ? error.message : \"Facebook API unavailable\"\n            };\n        }\n    }\n    /**\r\n   * Check Instagram API connectivity\r\n   */ async checkInstagramAPI() {\n        try {\n            // Simple Instagram API health check\n            const response = await fetch(\"https://graph.facebook.com/v18.0/instagram-business-account\", {\n                method: \"GET\",\n                headers: {\n                    \"Accept\": \"application/json\"\n                }\n            });\n            return {\n                status: response.ok ? \"healthy\" : \"unhealthy\",\n                responseTime: response.headers.get(\"x-response-time\") ? parseInt(response.headers.get(\"x-response-time\")) : undefined\n            };\n        } catch (error) {\n            return {\n                status: \"unhealthy\",\n                error: error instanceof Error ? error.message : \"Instagram API unavailable\"\n            };\n        }\n    }\n    /**\r\n   * Calculate error rate\r\n   */ calculateErrorRate() {\n        const totalRequests = this.metrics.get(\"total_requests\") || 0;\n        const errorRequests = this.metrics.get(\"error_requests\") || 0;\n        if (totalRequests === 0) return 0;\n        return errorRequests / totalRequests * 100;\n    }\n    /**\r\n   * Log application error\r\n   */ logError(error, context) {\n        this.recordMetric(\"error_requests\", 1);\n        const errorLog = {\n            timestamp: new Date().toISOString(),\n            message: error.message,\n            stack: error.stack,\n            context\n        };\n        // In production, this would send to external logging service\n        console.error(\"Application Error:\", errorLog);\n    }\n    /**\r\n   * Log security events for monitoring and alerting\r\n   */ logSecurityEvent(event) {\n        this.recordMetric(\"security_events\", 1);\n        const securityLog = {\n            timestamp: new Date().toISOString(),\n            ...event\n        };\n        // In production, this would send to SIEM/security service\n        console.log(`[SECURITY] ${event.severity.toUpperCase()}: ${event.type} - ${event.message}`);\n        // For high/critical severity, you might want to trigger alerts\n        if (event.severity === \"high\" || event.severity === \"critical\") {\n            console.warn(\"HIGH PRIORITY SECURITY EVENT - Consider alerting:\", securityLog);\n        }\n    }\n    /**\r\n   * Log performance metric\r\n   */ logPerformance(metricName, duration, metadata) {\n        this.recordMetric(metricName, duration);\n        const performanceLog = {\n            timestamp: new Date().toISOString(),\n            metric: metricName,\n            duration,\n            metadata\n        };\n        // In production, this would send to external monitoring service\n        console.log(\"Performance Metric:\", performanceLog);\n    }\n}\nconst monitoringService = MonitoringService.getInstance();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL21vbml0b3JpbmcvbW9uaXRvcmluZy1zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFDc0M7QUFFRztBQXVDbEMsTUFBTUU7SUFLWCxhQUFzQjthQUhkQyxVQUErQixJQUFJQzthQUNuQ0MsWUFBb0JDLEtBQUtDLEdBQUc7SUFFYjtJQUV2QixPQUFPQyxjQUFpQztRQUN0QyxJQUFJLENBQUNOLGtCQUFrQk8sUUFBUSxFQUFFO1lBQy9CUCxrQkFBa0JPLFFBQVEsR0FBRyxJQUFJUDtRQUNuQztRQUNBLE9BQU9BLGtCQUFrQk8sUUFBUTtJQUNuQztJQUVBOztHQUVDLEdBQ0RDLGFBQWFDLElBQVksRUFBRUMsS0FBYSxFQUFRO1FBQzlDLElBQUksQ0FBQ1QsT0FBTyxDQUFDVSxHQUFHLENBQUNGLE1BQU0sQ0FBQyxJQUFJLENBQUNSLE9BQU8sQ0FBQ1csR0FBRyxDQUFDSCxTQUFTLEtBQUtDO0lBQ3pEO0lBRUE7O0dBRUMsR0FDREcsYUFBcUM7UUFDbkMsT0FBT0MsT0FBT0MsV0FBVyxDQUFDLElBQUksQ0FBQ2QsT0FBTztJQUN4QztJQUVBOztHQUVDLEdBQ0QsTUFBTWUscUJBQTJDO1FBQy9DLE1BQU1iLFlBQVlDLEtBQUtDLEdBQUc7UUFDMUIsTUFBTVksU0FBZ0M7WUFDcENDLFVBQVUsTUFBTSxJQUFJLENBQUNDLGFBQWE7WUFDbENDLGdCQUFnQixNQUFNLElBQUksQ0FBQ0MsbUJBQW1CO1lBQzlDQyxtQkFBbUIsTUFBTSxJQUFJLENBQUNDLHFCQUFxQjtRQUNyRDtRQUVBLDJCQUEyQjtRQUMzQixJQUFJQyxTQUFnQztRQUNwQyxNQUFNQyxZQUFZO1lBQ2hCUixPQUFPQyxRQUFRLENBQUNNLE1BQU07WUFDdEJQLE9BQU9HLGNBQWMsQ0FBQ0ksTUFBTTtZQUM1QlAsT0FBT0ssaUJBQWlCLENBQUNFLE1BQU07U0FDaEM7UUFFRCxJQUFJQyxVQUFVQyxRQUFRLENBQUMsY0FBYztZQUNuQ0YsU0FBUztRQUNYLE9BQU8sSUFBSUMs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QzFERixRQUFRSSxHQUFHLENBQUMsQ0FBQyxXQUFXLEVBQUVGLE1BQU1HLFFBQVEsQ0FBQ0MsV0FBVyxHQUFHLEVBQUUsRUFBRUosTUFBTUssSUFBSSxDQUFDLEdBQUcsRUFBRUwsTUFBTTdCLE9BQU8sQ0FBQyxDQUFDO1FBRTFGLCtEQUErRDtRQUMvRCxJQUFJNkIsTUFBTUcsUUFBUSxLQUFLLFVBQVVILE1BQU1HLFFBQVEsS0FBSyxZQUFZO1lBQzlETCxRQUFRUSxJQUFJLENBQUMscURBQXFETDtRQUNwRTtJQUNGO0lBRUE7O0dBRUMsR0FDRE0sZUFBZUMsVUFBa0IsRUFBRUMsUUFBZ0IsRUFBRUMsUUFBOEIsRUFBUTtRQUN6RixJQUFJLENBQUNyRSxZQUFZLENBQUNtRSxZQUFZQztRQUU5QixNQUFNRSxpQkFBaUI7WUFDckJuRCxXQUFXLElBQUl2QixPQUFPd0IsV0FBVztZQUNqQ21ELFFBQVFKO1lBQ1JDO1lBQ0FDO1FBQ0Y7UUFFQSxnRUFBZ0U7UUFDaEVaLFFBQVFJLEdBQUcsQ0FBQyx1QkFBdUJTO0lBQ3JDO0FBQ0Y7QUFFTyxNQUFNRSxvQkFBb0JoRixrQkFBa0JNLFdBQVcsR0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovL3NvY2lhbHBpbG9hdC1haS8uL3NyYy9saWIvbW9uaXRvcmluZy9tb25pdG9yaW5nLXNlcnZpY2UudHM/ZmI4NiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICdAL2xpYi9wcmlzbWEnO1xyXG5pbXBvcnQgeyBnZXRTZXJ2ZXJTZXNzaW9uIH0gZnJvbSAnbmV4dC1hdXRoJztcclxuaW1wb3J0IHsgYXV0aE9wdGlvbnMgfSBmcm9tICdAL2xpYi9hdXRoJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSGVhbHRoQ2hlY2sge1xyXG4gIHN0YXR1czogJ2hlYWx0aHknIHwgJ2RlZ3JhZGVkJyB8ICd1bmhlYWx0aHknO1xyXG4gIHRpbWVzdGFtcDogc3RyaW5nO1xyXG4gIGNoZWNrczoge1xyXG4gICAgZGF0YWJhc2U6IHtcclxuICAgICAgc3RhdHVzOiAnaGVhbHRoeScgfCAndW5oZWFsdGh5JztcclxuICAgICAgcmVzcG9uc2VUaW1lOiBudW1iZXI7XHJcbiAgICAgIGVycm9yPzogc3RyaW5nO1xyXG4gICAgfTtcclxuICAgIGF1dGhlbnRpY2F0aW9uOiB7XHJcbiAgICAgIHN0YXR1czogJ2hlYWx0aHknIHwgJ3VuaGVhbHRoeSc7XHJcbiAgICAgIGVycm9yPzogc3RyaW5nO1xyXG4gICAgfTtcclxuICAgIGV4dGVybmFsX3NlcnZpY2VzOiB7XHJcbiAgICAgIHN0YXR1czogJ2hlYWx0aHknIHwgJ2RlZ3JhZGVkJyB8ICd1bmhlYWx0aHknO1xyXG4gICAgICBzZXJ2aWNlczoge1xyXG4gICAgICAgIGZhY2Vib29rOiB7XHJcbiAgICAgICAgICBzdGF0dXM6ICdoZWFsdGh5JyB8ICd1bmhlYWx0aHknO1xyXG4gICAgICAgICAgcmVzcG9uc2VUaW1lPzogbnVtYmVyO1xyXG4gICAgICAgICAgZXJyb3I/OiBzdHJpbmc7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBpbnN0YWdyYW06IHtcclxuICAgICAgICAgIHN0YXR1czogJ2hlYWx0aHknIHwgJ3VuaGVhbHRoeSc7XHJcbiAgICAgICAgICByZXNwb25zZVRpbWU/OiBudW1iZXI7XHJcbiAgICAgICAgICBlcnJvcj86IHN0cmluZztcclxuICAgICAgICB9O1xyXG4gICAgICB9O1xyXG4gICAgfTtcclxuICB9O1xyXG4gIG1ldHJpY3M6IHtcclxuICAgIHVwdGltZTogbnVtYmVyO1xyXG4gICAgdG90YWxfcmVxdWVzdHM6IG51bWJlcjtcclxuICAgIGVycm9yX3JhdGU6IG51bWJlcjtcclxuICAgIGF2ZXJhZ2VfcmVzcG9uc2VfdGltZTogbnVtYmVyO1xyXG4gIH07XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBNb25pdG9yaW5nU2VydmljZSB7XHJcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IE1vbml0b3JpbmdTZXJ2aWNlO1xyXG4gIHByaXZhdGUgbWV0cmljczogTWFwPHN0cmluZywgbnVtYmVyPiA9IG5ldyBNYXAoKTtcclxuICBwcml2YXRlIHN0YXJ0VGltZTogbnVtYmVyID0gRGF0ZS5ub3coKTtcclxuXHJcbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHt9XHJcblxyXG4gIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBNb25pdG9yaW5nU2VydmljZSB7XHJcbiAgICBpZiAoIU1vbml0b3JpbmdTZXJ2aWNlLmluc3RhbmNlKSB7XHJcbiAgICAgIE1vbml0b3JpbmdTZXJ2aWNlLmluc3RhbmNlID0gbmV3IE1vbml0b3JpbmdTZXJ2aWNlKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gTW9uaXRvcmluZ1NlcnZpY2UuaW5zdGFuY2U7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZWNvcmQgYSBtZXRyaWNcclxuICAgKi9cclxuICByZWNvcmRNZXRyaWMobmFtZTogc3RyaW5nLCB2YWx1ZTogbnVtYmVyKTogdm9pZCB7XHJcbiAgICB0aGlzLm1ldHJpY3Muc2V0KG5hbWUsICh0aGlzLm1ldHJpY3MuZ2V0KG5hbWUpIHx8IDApICsgdmFsdWUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFsbCBtZXRyaWNzXHJcbiAgICovXHJcbiAgZ2V0TWV0cmljcygpOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+IHtcclxuICAgIHJldHVybiBPYmplY3QuZnJvbUVudHJpZXModGhpcy5tZXRyaWNzKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFBlcmZvcm0gY29tcHJlaGVuc2l2ZSBoZWFsdGggY2hlY2tcclxuICAgKi9cclxuICBhc3luYyBwZXJmb3JtSGVhbHRoQ2hlY2soKTogUHJvbWlzZTxIZWFsdGhDaGVjaz4ge1xyXG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgIGNvbnN0IGNoZWNrczogSGVhbHRoQ2hlY2tbJ2NoZWNrcyddID0ge1xyXG4gICAgICBkYXRhYmFzZTogYXdhaXQgdGhpcy5jaGVja0RhdGFiYXNlKCksXHJcbiAgICAgIGF1dGhlbnRpY2F0aW9uOiBhd2FpdCB0aGlzLmNoZWNrQXV0aGVudGljYXRpb24oKSxcclxuICAgICAgZXh0ZXJuYWxfc2VydmljZXM6IGF3YWl0IHRoaXMuY2hlY2tFeHRlcm5hbFNlcnZpY2VzKCksXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIERldGVybWluZSBvdmVyYWxsIHN0YXR1c1xyXG4gICAgbGV0IHN0YXR1czogSGVhbHRoQ2hlY2tbJ3N0YXR1cyddID0gJ2hlYWx0aHknO1xyXG4gICAgY29uc3QgYWxsQ2hlY2tzID0gW1xyXG4gICAgICBjaGVja3MuZGF0YWJhc2Uuc3RhdHVzLFxyXG4gICAgICBjaGVja3MuYXV0aGVudGljYXRpb24uc3RhdHVzLFxyXG4gICAgICBjaGVja3MuZXh0ZXJuYWxfc2VydmljZXMuc3RhdHVzLFxyXG4gICAgXTtcclxuXHJcbiAgICBpZiAoYWxsQ2hlY2tzLmluY2x1ZGVzKCd1bmhlYWx0aHknKSkge1xyXG4gICAgICBzdGF0dXMgPSAndW5oZWFsdGh5JztcclxuICAgIH0gZWxzZSBpZiAoYWxsQ2hlY2tzLmluY2x1ZGVzKCdkZWdyYWRlZCcpKSB7XHJcbiAgICAgIHN0YXR1cyA9ICdkZWdyYWRlZCc7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3RhdHVzLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgY2hlY2tzLFxyXG4gICAgICBtZXRyaWNzOiB7XHJcbiAgICAgICAgdXB0aW1lOiBEYXRlLm5vdygpIC0gdGhpcy5zdGFydFRpbWUsXHJcbiAgICAgICAgdG90YWxfcmVxdWVzdHM6IHRoaXMubWV0cmljcy5nZXQoJ3RvdGFsX3JlcXVlc3RzJykgfHwgMCxcclxuICAgICAgICBlcnJvcl9yYXRlOiB0aGlzLmNhbGN1bGF0ZUVycm9yUmF0ZSgpLFxyXG4gICAgICAgIGF2ZXJhZ2VfcmVzcG9uc2VfdGltZTogdGhpcy5tZXRyaWNzLmdldCgnYXZnX3Jlc3BvbnNlX3RpbWUnKSB8fCAwLFxyXG4gICAgICB9LFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENoZWNrIGRhdGFiYXNlIGNvbm5lY3Rpdml0eVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgY2hlY2tEYXRhYmFzZSgpOiBQcm9taXNlPEhlYWx0aENoZWNrWydjaGVja3MnXVsnZGF0YWJhc2UnXT4ge1xyXG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgIHRyeSB7XHJcbiAgICAgIGF3YWl0IHByaXNtYS4kcXVlcnlSYXdgU0VMRUNUIDFgO1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN0YXR1czogJ2hlYWx0aHknLFxyXG4gICAgICAgIHJlc3BvbnNlVGltZTogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcclxuICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3RhdHVzOiAndW5oZWFsdGh5JyxcclxuICAgICAgICByZXNwb25zZVRpbWU6IERhdGUubm93KCkgLSBzdGFydFRpbWUsXHJcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZGF0YWJhc2UgZXJyb3InLFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2sgYXV0aGVudGljYXRpb24gc3lzdGVtXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBjaGVja0F1dGhlbnRpY2F0aW9uKCk6IFByb21pc2U8SGVhbHRoQ2hlY2tbJ2NoZWNrcyddWydhdXRoZW50aWNhdGlvbiddPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBUZXN0IGF1dGhlbnRpY2F0aW9uIGNvbmZpZ3VyYXRpb25cclxuICAgICAgY29uc3QgYXV0aENvbmZpZyA9IGF3YWl0IGF1dGhPcHRpb25zO1xyXG4gICAgICBpZiAoIWF1dGhDb25maWcucHJvdmlkZXJzIHx8IGF1dGhDb25maWcucHJvdmlkZXJzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gYXV0aGVudGljYXRpb24gcHJvdmlkZXJzIGNvbmZpZ3VyZWQnKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4geyBzdGF0dXM6ICdoZWFsdGh5JyB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdGF0dXM6ICd1bmhlYWx0aHknLFxyXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGF1dGhlbnRpY2F0aW9uIGVycm9yJyxcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENoZWNrIGV4dGVybmFsIHNlcnZpY2VzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBjaGVja0V4dGVybmFsU2VydmljZXMoKTogUHJvbWlzZTxIZWFsdGhDaGVja1snY2hlY2tzJ11bJ2V4dGVybmFsX3NlcnZpY2VzJ10+IHtcclxuICAgIGNvbnN0IHNlcnZpY2VzID0ge1xyXG4gICAgICBmYWNlYm9vazogYXdhaXQgdGhpcy5jaGVja0ZhY2Vib29rQVBJKCksXHJcbiAgICAgIGluc3RhZ3JhbTogYXdhaXQgdGhpcy5jaGVja0luc3RhZ3JhbUFQSSgpLFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBzdGF0dXNlcyA9IE9iamVjdC52YWx1ZXMoc2VydmljZXMpLm1hcChzID0+IHMuc3RhdHVzKTtcclxuICAgIGxldCBvdmVyYWxsU3RhdHVzOiAnaGVhbHRoeScgfCAnZGVncmFkZWQnIHwgJ3VuaGVhbHRoeScgPSAnaGVhbHRoeSc7XHJcbiAgICBcclxuICAgIGlmIChzdGF0dXNlcy5pbmNsdWRlcygndW5oZWFsdGh5JykpIHtcclxuICAgICAgb3ZlcmFsbFN0YXR1cyA9ICd1bmhlYWx0aHknO1xyXG4gICAgfSBlbHNlIGlmIChzdGF0dXNlcy5pbmNsdWRlcygnaGVhbHRoeScpICYmIHN0YXR1c2VzLmluY2x1ZGVzKCd1bmhlYWx0aHknKSkge1xyXG4gICAgICBvdmVyYWxsU3RhdHVzID0gJ2RlZ3JhZGVkJztcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdGF0dXM6IG92ZXJhbGxTdGF0dXMsXHJcbiAgICAgIHNlcnZpY2VzLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENoZWNrIEZhY2Vib29rIEFQSSBjb25uZWN0aXZpdHlcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIGNoZWNrRmFjZWJvb2tBUEkoKTogUHJvbWlzZTxIZWFsdGhDaGVja1snY2hlY2tzJ11bJ2V4dGVybmFsX3NlcnZpY2VzJ11bJ3NlcnZpY2VzJ11bJ2ZhY2Vib29rJ10+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIFNpbXBsZSBGYWNlYm9vayBBUEkgaGVhbHRoIGNoZWNrXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL3YxOC4wL21lJywge1xyXG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICB9LFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3RhdHVzOiByZXNwb25zZS5vayA/ICdoZWFsdGh5JyA6ICd1bmhlYWx0aHknLFxyXG4gICAgICAgIHJlc3BvbnNlVGltZTogcmVzcG9uc2UuaGVhZGVycy5nZXQoJ3gtcmVzcG9uc2UtdGltZScpID8gXHJcbiAgICAgICAgICBwYXJzZUludChyZXNwb25zZS5oZWFkZXJzLmdldCgneC1yZXNwb25zZS10aW1lJykhKSA6IHVuZGVmaW5lZCxcclxuICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3RhdHVzOiAndW5oZWFsdGh5JyxcclxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRmFjZWJvb2sgQVBJIHVuYXZhaWxhYmxlJyxcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENoZWNrIEluc3RhZ3JhbSBBUEkgY29ubmVjdGl2aXR5XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBjaGVja0luc3RhZ3JhbUFQSSgpOiBQcm9taXNlPEhlYWx0aENoZWNrWydjaGVja3MnXVsnZXh0ZXJuYWxfc2VydmljZXMnXVsnc2VydmljZXMnXVsnaW5zdGFncmFtJ10+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIFNpbXBsZSBJbnN0YWdyYW0gQVBJIGhlYWx0aCBjaGVja1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS92MTguMC9pbnN0YWdyYW0tYnVzaW5lc3MtYWNjb3VudCcsIHtcclxuICAgICAgICBtZXRob2Q6ICdHRVQnLFxyXG4gICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN0YXR1czogcmVzcG9uc2Uub2sgPyAnaGVhbHRoeScgOiAndW5oZWFsdGh5JyxcclxuICAgICAgICByZXNwb25zZVRpbWU6IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCd4LXJlc3BvbnNlLXRpbWUnKSA/IFxyXG4gICAgICAgICAgcGFyc2VJbnQocmVzcG9uc2UuaGVhZGVycy5nZXQoJ3gtcmVzcG9uc2UtdGltZScpISkgOiB1bmRlZmluZWQsXHJcbiAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN0YXR1czogJ3VuaGVhbHRoeScsXHJcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0luc3RhZ3JhbSBBUEkgdW5hdmFpbGFibGUnLFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2FsY3VsYXRlIGVycm9yIHJhdGVcclxuICAgKi9cclxuICBwcml2YXRlIGNhbGN1bGF0ZUVycm9yUmF0ZSgpOiBudW1iZXIge1xyXG4gICAgY29uc3QgdG90YWxSZXF1ZXN0cyA9IHRoaXMubWV0cmljcy5nZXQoJ3RvdGFsX3JlcXVlc3RzJykgfHwgMDtcclxuICAgIGNvbnN0IGVycm9yUmVxdWVzdHMgPSB0aGlzLm1ldHJpY3MuZ2V0KCdlcnJvcl9yZXF1ZXN0cycpIHx8IDA7XHJcbiAgICBcclxuICAgIGlmICh0b3RhbFJlcXVlc3RzID09PSAwKSByZXR1cm4gMDtcclxuICAgIHJldHVybiAoZXJyb3JSZXF1ZXN0cyAvIHRvdGFsUmVxdWVzdHMpICogMTAwO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTG9nIGFwcGxpY2F0aW9uIGVycm9yXHJcbiAgICovXHJcbiAgbG9nRXJyb3IoZXJyb3I6IEVycm9yLCBjb250ZXh0PzogUmVjb3JkPHN0cmluZywgYW55Pik6IHZvaWQge1xyXG4gICAgdGhpcy5yZWNvcmRNZXRyaWMoJ2Vycm9yX3JlcXVlc3RzJywgMSk7XHJcbiAgICBcclxuICAgIGNvbnN0IGVycm9yTG9nID0ge1xyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcclxuICAgICAgc3RhY2s6IGVycm9yLnN0YWNrLFxyXG4gICAgICBjb250ZXh0LFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBJbiBwcm9kdWN0aW9uLCB0aGlzIHdvdWxkIHNlbmQgdG8gZXh0ZXJuYWwgbG9nZ2luZyBzZXJ2aWNlXHJcbiAgICBjb25zb2xlLmVycm9yKCdBcHBsaWNhdGlvbiBFcnJvcjonLCBlcnJvckxvZyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBMb2cgc2VjdXJpdHkgZXZlbnRzIGZvciBtb25pdG9yaW5nIGFuZCBhbGVydGluZ1xyXG4gICAqL1xyXG4gIGxvZ1NlY3VyaXR5RXZlbnQoZXZlbnQ6IHtcclxuICAgIHR5cGU6IHN0cmluZztcclxuICAgIHNldmVyaXR5OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ2NyaXRpY2FsJztcclxuICAgIG1lc3NhZ2U6IHN0cmluZztcclxuICAgIHVzZXJJZD86IHN0cmluZztcclxuICAgIGlwPzogc3RyaW5nO1xyXG4gICAgdXNlckFnZW50Pzogc3RyaW5nO1xyXG4gICAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xyXG4gIH0pOiB2b2lkIHtcclxuICAgIHRoaXMucmVjb3JkTWV0cmljKCdzZWN1cml0eV9ldmVudHMnLCAxKTtcclxuICAgIFxyXG4gICAgY29uc3Qgc2VjdXJpdHlMb2cgPSB7XHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAuLi5ldmVudCxcclxuICAgIH07XHJcblxyXG4gICAgLy8gSW4gcHJvZHVjdGlvbiwgdGhpcyB3b3VsZCBzZW5kIHRvIFNJRU0vc2VjdXJpdHkgc2VydmljZVxyXG4gICAgY29uc29sZS5sb2coYFtTRUNVUklUWV0gJHtldmVudC5zZXZlcml0eS50b1VwcGVyQ2FzZSgpfTogJHtldmVudC50eXBlfSAtICR7ZXZlbnQubWVzc2FnZX1gKTtcclxuICAgIFxyXG4gICAgLy8gRm9yIGhpZ2gvY3JpdGljYWwgc2V2ZXJpdHksIHlvdSBtaWdodCB3YW50IHRvIHRyaWdnZXIgYWxlcnRzXHJcbiAgICBpZiAoZXZlbnQuc2V2ZXJpdHkgPT09ICdoaWdoJyB8fCBldmVudC5zZXZlcml0eSA9PT0gJ2NyaXRpY2FsJykge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ0hJR0ggUFJJT1JJVFkgU0VDVVJJVFkgRVZFTlQgLSBDb25zaWRlciBhbGVydGluZzonLCBzZWN1cml0eUxvZyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBMb2cgcGVyZm9ybWFuY2UgbWV0cmljXHJcbiAgICovXHJcbiAgbG9nUGVyZm9ybWFuY2UobWV0cmljTmFtZTogc3RyaW5nLCBkdXJhdGlvbjogbnVtYmVyLCBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT4pOiB2b2lkIHtcclxuICAgIHRoaXMucmVjb3JkTWV0cmljKG1ldHJpY05hbWUsIGR1cmF0aW9uKTtcclxuICAgIFxyXG4gICAgY29uc3QgcGVyZm9ybWFuY2VMb2cgPSB7XHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICBtZXRyaWM6IG1ldHJpY05hbWUsXHJcbiAgICAgIGR1cmF0aW9uLFxyXG4gICAgICBtZXRhZGF0YSxcclxuICAgIH07XHJcblxyXG4gICAgLy8gSW4gcHJvZHVjdGlvbiwgdGhpcyB3b3VsZCBzZW5kIHRvIGV4dGVybmFsIG1vbml0b3Jpbmcgc2VydmljZVxyXG4gICAgY29uc29sZS5sb2coJ1BlcmZvcm1hbmNlIE1ldHJpYzonLCBwZXJmb3JtYW5jZUxvZyk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgbW9uaXRvcmluZ1NlcnZpY2UgPSBNb25pdG9yaW5nU2VydmljZS5nZXRJbnN0YW5jZSgpOyJdLCJuYW1lcyI6WyJwcmlzbWEiLCJhdXRoT3B0aW9ucyIsIk1vbml0b3JpbmdTZXJ2aWNlIiwibWV0cmljcyIsIk1hcCIsInN0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJnZXRJbnN0YW5jZSIsImluc3RhbmNlIiwicmVjb3JkTWV0cmljIiwibmFtZSIsInZhbHVlIiwic2V0IiwiZ2V0IiwiZ2V0TWV0cmljcyIsIk9iamVjdCIsImZyb21FbnRyaWVzIiwicGVyZm9ybUhlYWx0aENoZWNrIiwiY2hlY2tzIiwiZGF0YWJhc2UiLCJjaGVja0RhdGFiYXNlIiwiYXV0aGVudGljYXRpb24iLCJjaGVja0F1dGhlbnRpY2F0aW9uIiwiZXh0ZXJuYWxfc2VydmljZXMiLCJjaGVja0V4dGVybmFsU2VydmljZXMiLCJzdGF0dXMiLCJhbGxDaGVja3MiLCJpbmNsdWRlcyIsInRpbWVzdGFtcCIsInRvSVNPU3RyaW5nIiwidXB0aW1lIiwidG90YWxfcmVxdWVzdHMiLCJlcnJvcl9yYXRlIiwiY2FsY3VsYXRlRXJyb3JSYXRlIiwiYXZlcmFnZV9yZXNwb25zZV90aW1lIiwiJHF1ZXJ5UmF3IiwicmVzcG9uc2VUaW1lIiwiZXJyb3IiLCJFcnJvciIsIm1lc3NhZ2UiLCJhdXRoQ29uZmlnIiwicHJvdmlkZXJzIiwibGVuZ3RoIiwic2VydmljZXMiLCJmYWNlYm9vayIsImNoZWNrRmFjZWJvb2tBUEkiLCJpbnN0YWdyYW0iLCJjaGVja0luc3RhZ3JhbUFQSSIsInN0YXR1c2VzIiwidmFsdWVzIiwibWFwIiwicyIsIm92ZXJhbGxTdGF0dXMiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsIm9rIiwicGFyc2VJbnQiLCJ1bmRlZmluZWQiLCJ0b3RhbFJlcXVlc3RzIiwiZXJyb3JSZXF1ZXN0cyIsImxvZ0Vycm9yIiwiY29udGV4dCIsImVycm9yTG9nIiwic3RhY2siLCJjb25zb2xlIiwibG9nU2VjdXJpdHlFdmVudCIsImV2ZW50Iiwic2VjdXJpdHlMb2ciLCJsb2ciLCJzZXZlcml0eSIsInRvVXBwZXJDYXNlIiwidHlwZSIsIndhcm4iLCJsb2dQZXJmb3JtYW5jZSIsIm1ldHJpY05hbWUiLCJkdXJhdGlvbiIsIm1ldGFkYXRhIiwicGVyZm9ybWFuY2VMb2ciLCJtZXRyaWMiLCJtb25pdG9yaW5nU2VydmljZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/monitoring/monitoring-service.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nif (true) globalForPrisma.prisma = prisma;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (prisma);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTZDO0FBRTdDLE1BQU1DLGtCQUFrQkM7QUFJakIsTUFBTUMsU0FBU0YsZ0JBQWdCRSxNQUFNLElBQUksSUFBSUgsd0RBQVlBLEdBQUU7QUFFbEUsSUFBSUksSUFBeUIsRUFBY0gsZ0JBQWdCRSxNQUFNLEdBQUdBO0FBRXBFLGlFQUFlQSxNQUFNQSxFQUFBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc29jaWFscGlsb2F0LWFpLy4vc3JjL2xpYi9wcmlzbWEudHM/MDFkNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcclxuXHJcbmNvbnN0IGdsb2JhbEZvclByaXNtYSA9IGdsb2JhbFRoaXMgYXMgdW5rbm93biBhcyB7XHJcbiAgcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWRcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHByaXNtYSA9IGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPz8gbmV3IFByaXNtYUNsaWVudCgpXHJcblxyXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA9IHByaXNtYVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgcHJpc21hIl0sIm5hbWVzIjpbIlByaXNtYUNsaWVudCIsImdsb2JhbEZvclByaXNtYSIsImdsb2JhbFRoaXMiLCJwcmlzbWEiLCJwcm9jZXNzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/security/security-service.ts":
/*!**********************************************!*\
  !*** ./src/lib/security/security-service.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SecurityService: () => (/* binding */ SecurityService)\n/* harmony export */ });\n/* harmony import */ var _lib_monitoring_monitoring_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/monitoring/monitoring-service */ \"(rsc)/./src/lib/monitoring/monitoring-service.ts\");\n\nclass SecurityService {\n    constructor(){\n        this.rateLimitStore = new Map();\n        this.RATE_LIMIT_WINDOW = 60 * 1000 // 1 minute\n        ;\n        this.RATE_LIMIT_MAX_REQUESTS = 100;\n    }\n    static getInstance() {\n        if (!SecurityService.instance) {\n            SecurityService.instance = new SecurityService();\n        }\n        return SecurityService.instance;\n    }\n    /**\r\n   * Apply security headers to response\r\n   */ applySecurityHeaders(response) {\n        const headers = {\n            \"X-Content-Type-Options\": \"nosniff\",\n            \"X-Frame-Options\": \"DENY\",\n            \"X-XSS-Protection\": \"1; mode=block\",\n            \"Strict-Transport-Security\": \"max-age=31536000; includeSubDomains; preload\",\n            \"Content-Security-Policy\": this.generateCSP(),\n            \"Referrer-Policy\": \"strict-origin-when-cross-origin\",\n            \"Permissions-Policy\": \"camera=(), microphone=(), geolocation=()\"\n        };\n        Object.entries(headers).forEach(([key, value])=>{\n            response.headers.set(key, value);\n        });\n        return response;\n    }\n    /**\r\n   * Generate Content Security Policy\r\n   */ generateCSP() {\n        return [\n            \"default-src 'self'\",\n            \"script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net https://unpkg.com\",\n            \"style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net\",\n            \"img-src 'self' data: https: http:\",\n            \"font-src 'self' https://fonts.gstatic.com\",\n            \"connect-src 'self' https://api.socialpiloat.com wss://api.socialpiloat.com\",\n            \"frame-ancestors 'none'\",\n            \"base-uri 'self'\",\n            \"form-action 'self'\"\n        ].join(\"; \");\n    }\n    /**\r\n   * Check rate limiting\r\n   */ checkRateLimit(clientId) {\n        const now = Date.now();\n        const key = clientId;\n        const current = this.rateLimitStore.get(key);\n        if (!current || now > current.resetTime) {\n            // Reset or initialize\n            this.rateLimitStore.set(key, {\n                count: 1,\n                resetTime: now + this.RATE_LIMIT_WINDOW\n            });\n            return {\n                allowed: true,\n                remaining: this.RATE_LIMIT_MAX_REQUESTS - 1,\n                resetTime: now + this.RATE_LIMIT_WINDOW\n            };\n        }\n        if (current.count >= this.RATE_LIMIT_MAX_REQUESTS) {\n            return {\n                allowed: false,\n                remaining: 0,\n                resetTime: current.resetTime\n            };\n        }\n        current.count++;\n        return {\n            allowed: true,\n            remaining: this.RATE_LIMIT_MAX_REQUESTS - current.count,\n            resetTime: current.resetTime\n        };\n    }\n    /**\r\n   * Sanitize input to prevent XSS and injection attacks\r\n   */ sanitizeInput(input) {\n        if (typeof input !== \"string\") return \"\";\n        return input.replace(/[<>]/g, \"\") // Remove HTML tags\n        .replace(/javascript:/gi, \"\") // Remove javascript: protocol\n        .replace(/on\\w+\\s*=/gi, \"\") // Remove event handlers\n        .trim();\n    }\n    /**\r\n   * Validate API key\r\n   */ validateApiKey(apiKey) {\n        // Basic API key validation - should be enhanced in production\n        const apiKeyPattern = /^[a-zA-Z0-9]{32,64}$/;\n        return apiKeyPattern.test(apiKey);\n    }\n    /**\r\n   * Check for suspicious patterns\r\n   */ checkSuspiciousPatterns(input) {\n        const suspiciousPatterns = [\n            /(<script|<iframe|<object|<embed)/gi,\n            /(union|select|insert|update|delete|drop|create|alter|exec|script)/gi,\n            /(\\.\\.\\/|\\.\\.\\\\|%2e%2e)/gi,\n            /(javascript:|data:|vbscript:)/gi,\n            /(['\"`\\\\x])/gi\n        ];\n        for (const pattern of suspiciousPatterns){\n            if (pattern.test(input)) {\n                return {\n                    isSuspicious: true,\n                    reason: `Suspicious pattern detected: ${pattern.source}`\n                };\n            }\n        }\n        return {\n            isSuspicious: false\n        };\n    }\n    /**\r\n   * Log security events for monitoring and alerting\r\n   */ logSecurityEvent(event) {\n        // Log to monitoring service\n        _lib_monitoring_monitoring_service__WEBPACK_IMPORTED_MODULE_0__.monitoringService.logSecurityEvent(event);\n        // In production, you might also:\n        // - Send to SIEM system\n        // - Trigger alerts for high severity events\n        // - Store in security event database\n        console.log(`[SECURITY] ${event.severity.toUpperCase()}: ${event.type} - ${event.message}`);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3NlY3VyaXR5L3NlY3VyaXR5LXNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFDd0U7QUFZakUsTUFBTUM7SUFNWEMsYUFBYzthQUpOQyxpQkFBb0UsSUFBSUM7YUFDL0RDLG9CQUFvQixLQUFLLEtBQU0sV0FBVzs7YUFDMUNDLDBCQUEwQjtJQUU1QjtJQUVmLE9BQU9DLGNBQStCO1FBQ3BDLElBQUksQ0FBQ04sZ0JBQWdCTyxRQUFRLEVBQUU7WUFDN0JQLGdCQUFnQk8sUUFBUSxHQUFHLElBQUlQO1FBQ2pDO1FBQ0EsT0FBT0EsZ0JBQWdCTyxRQUFRO0lBQ2pDO0lBRUE7O0dBRUMsR0FDREMscUJBQXFCQyxRQUFzQixFQUFnQjtRQUN6RCxNQUFNQyxVQUEyQjtZQUMvQiwwQkFBMEI7WUFDMUIsbUJBQW1CO1lBQ25CLG9CQUFvQjtZQUNwQiw2QkFBNkI7WUFDN0IsMkJBQTJCLElBQUksQ0FBQ0MsV0FBVztZQUMzQyxtQkFBbUI7WUFDbkIsc0JBQXNCO1FBQ3hCO1FBRUFDLE9BQU9DLE9BQU8sQ0FBQ0gsU0FBU0ksT0FBTyxDQUFDLENBQUMsQ0FBQ0MsS0FBS0MsTUFBTTtZQUMzQ1AsU0FBU0MsT0FBTyxDQUFDTyxHQUFHLENBQUNGLEtBQUtDO1FBQzVCO1FBRUEsT0FBT1A7SUFDVDtJQUVBOztHQUVDLEdBQ0QsY0FBOEI7UUFDNUIsT0FBTztZQUNMO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtTQUNELENBQUNTLElBQUksQ0FBQztJQUNUO0lBRUE7O0dBRUMsR0FDREMsZUFBZUMsUUFBZ0IsRUFBOEQ7UUFDM0YsTUFBTUMsTUFBTUMsS0FBS0QsR0FBRztRQUNwQixNQUFNTixNQUFNSztRQUNaLE1BQU1HLFVBQVUsSUFBSSxDQUFDckIsY0FBYyxDQUFDc0IsR0FBRyxDQUFDVDtRQUV4QyxJQUFJLENBQUNRLFdBQVdGLE1BQU1FLFFBQVFFLFNBQVMsRUFBRTtZQUN2QyxzQkFBc0I7WUFDdEIsSUFBSSxDQUFDdkIsY0FBYyxDQUFDZSxHQUFHLENBQUNGLEtBQUs7Z0JBQzNCVyxPQUFPO2dCQUNQRCxXQUFXSixNQUFNLElBQUksQ0FBQ2pCLGlCQUFpQjtZQUN6QztZQUVBLE9BQU87Z0JBQ0x1QixTQUFTO2dCQUNUQyxXQUFXLElBQUksQ0FBQ3ZCLHVCQUF1QixHQUFHO2dCQUMxQ29CLFdBQVdKLE1BQU0sSUFBSSxDQUFDakIsaUJBQWlCO1lBQ3pDO1FBQ0Y7UUFFQSxJQUFJbUIsUUFBUUcsS0FBSyxJQUFJLElBQUksQ0FBQ3JCLHVCQUF1QixFQUFFO1lBQ2pELE9BQU87Z0JBQ0xzQixTQUFTO2dCQUNUQyxXQUFXO2dCQUNYSCxXQUFXRixRQUFRRSxTQUFTO1lBQzlCO1FBQ0Y7UUFFQUYsUUFBUUcsS0FBSztRQUNiLE9BQU87WUFDTEMsU0FBUztZQUNUQyxXQUFXLElBQUksQ0FBQ3ZCLHVCQUF1QixHQUFHa0IsUUFBUUcsS0FBSztZQUN2REQsV0FBV0YsUUFBUUUsU0FBUztRQUM5QjtJQUNGO0lBRUE7O0dBRUMsR0FDREksY0FBY0MsS0FBYSxFQUFVO1FBQ25DLElBQUksT0FBT0EsVUFBVSxVQUFVLE9BQU87UUFFdEMsT0FBT0EsTUFDSkMsT0FBTyxDQUFDLFNBQVMsSUFBSSxtQkFBbUI7U0FDeENBLE9BQU8sQ0FBQyxpQkFBaUIsSUFBSSw4QkFBOEI7U0FDM0RBLE9BQU8sQ0FBQyxlQUFlLElBQUksd0JBQXdCO1NBQ25EQyxJQUFJO0lBQ1Q7SUFFQTs7R0FFQyxHQUNEQyxlQUFlQyxNQUFjLEVBQVc7UUFDdEMsOERBQThEO1FBQzlELE1BQU1DLGdCQUFnQjtRQUN0QixPQUFPQSxjQUFjQyxJQUFJLENBQUNGO0lBQzVCO0lBRUE7O0dBRUMsR0FDREcsd0JBQXdCUCxLQUFhLEVBQThDO1FBQ2pGLE1BQU1RLHFCQUFxQjtZQUN6QjtZQUNBO1lBQ0E7WUFDQTtZQUNBO1NBQ0Q7UUFFRCxLQUFLLE1BQU1DLFdBQVdELG1CQUFvQjtZQUN4QyxJQUFJQyxRQUFRSCxJQUFJLENBQUNOLFFBQVE7Z0JBQ3ZCLE9BQU87b0JBQ0xVLGNBQWM7b0JBQ2RDLFFBQVEsQ0FBQyw2QkFBNkIsRUFBRUYsUUFBUUcsTUFBTSxDQUFDLENBQUM7Z0JBQzFEO1lBQ0Y7UUFDRjtRQUVBLE9BQU87WUFBRUYsY0FBYztRQUFNO0lBQy9CO0lBRUE7O0dBRUMsR0FDREcsaUJBQWlCQyxLQVFoQixFQUFRO1FBQ1AsNEJBQTRCO1FBQzVCN0MsaUZBQWlCQSxDQUFDNEMsZ0JBQWdCLENBQUNDO1FBRW5DLGlDQUFpQztRQUNqQyx3QkFBd0I7UUFDeEIsNENBQTRDO1FBQzVDLHFDQUFxQztRQUNyQ0MsUUFBUUMsR0FBRyxDQUFDLENBQUMsV0FBVyxFQUFFRixNQUFNRyxRQUFRLENBQUNDLFdBQVcsR0FBRyxFQUFFLEVBQUVKLE1BQU1LLElBQUksQ0FBQyxHQUFHLEVBQUVMLE1BQU1NLE9BQU8sQ0FBQyxDQUFDO0lBQzVGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zb2NpYWxwaWxvYXQtYWkvLi9zcmMvbGliL3NlY3VyaXR5L3NlY3VyaXR5LXNlcnZpY2UudHM/NWVmMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBtb25pdG9yaW5nU2VydmljZSB9IGZyb20gJ0AvbGliL21vbml0b3JpbmcvbW9uaXRvcmluZy1zZXJ2aWNlJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU2VjdXJpdHlIZWFkZXJzIHtcclxuICAnWC1Db250ZW50LVR5cGUtT3B0aW9ucyc6IHN0cmluZztcclxuICAnWC1GcmFtZS1PcHRpb25zJzogc3RyaW5nO1xyXG4gICdYLVhTUy1Qcm90ZWN0aW9uJzogc3RyaW5nO1xyXG4gICdTdHJpY3QtVHJhbnNwb3J0LVNlY3VyaXR5Jzogc3RyaW5nO1xyXG4gICdDb250ZW50LVNlY3VyaXR5LVBvbGljeSc6IHN0cmluZztcclxuICAnUmVmZXJyZXItUG9saWN5Jzogc3RyaW5nO1xyXG4gICdQZXJtaXNzaW9ucy1Qb2xpY3knOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBTZWN1cml0eVNlcnZpY2Uge1xyXG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBTZWN1cml0eVNlcnZpY2U7XHJcbiAgcHJpdmF0ZSByYXRlTGltaXRTdG9yZTogTWFwPHN0cmluZywgeyBjb3VudDogbnVtYmVyOyByZXNldFRpbWU6IG51bWJlciB9PiA9IG5ldyBNYXAoKTtcclxuICBwcml2YXRlIHJlYWRvbmx5IFJBVEVfTElNSVRfV0lORE9XID0gNjAgKiAxMDAwOyAvLyAxIG1pbnV0ZVxyXG4gIHByaXZhdGUgcmVhZG9ubHkgUkFURV9MSU1JVF9NQVhfUkVRVUVTVFMgPSAxMDA7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge31cclxuXHJcbiAgc3RhdGljIGdldEluc3RhbmNlKCk6IFNlY3VyaXR5U2VydmljZSB7XHJcbiAgICBpZiAoIVNlY3VyaXR5U2VydmljZS5pbnN0YW5jZSkge1xyXG4gICAgICBTZWN1cml0eVNlcnZpY2UuaW5zdGFuY2UgPSBuZXcgU2VjdXJpdHlTZXJ2aWNlKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gU2VjdXJpdHlTZXJ2aWNlLmluc3RhbmNlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQXBwbHkgc2VjdXJpdHkgaGVhZGVycyB0byByZXNwb25zZVxyXG4gICAqL1xyXG4gIGFwcGx5U2VjdXJpdHlIZWFkZXJzKHJlc3BvbnNlOiBOZXh0UmVzcG9uc2UpOiBOZXh0UmVzcG9uc2Uge1xyXG4gICAgY29uc3QgaGVhZGVyczogU2VjdXJpdHlIZWFkZXJzID0ge1xyXG4gICAgICAnWC1Db250ZW50LVR5cGUtT3B0aW9ucyc6ICdub3NuaWZmJyxcclxuICAgICAgJ1gtRnJhbWUtT3B0aW9ucyc6ICdERU5ZJyxcclxuICAgICAgJ1gtWFNTLVByb3RlY3Rpb24nOiAnMTsgbW9kZT1ibG9jaycsXHJcbiAgICAgICdTdHJpY3QtVHJhbnNwb3J0LVNlY3VyaXR5JzogJ21heC1hZ2U9MzE1MzYwMDA7IGluY2x1ZGVTdWJEb21haW5zOyBwcmVsb2FkJyxcclxuICAgICAgJ0NvbnRlbnQtU2VjdXJpdHktUG9saWN5JzogdGhpcy5nZW5lcmF0ZUNTUCgpLFxyXG4gICAgICAnUmVmZXJyZXItUG9saWN5JzogJ3N0cmljdC1vcmlnaW4td2hlbi1jcm9zcy1vcmlnaW4nLFxyXG4gICAgICAnUGVybWlzc2lvbnMtUG9saWN5JzogJ2NhbWVyYT0oKSwgbWljcm9waG9uZT0oKSwgZ2VvbG9jYXRpb249KCknLFxyXG4gICAgfTtcclxuXHJcbiAgICBPYmplY3QuZW50cmllcyhoZWFkZXJzKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcclxuICAgICAgcmVzcG9uc2UuaGVhZGVycy5zZXQoa2V5LCB2YWx1ZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZW5lcmF0ZSBDb250ZW50IFNlY3VyaXR5IFBvbGljeVxyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2VuZXJhdGVDU1AoKTogc3RyaW5nIHtcclxuICAgIHJldHVybiBbXHJcbiAgICAgIFwiZGVmYXVsdC1zcmMgJ3NlbGYnXCIsXHJcbiAgICAgIFwic2NyaXB0LXNyYyAnc2VsZicgJ3Vuc2FmZS1pbmxpbmUnICd1bnNhZmUtZXZhbCcgaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0IGh0dHBzOi8vdW5wa2cuY29tXCIsXHJcbiAgICAgIFwic3R5bGUtc3JjICdzZWxmJyAndW5zYWZlLWlubGluZScgaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbSBodHRwczovL2Nkbi5qc2RlbGl2ci5uZXRcIixcclxuICAgICAgXCJpbWctc3JjICdzZWxmJyBkYXRhOiBodHRwczogaHR0cDpcIixcclxuICAgICAgXCJmb250LXNyYyAnc2VsZicgaHR0cHM6Ly9mb250cy5nc3RhdGljLmNvbVwiLFxyXG4gICAgICBcImNvbm5lY3Qtc3JjICdzZWxmJyBodHRwczovL2FwaS5zb2NpYWxwaWxvYXQuY29tIHdzczovL2FwaS5zb2NpYWxwaWxvYXQuY29tXCIsXHJcbiAgICAgIFwiZnJhbWUtYW5jZXN0b3JzICdub25lJ1wiLFxyXG4gICAgICBcImJhc2UtdXJpICdzZWxmJ1wiLFxyXG4gICAgICBcImZvcm0tYWN0aW9uICdzZWxmJ1wiLFxyXG4gICAgXS5qb2luKCc7ICcpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2sgcmF0ZSBsaW1pdGluZ1xyXG4gICAqL1xyXG4gIGNoZWNrUmF0ZUxpbWl0KGNsaWVudElkOiBzdHJpbmcpOiB7IGFsbG93ZWQ6IGJvb2xlYW47IHJlbWFpbmluZzogbnVtYmVyOyByZXNldFRpbWU6IG51bWJlciB9IHtcclxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICBjb25zdCBrZXkgPSBjbGllbnRJZDtcclxuICAgIGNvbnN0IGN1cnJlbnQgPSB0aGlzLnJhdGVMaW1pdFN0b3JlLmdldChrZXkpO1xyXG5cclxuICAgIGlmICghY3VycmVudCB8fCBub3cgPiBjdXJyZW50LnJlc2V0VGltZSkge1xyXG4gICAgICAvLyBSZXNldCBvciBpbml0aWFsaXplXHJcbiAgICAgIHRoaXMucmF0ZUxpbWl0U3RvcmUuc2V0KGtleSwge1xyXG4gICAgICAgIGNvdW50OiAxLFxyXG4gICAgICAgIHJlc2V0VGltZTogbm93ICsgdGhpcy5SQVRFX0xJTUlUX1dJTkRPVyxcclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGFsbG93ZWQ6IHRydWUsXHJcbiAgICAgICAgcmVtYWluaW5nOiB0aGlzLlJBVEVfTElNSVRfTUFYX1JFUVVFU1RTIC0gMSxcclxuICAgICAgICByZXNldFRpbWU6IG5vdyArIHRoaXMuUkFURV9MSU1JVF9XSU5ET1csXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGN1cnJlbnQuY291bnQgPj0gdGhpcy5SQVRFX0xJTUlUX01BWF9SRVFVRVNUUykge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGFsbG93ZWQ6IGZhbHNlLFxyXG4gICAgICAgIHJlbWFpbmluZzogMCxcclxuICAgICAgICByZXNldFRpbWU6IGN1cnJlbnQucmVzZXRUaW1lLFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIGN1cnJlbnQuY291bnQrKztcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGFsbG93ZWQ6IHRydWUsXHJcbiAgICAgIHJlbWFpbmluZzogdGhpcy5SQVRFX0xJTUlUX01BWF9SRVFVRVNUUyAtIGN1cnJlbnQuY291bnQsXHJcbiAgICAgIHJlc2V0VGltZTogY3VycmVudC5yZXNldFRpbWUsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2FuaXRpemUgaW5wdXQgdG8gcHJldmVudCBYU1MgYW5kIGluamVjdGlvbiBhdHRhY2tzXHJcbiAgICovXHJcbiAgc2FuaXRpemVJbnB1dChpbnB1dDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIGlmICh0eXBlb2YgaW5wdXQgIT09ICdzdHJpbmcnKSByZXR1cm4gJyc7XHJcbiAgICBcclxuICAgIHJldHVybiBpbnB1dFxyXG4gICAgICAucmVwbGFjZSgvWzw+XS9nLCAnJykgLy8gUmVtb3ZlIEhUTUwgdGFnc1xyXG4gICAgICAucmVwbGFjZSgvamF2YXNjcmlwdDovZ2ksICcnKSAvLyBSZW1vdmUgamF2YXNjcmlwdDogcHJvdG9jb2xcclxuICAgICAgLnJlcGxhY2UoL29uXFx3K1xccyo9L2dpLCAnJykgLy8gUmVtb3ZlIGV2ZW50IGhhbmRsZXJzXHJcbiAgICAgIC50cmltKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBWYWxpZGF0ZSBBUEkga2V5XHJcbiAgICovXHJcbiAgdmFsaWRhdGVBcGlLZXkoYXBpS2V5OiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIC8vIEJhc2ljIEFQSSBrZXkgdmFsaWRhdGlvbiAtIHNob3VsZCBiZSBlbmhhbmNlZCBpbiBwcm9kdWN0aW9uXHJcbiAgICBjb25zdCBhcGlLZXlQYXR0ZXJuID0gL15bYS16QS1aMC05XXszMiw2NH0kLztcclxuICAgIHJldHVybiBhcGlLZXlQYXR0ZXJuLnRlc3QoYXBpS2V5KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENoZWNrIGZvciBzdXNwaWNpb3VzIHBhdHRlcm5zXHJcbiAgICovXHJcbiAgY2hlY2tTdXNwaWNpb3VzUGF0dGVybnMoaW5wdXQ6IHN0cmluZyk6IHsgaXNTdXNwaWNpb3VzOiBib29sZWFuOyByZWFzb24/OiBzdHJpbmcgfSB7XHJcbiAgICBjb25zdCBzdXNwaWNpb3VzUGF0dGVybnMgPSBbXHJcbiAgICAgIC8oPHNjcmlwdHw8aWZyYW1lfDxvYmplY3R8PGVtYmVkKS9naSwgLy8gSFRNTCBpbmplY3Rpb25cclxuICAgICAgLyh1bmlvbnxzZWxlY3R8aW5zZXJ0fHVwZGF0ZXxkZWxldGV8ZHJvcHxjcmVhdGV8YWx0ZXJ8ZXhlY3xzY3JpcHQpL2dpLCAvLyBTUUwgaW5qZWN0aW9uXHJcbiAgICAgIC8oXFwuXFwuXFwvfFxcLlxcLlxcXFx8JTJlJTJlKS9naSwgLy8gUGF0aCB0cmF2ZXJzYWxcclxuICAgICAgLyhqYXZhc2NyaXB0OnxkYXRhOnx2YnNjcmlwdDopL2dpLCAvLyBQcm90b2NvbCBpbmplY3Rpb25cclxuICAgICAgLyhbJ1wiYFxcXFx4XSkvZ2ksIC8vIFNRTCBpbmplY3Rpb24gcGF0dGVybnNcclxuICAgIF07XHJcblxyXG4gICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHN1c3BpY2lvdXNQYXR0ZXJucykge1xyXG4gICAgICBpZiAocGF0dGVybi50ZXN0KGlucHV0KSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBpc1N1c3BpY2lvdXM6IHRydWUsXHJcbiAgICAgICAgICByZWFzb246IGBTdXNwaWNpb3VzIHBhdHRlcm4gZGV0ZWN0ZWQ6ICR7cGF0dGVybi5zb3VyY2V9YFxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBpc1N1c3BpY2lvdXM6IGZhbHNlIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBMb2cgc2VjdXJpdHkgZXZlbnRzIGZvciBtb25pdG9yaW5nIGFuZCBhbGVydGluZ1xyXG4gICAqL1xyXG4gIGxvZ1NlY3VyaXR5RXZlbnQoZXZlbnQ6IHtcclxuICAgIHR5cGU6IHN0cmluZztcclxuICAgIHNldmVyaXR5OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ2NyaXRpY2FsJztcclxuICAgIG1lc3NhZ2U6IHN0cmluZztcclxuICAgIHVzZXJJZD86IHN0cmluZztcclxuICAgIGlwPzogc3RyaW5nO1xyXG4gICAgdXNlckFnZW50Pzogc3RyaW5nO1xyXG4gICAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xyXG4gIH0pOiB2b2lkIHtcclxuICAgIC8vIExvZyB0byBtb25pdG9yaW5nIHNlcnZpY2VcclxuICAgIG1vbml0b3JpbmdTZXJ2aWNlLmxvZ1NlY3VyaXR5RXZlbnQoZXZlbnQpO1xyXG4gICAgXHJcbiAgICAvLyBJbiBwcm9kdWN0aW9uLCB5b3UgbWlnaHQgYWxzbzpcclxuICAgIC8vIC0gU2VuZCB0byBTSUVNIHN5c3RlbVxyXG4gICAgLy8gLSBUcmlnZ2VyIGFsZXJ0cyBmb3IgaGlnaCBzZXZlcml0eSBldmVudHNcclxuICAgIC8vIC0gU3RvcmUgaW4gc2VjdXJpdHkgZXZlbnQgZGF0YWJhc2VcclxuICAgIGNvbnNvbGUubG9nKGBbU0VDVVJJVFldICR7ZXZlbnQuc2V2ZXJpdHkudG9VcHBlckNhc2UoKX06ICR7ZXZlbnQudHlwZX0gLSAke2V2ZW50Lm1lc3NhZ2V9YCk7XHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbIm1vbml0b3JpbmdTZXJ2aWNlIiwiU2VjdXJpdHlTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJyYXRlTGltaXRTdG9yZSIsIk1hcCIsIlJBVEVfTElNSVRfV0lORE9XIiwiUkFURV9MSU1JVF9NQVhfUkVRVUVTVFMiLCJnZXRJbnN0YW5jZSIsImluc3RhbmNlIiwiYXBwbHlTZWN1cml0eUhlYWRlcnMiLCJyZXNwb25zZSIsImhlYWRlcnMiLCJnZW5lcmF0ZUNTUCIsIk9iamVjdCIsImVudHJpZXMiLCJmb3JFYWNoIiwia2V5IiwidmFsdWUiLCJzZXQiLCJqb2luIiwiY2hlY2tSYXRlTGltaXQiLCJjbGllbnRJZCIsIm5vdyIsIkRhdGUiLCJjdXJyZW50IiwiZ2V0IiwicmVzZXRUaW1lIiwiY291bnQiLCJhbGxvd2VkIiwicmVtYWluaW5nIiwic2FuaXRpemVJbnB1dCIsImlucHV0IiwicmVwbGFjZSIsInRyaW0iLCJ2YWxpZGF0ZUFwaUtleSIsImFwaUtleSIsImFwaUtleVBhdHRlcm4iLCJ0ZXN0IiwiY2hlY2tTdXNwaWNpb3VzUGF0dGVybnMiLCJzdXNwaWNpb3VzUGF0dGVybnMiLCJwYXR0ZXJuIiwiaXNTdXNwaWNpb3VzIiwicmVhc29uIiwic291cmNlIiwibG9nU2VjdXJpdHlFdmVudCIsImV2ZW50IiwiY29uc29sZSIsImxvZyIsInNldmVyaXR5IiwidG9VcHBlckNhc2UiLCJ0eXBlIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/security/security-service.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/facebook-service.ts":
/*!**********************************************!*\
  !*** ./src/lib/services/facebook-service.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FacebookService: () => (/* binding */ FacebookService)\n/* harmony export */ });\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./src/lib/db.ts\");\n/* harmony import */ var _lib_logging_logger_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/logging/logger-service */ \"(rsc)/./src/lib/logging/logger-service.ts\");\n// import { facebook } from '@facebook-node/core'; // This package doesn't exist, using fetch instead\n\n\nclass FacebookService {\n    async getAccountAnalytics(accountId, accessToken, startDate, endDate) {\n        try {\n            // Fetch page insights\n            const insights = await this.getPageInsights(accountId, accessToken, startDate, endDate);\n            // Fetch posts with engagement data\n            const posts = await this.getPostsWithEngagement(accountId, accessToken, startDate, endDate);\n            // Fetch follower count\n            const followers = await this.getFollowerCount(accountId, accessToken);\n            // Calculate metrics\n            const totalEngagement = posts.reduce((sum, post)=>{\n                const likes = post.likes?.summary?.total_count || 0;\n                const comments = post.comments?.summary?.total_count || 0;\n                const shares = post.shares?.count || 0;\n                return sum + likes + comments + shares;\n            }, 0);\n            const totalReach = insights.page_impressions?.[0]?.value || 0;\n            // Generate follower history (simplified - in production, store historical data)\n            const followerHistory = this.generateFollowerHistory(followers, startDate, endDate);\n            // Get top performing posts\n            const topPosts = posts.map((post)=>({\n                    id: post.id,\n                    content: post.message || \"\",\n                    engagement: (post.likes?.summary?.total_count || 0) + (post.comments?.summary?.total_count || 0) + (post.shares?.count || 0),\n                    likes: post.likes?.summary?.total_count || 0,\n                    comments: post.comments?.summary?.total_count || 0,\n                    shares: post.shares?.count || 0,\n                    created_time: post.created_time\n                })).sort((a, b)=>b.engagement - a.engagement).slice(0, 5);\n            return {\n                followers,\n                totalEngagement,\n                totalReach,\n                followerHistory,\n                posts: posts.map((post)=>({\n                        id: post.id,\n                        content: post.message || \"\",\n                        likes: post.likes?.summary?.total_count || 0,\n                        comments: post.comments?.summary?.total_count || 0,\n                        shares: post.shares?.count || 0,\n                        created_time: post.created_time\n                    })),\n                topPosts\n            };\n        } catch (error) {\n            console.error(\"Error fetching Facebook analytics:\", error);\n            throw error;\n        }\n    }\n    async getPageInsights(pageId, accessToken, startDate, endDate) {\n        const since = Math.floor(startDate.getTime() / 1000);\n        const until = Math.floor(endDate.getTime() / 1000);\n        const metrics = [\n            \"page_impressions\",\n            \"page_impressions_unique\",\n            \"page_engaged_users\",\n            \"page_fan_adds\",\n            \"page_fan_removes\"\n        ].join(\",\");\n        const url = `${this.baseURL}/${pageId}/insights?metric=${metrics}&since=${since}&until=${until}&access_token=${accessToken}`;\n        try {\n            const response = await fetch(url);\n            const data = await response.json();\n            if (data.error) {\n                throw new Error(`Facebook API error: ${data.error.message}`);\n            }\n            // Transform insights data into a more usable format\n            const insights = {};\n            if (data.data) {\n                data.data.forEach((insight)=>{\n                    insights[insight.name] = insight.values.map((value)=>({\n                            value: value.value,\n                            end_time: value.end_time\n                        }));\n                });\n            }\n            return insights;\n        } catch (error) {\n            console.error(\"Error fetching page insights:\", error);\n            return {};\n        }\n    }\n    async getPostsWithEngagement(pageId, accessToken, startDate, endDate) {\n        const since = startDate.toISOString();\n        const fields = \"id,message,created_time,likes.summary(true),comments.summary(true),shares\";\n        const url = `${this.baseURL}/${pageId}/posts?fields=${fields}&since=${since}&access_token=${accessToken}`;\n        try {\n            const response = await fetch(url);\n            const data = await response.json();\n            if (data.error) {\n                throw new Error(`Facebook API error: ${data.error.message}`);\n            }\n            return data.data || [];\n        } catch (error) {\n            console.error(\"Error fetching posts:\", error);\n            return [];\n        }\n    }\n    async getFollowerCount(pageId, accessToken) {\n        const url = `${this.baseURL}/${pageId}?fields=fan_count&access_token=${accessToken}`;\n        try {\n            const response = await fetch(url);\n            const data = await response.json();\n            if (data.error) {\n                throw new Error(`Facebook API error: ${data.error.message}`);\n            }\n            return data.fan_count || 0;\n        } catch (error) {\n            console.error(\"Error fetching follower count:\", error);\n            return 0;\n        }\n    }\n    generateFollowerHistory(currentFollowers, startDate, endDate) {\n        const days = Math.ceil((endDate.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24));\n        const history = [];\n        // Generate a realistic growth pattern (in production, store actual historical data)\n        let currentCount = Math.max(0, currentFollowers - Math.floor(days * 2)); // Assume ~2 new followers per day\n        for(let i = 0; i <= days; i++){\n            const date = new Date(startDate.getTime() + i * 24 * 60 * 60 * 1000);\n            // Add some randomness to make it look realistic\n            const dailyGrowth = Math.random() > 0.3 ? Math.floor(Math.random() * 5) + 1 : 0;\n            currentCount += dailyGrowth;\n            history.push({\n                date: date.toISOString().split(\"T\")[0],\n                followers: currentCount\n            });\n        }\n        return history;\n    }\n    async getInstagramAnalytics(instagramAccountId, accessToken, startDate, endDate) {\n        try {\n            // Instagram Business Account analytics\n            const insights = await this.getInstagramInsights(instagramAccountId, accessToken, startDate, endDate);\n            // Get media (posts) with engagement\n            const media = await this.getInstagramMedia(instagramAccountId, accessToken, startDate, endDate);\n            // Get follower count\n            const followers = await this.getInstagramFollowerCount(instagramAccountId, accessToken);\n            // Calculate metrics\n            const totalEngagement = media.reduce((sum, item)=>{\n                const likes = item.like_count || 0;\n                const comments = item.comments_count || 0;\n                return sum + likes + comments;\n            }, 0);\n            const totalReach = insights.impressions?.[0]?.value || 0;\n            // Generate follower history\n            const followerHistory = this.generateFollowerHistory(followers, startDate, endDate);\n            // Get top performing media\n            const topPosts = media.map((item)=>({\n                    id: item.id,\n                    content: item.caption?.substring(0, 100) || \"\",\n                    engagement: (item.like_count || 0) + (item.comments_count || 0),\n                    likes: item.like_count || 0,\n                    comments: item.comments_count || 0,\n                    shares: 0,\n                    created_time: item.timestamp\n                })).sort((a, b)=>b.engagement - a.engagement).slice(0, 5);\n            return {\n                followers,\n                totalEngagement,\n                totalReach,\n                followerHistory,\n                posts: media.map((item)=>({\n                        id: item.id,\n                        content: item.caption?.substring(0, 100) || \"\",\n                        likes: item.like_count || 0,\n                        comments: item.comments_count || 0,\n                        shares: 0,\n                        created_time: item.timestamp\n                    })),\n                topPosts\n            };\n        } catch (error) {\n            console.error(\"Error fetching Instagram analytics:\", error);\n            throw error;\n        }\n    }\n    async getInstagramInsights(instagramAccountId, accessToken, startDate, endDate) {\n        const since = Math.floor(startDate.getTime() / 1000);\n        const until = Math.floor(endDate.getTime() / 1000);\n        const metrics = [\n            \"impressions\",\n            \"reach\",\n            \"profile_views\",\n            \"website_clicks\"\n        ].join(\",\");\n        const url = `${this.baseURL}/${instagramAccountId}/insights?metric=${metrics}&since=${since}&until=${until}&period=day&access_token=${accessToken}`;\n        try {\n            const response = await fetch(url);\n            const data = await response.json();\n            if (data.error) {\n                throw new Error(`Instagram API error: ${data.error.message}`);\n            }\n            const insights = {};\n            if (data.data) {\n                data.data.forEach((insight)=>{\n                    insights[insight.name] = insight.values.map((value)=>({\n                            value: value.value,\n                            end_time: value.end_time\n                        }));\n                });\n            }\n            return insights;\n        } catch (error) {\n            console.error(\"Error fetching Instagram insights:\", error);\n            return {};\n        }\n    }\n    async getInstagramMedia(instagramAccountId, accessToken, startDate, endDate) {\n        const since = startDate.toISOString();\n        const fields = \"id,caption,like_count,comments_count,timestamp,media_type,media_url\";\n        const url = `${this.baseURL}/${instagramAccountId}/media?fields=${fields}&since=${since}&access_token=${accessToken}`;\n        try {\n            const response = await fetch(url);\n            const data = await response.json();\n            if (data.error) {\n                throw new Error(`Instagram API error: ${data.error.message}`);\n            }\n            return data.data || [];\n        } catch (error) {\n            console.error(\"Error fetching Instagram media:\", error);\n            return [];\n        }\n    }\n    async getInstagramFollowerCount(instagramAccountId, accessToken) {\n        const url = `${this.baseURL}/${instagramAccountId}?fields=followers_count&access_token=${accessToken}`;\n        try {\n            const response = await fetch(url);\n            const data = await response.json();\n            if (data.error) {\n                throw new Error(`Instagram API error: ${data.error.message}`);\n            }\n            return data.followers_count || 0;\n        } catch (error) {\n            console.error(\"Error fetching Instagram follower count:\", error);\n            return 0;\n        }\n    }\n    // Utility method to check if token is valid\n    async validateToken(accessToken) {\n        const url = `${this.baseURL}/me?access_token=${accessToken}`;\n        try {\n            const response = await fetch(url);\n            const data = await response.json();\n            return !data.error;\n        } catch (error) {\n            return false;\n        }\n    }\n    // Method to refresh token (if you have refresh token capability)\n    async refreshToken(refreshToken) {\n        // This would require your app to have offline_access permission\n        // and implement token refresh logic\n        // For now, return null to indicate refresh is not available\n        return null;\n    }\n    // Send a message to a user\n    async sendMessage(accountId, recipientId, message, platform) {\n        try {\n            // Get the social account to retrieve access token\n            const socialAccount = await _lib_db__WEBPACK_IMPORTED_MODULE_0__.db.socialAccount.findUnique({\n                where: {\n                    id: accountId\n                },\n                select: {\n                    accessToken: true\n                }\n            });\n            if (!socialAccount?.accessToken) {\n                throw new Error(\"Access token not found for account\");\n            }\n            const accessToken = socialAccount.accessToken;\n            // For Facebook, we use the Send API\n            if (platform === \"FACEBOOK\") {\n                const url = `${this.baseURL}/me/messages?access_token=${accessToken}`;\n                const response = await fetch(url, {\n                    method: \"POST\",\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    },\n                    body: JSON.stringify({\n                        recipient: {\n                            id: recipientId\n                        },\n                        message: {\n                            text: message\n                        }\n                    })\n                });\n                const data = await response.json();\n                if (data.error) {\n                    throw new Error(`Facebook API error: ${data.error.message}`);\n                }\n                return true;\n            }\n            // For Instagram, we need to use Instagram Basic Display API or Instagram Graph API\n            // Note: Instagram messaging requires special permissions and setup\n            if (platform === \"INSTAGRAM\") {\n                // Instagram messaging is more complex and requires specific setup\n                // For now, we'll log that it's not implemented\n                _lib_logging_logger_service__WEBPACK_IMPORTED_MODULE_1__.logger.warn(\"Instagram messaging not yet implemented\", {\n                    accountId,\n                    recipientId\n                });\n                return false;\n            }\n            return false;\n        } catch (error) {\n            _lib_logging_logger_service__WEBPACK_IMPORTED_MODULE_1__.logger.error(\"Error sending message\", {\n                error: error instanceof Error ? error.message : \"Unknown error\",\n                accountId,\n                recipientId,\n                platform\n            });\n            return false;\n        }\n    }\n    constructor(){\n        this.baseURL = \"https://graph.facebook.com/v18.0\";\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3NlcnZpY2VzL2ZhY2Vib29rLXNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEscUdBQXFHO0FBQ3ZFO0FBQ3dCO0FBMEIvQyxNQUFNRTtJQUdYLE1BQU1DLG9CQUNKQyxTQUFpQixFQUNqQkMsV0FBbUIsRUFDbkJDLFNBQWUsRUFDZkMsT0FBYSxFQUNlO1FBQzVCLElBQUk7WUFDRixzQkFBc0I7WUFDdEIsTUFBTUMsV0FBVyxNQUFNLElBQUksQ0FBQ0MsZUFBZSxDQUFDTCxXQUFXQyxhQUFhQyxXQUFXQztZQUUvRSxtQ0FBbUM7WUFDbkMsTUFBTUcsUUFBUSxNQUFNLElBQUksQ0FBQ0Msc0JBQXNCLENBQUNQLFdBQVdDLGFBQWFDLFdBQVdDO1lBRW5GLHVCQUF1QjtZQUN2QixNQUFNSyxZQUFZLE1BQU0sSUFBSSxDQUFDQyxnQkFBZ0IsQ0FBQ1QsV0FBV0M7WUFFekQsb0JBQW9CO1lBQ3BCLE1BQU1TLGtCQUFrQkosTUFBTUssTUFBTSxDQUFDLENBQUNDLEtBQUtDO2dCQUN6QyxNQUFNQyxRQUFRRCxLQUFLQyxLQUFLLEVBQUVDLFNBQVNDLGVBQWU7Z0JBQ2xELE1BQU1DLFdBQVdKLEtBQUtJLFFBQVEsRUFBRUYsU0FBU0MsZUFBZTtnQkFDeEQsTUFBTUUsU0FBU0wsS0FBS0ssTUFBTSxFQUFFQyxTQUFTO2dCQUNyQyxPQUFPUCxNQUFNRSxRQUFRRyxXQUFXQztZQUNsQyxHQUFHO1lBRUgsTUFBTUUsYUFBYWhCLFNBQVNpQixnQkFBZ0IsRUFBRSxDQUFDLEVBQUUsRUFBRUMsU0FBUztZQUU1RCxnRkFBZ0Y7WUFDaEYsTUFBTUMsa0JBQWtCLElBQUksQ0FBQ0MsdUJBQXVCLENBQUNoQixXQUFXTixXQUFXQztZQUUzRSwyQkFBMkI7WUFDM0IsTUFBTXNCLFdBQVduQixNQUNkb0IsR0FBRyxDQUFDYixDQUFBQSxPQUFTO29CQUNaYyxJQUFJZCxLQUFLYyxFQUFFO29CQUNYQyxTQUFTZixLQUFLZ0IsT0FBTyxJQUFJO29CQUN6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QUM7Z0JBRXJFLE1BQU0rQyxXQUFXLE1BQU1DLE1BQU1ILEtBQUs7b0JBQ2hDbUQsUUFBUTtvQkFDUkMsU0FBUzt3QkFDUCxnQkFBZ0I7b0JBQ2xCO29CQUNBQyxNQUFNQyxLQUFLQyxTQUFTLENBQUM7d0JBQ25CQyxXQUFXOzRCQUNUM0UsSUFBSWdFO3dCQUNOO3dCQUNBOUQsU0FBUzs0QkFDUDBFLE1BQU0xRTt3QkFDUjtvQkFDRjtnQkFDRjtnQkFFQSxNQUFNcUIsT0FBTyxNQUFNRixTQUFTRyxJQUFJO2dCQUVoQyxJQUFJRCxLQUFLZCxLQUFLLEVBQUU7b0JBQ2QsTUFBTSxJQUFJZ0IsTUFBTSxDQUFDLG9CQUFvQixFQUFFRixLQUFLZCxLQUFLLENBQUNQLE9BQU8sQ0FBQyxDQUFDO2dCQUM3RDtnQkFFQSxPQUFPO1lBQ1Q7WUFFQSxtRkFBbUY7WUFDbkYsbUVBQW1FO1lBQ25FLElBQUkrRCxhQUFhLGFBQWE7Z0JBQzVCLGtFQUFrRTtnQkFDbEUsK0NBQStDO2dCQUMvQy9GLCtEQUFNQSxDQUFDMkcsSUFBSSxDQUFDLDJDQUEyQztvQkFBRXhHO29CQUFXMkY7Z0JBQVk7Z0JBQ2hGLE9BQU87WUFDVDtZQUVBLE9BQU87UUFDVCxFQUFFLE9BQU92RCxPQUFPO1lBQ2R2QywrREFBTUEsQ0FBQ3VDLEtBQUssQ0FBQyx5QkFBeUI7Z0JBQ3BDQSxPQUFPQSxpQkFBaUJnQixRQUFRaEIsTUFBTVAsT0FBTyxHQUFHO2dCQUNoRDdCO2dCQUNBMkY7Z0JBQ0FDO1lBQ0Y7WUFDQSxPQUFPO1FBQ1Q7SUFDRjs7YUFuYVE3QyxVQUFVOztBQW9hcEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zb2NpYWxwaWxvYXQtYWkvLi9zcmMvbGliL3NlcnZpY2VzL2ZhY2Vib29rLXNlcnZpY2UudHM/MmEwNCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgeyBmYWNlYm9vayB9IGZyb20gJ0BmYWNlYm9vay1ub2RlL2NvcmUnOyAvLyBUaGlzIHBhY2thZ2UgZG9lc24ndCBleGlzdCwgdXNpbmcgZmV0Y2ggaW5zdGVhZFxuaW1wb3J0IHsgZGIgfSBmcm9tICdAL2xpYi9kYic7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICdAL2xpYi9sb2dnaW5nL2xvZ2dlci1zZXJ2aWNlJztcblxuaW50ZXJmYWNlIEZhY2Vib29rQW5hbHl0aWNzIHtcbiAgZm9sbG93ZXJzOiBudW1iZXI7XG4gIHRvdGFsRW5nYWdlbWVudDogbnVtYmVyO1xuICB0b3RhbFJlYWNoOiBudW1iZXI7XG4gIGZvbGxvd2VySGlzdG9yeTogYW55W107XG4gIHBvc3RzOiBhbnlbXTtcbiAgdG9wUG9zdHM6IGFueVtdO1xufVxuXG5pbnRlcmZhY2UgRmFjZWJvb2tQb3N0IHtcbiAgaWQ6IHN0cmluZztcbiAgbWVzc2FnZT86IHN0cmluZztcbiAgY3JlYXRlZF90aW1lOiBzdHJpbmc7XG4gIGxpa2VzPzogeyBzdW1tYXJ5PzogeyB0b3RhbF9jb3VudD86IG51bWJlciB9IH07XG4gIGNvbW1lbnRzPzogeyBzdW1tYXJ5PzogeyB0b3RhbF9jb3VudD86IG51bWJlciB9IH07XG4gIHNoYXJlcz86IHsgY291bnQ/OiBudW1iZXIgfTtcbiAgaW5zaWdodHM/OiB7XG4gICAgZGF0YT86IEFycmF5PHtcbiAgICAgIG5hbWU6IHN0cmluZztcbiAgICAgIHZhbHVlczogQXJyYXk8eyB2YWx1ZTogbnVtYmVyIH0+O1xuICAgIH0+O1xuICB9O1xufVxuXG5leHBvcnQgY2xhc3MgRmFjZWJvb2tTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBiYXNlVVJMID0gJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL3YxOC4wJztcblxuICBhc3luYyBnZXRBY2NvdW50QW5hbHl0aWNzKFxuICAgIGFjY291bnRJZDogc3RyaW5nLCBcbiAgICBhY2Nlc3NUb2tlbjogc3RyaW5nLCBcbiAgICBzdGFydERhdGU6IERhdGUsIFxuICAgIGVuZERhdGU6IERhdGVcbiAgKTogUHJvbWlzZTxGYWNlYm9va0FuYWx5dGljcz4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBGZXRjaCBwYWdlIGluc2lnaHRzXG4gICAgICBjb25zdCBpbnNpZ2h0cyA9IGF3YWl0IHRoaXMuZ2V0UGFnZUluc2lnaHRzKGFjY291bnRJZCwgYWNjZXNzVG9rZW4sIHN0YXJ0RGF0ZSwgZW5kRGF0ZSk7XG4gICAgICBcbiAgICAgIC8vIEZldGNoIHBvc3RzIHdpdGggZW5nYWdlbWVudCBkYXRhXG4gICAgICBjb25zdCBwb3N0cyA9IGF3YWl0IHRoaXMuZ2V0UG9zdHNXaXRoRW5nYWdlbWVudChhY2NvdW50SWQsIGFjY2Vzc1Rva2VuLCBzdGFydERhdGUsIGVuZERhdGUpO1xuICAgICAgXG4gICAgICAvLyBGZXRjaCBmb2xsb3dlciBjb3VudFxuICAgICAgY29uc3QgZm9sbG93ZXJzID0gYXdhaXQgdGhpcy5nZXRGb2xsb3dlckNvdW50KGFjY291bnRJZCwgYWNjZXNzVG9rZW4pO1xuICAgICAgXG4gICAgICAvLyBDYWxjdWxhdGUgbWV0cmljc1xuICAgICAgY29uc3QgdG90YWxFbmdhZ2VtZW50ID0gcG9zdHMucmVkdWNlKChzdW0sIHBvc3QpID0+IHtcbiAgICAgICAgY29uc3QgbGlrZXMgPSBwb3N0Lmxpa2VzPy5zdW1tYXJ5Py50b3RhbF9jb3VudCB8fCAwO1xuICAgICAgICBjb25zdCBjb21tZW50cyA9IHBvc3QuY29tbWVudHM/LnN1bW1hcnk/LnRvdGFsX2NvdW50IHx8IDA7XG4gICAgICAgIGNvbnN0IHNoYXJlcyA9IHBvc3Quc2hhcmVzPy5jb3VudCB8fCAwO1xuICAgICAgICByZXR1cm4gc3VtICsgbGlrZXMgKyBjb21tZW50cyArIHNoYXJlcztcbiAgICAgIH0sIDApO1xuXG4gICAgICBjb25zdCB0b3RhbFJlYWNoID0gaW5zaWdodHMucGFnZV9pbXByZXNzaW9ucz8uWzBdPy52YWx1ZSB8fCAwO1xuICAgICAgXG4gICAgICAvLyBHZW5lcmF0ZSBmb2xsb3dlciBoaXN0b3J5IChzaW1wbGlmaWVkIC0gaW4gcHJvZHVjdGlvbiwgc3RvcmUgaGlzdG9yaWNhbCBkYXRhKVxuICAgICAgY29uc3QgZm9sbG93ZXJIaXN0b3J5ID0gdGhpcy5nZW5lcmF0ZUZvbGxvd2VySGlzdG9yeShmb2xsb3dlcnMsIHN0YXJ0RGF0ZSwgZW5kRGF0ZSk7XG4gICAgICBcbiAgICAgIC8vIEdldCB0b3AgcGVyZm9ybWluZyBwb3N0c1xuICAgICAgY29uc3QgdG9wUG9zdHMgPSBwb3N0c1xuICAgICAgICAubWFwKHBvc3QgPT4gKHtcbiAgICAgICAgICBpZDogcG9zdC5pZCxcbiAgICAgICAgICBjb250ZW50OiBwb3N0Lm1lc3NhZ2UgfHwgJycsXG4gICAgICAgICAgZW5nYWdlbWVudDogKHBvc3QubGlrZXM/LnN1bW1hcnk/LnRvdGFsX2NvdW50IHx8IDApICsgXG4gICAgICAgICAgICAgICAgICAgICAocG9zdC5jb21tZW50cz8uc3VtbWFyeT8udG90YWxfY291bnQgfHwgMCkgKyBcbiAgICAgICAgICAgICAgICAgICAgIChwb3N0LnNoYXJlcz8uY291bnQgfHwgMCksXG4gICAgICAgICAgbGlrZXM6IHBvc3QubGlrZXM/LnN1bW1hcnk/LnRvdGFsX2NvdW50IHx8IDAsXG4gICAgICAgICAgY29tbWVudHM6IHBvc3QuY29tbWVudHM/LnN1bW1hcnk/LnRvdGFsX2NvdW50IHx8IDAsXG4gICAgICAgICAgc2hhcmVzOiBwb3N0LnNoYXJlcz8uY291bnQgfHwgMCxcbiAgICAgICAgICBjcmVhdGVkX3RpbWU6IHBvc3QuY3JlYXRlZF90aW1lXG4gICAgICAgIH0pKVxuICAgICAgICAuc29ydCgoYSwgYikgPT4gYi5lbmdhZ2VtZW50IC0gYS5lbmdhZ2VtZW50KVxuICAgICAgICAuc2xpY2UoMCwgNSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGZvbGxvd2VycyxcbiAgICAgICAgdG90YWxFbmdhZ2VtZW50LFxuICAgICAgICB0b3RhbFJlYWNoLFxuICAgICAgICBmb2xsb3dlckhpc3RvcnksXG4gICAgICAgIHBvc3RzOiBwb3N0cy5tYXAocG9zdCA9PiAoe1xuICAgICAgICAgIGlkOiBwb3N0LmlkLFxuICAgICAgICAgIGNvbnRlbnQ6IHBvc3QubWVzc2FnZSB8fCAnJyxcbiAgICAgICAgICBsaWtlczogcG9zdC5saWtlcz8uc3VtbWFyeT8udG90YWxfY291bnQgfHwgMCxcbiAgICAgICAgICBjb21tZW50czogcG9zdC5jb21tZW50cz8uc3VtbWFyeT8udG90YWxfY291bnQgfHwgMCxcbiAgICAgICAgICBzaGFyZXM6IHBvc3Quc2hhcmVzPy5jb3VudCB8fCAwLFxuICAgICAgICAgIGNyZWF0ZWRfdGltZTogcG9zdC5jcmVhdGVkX3RpbWVcbiAgICAgICAgfSkpLFxuICAgICAgICB0b3BQb3N0c1xuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgRmFjZWJvb2sgYW5hbHl0aWNzOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2V0UGFnZUluc2lnaHRzKFxuICAgIHBhZ2VJZDogc3RyaW5nLCBcbiAgICBhY2Nlc3NUb2tlbjogc3RyaW5nLCBcbiAgICBzdGFydERhdGU6IERhdGUsIFxuICAgIGVuZERhdGU6IERhdGVcbiAgKTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCBzaW5jZSA9IE1hdGguZmxvb3Ioc3RhcnREYXRlLmdldFRpbWUoKSAvIDEwMDApO1xuICAgIGNvbnN0IHVudGlsID0gTWF0aC5mbG9vcihlbmREYXRlLmdldFRpbWUoKSAvIDEwMDApO1xuICAgIFxuICAgIGNvbnN0IG1ldHJpY3MgPSBbXG4gICAgICAncGFnZV9pbXByZXNzaW9ucycsXG4gICAgICAncGFnZV9pbXByZXNzaW9uc191bmlxdWUnLFxuICAgICAgJ3BhZ2VfZW5nYWdlZF91c2VycycsXG4gICAgICAncGFnZV9mYW5fYWRkcycsXG4gICAgICAncGFnZV9mYW5fcmVtb3ZlcydcbiAgICBdLmpvaW4oJywnKTtcblxuICAgIGNvbnN0IHVybCA9IGAke3RoaXMuYmFzZVVSTH0vJHtwYWdlSWR9L2luc2lnaHRzP21ldHJpYz0ke21ldHJpY3N9JnNpbmNlPSR7c2luY2V9JnVudGlsPSR7dW50aWx9JmFjY2Vzc190b2tlbj0ke2FjY2Vzc1Rva2VufWA7XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBcbiAgICAgIGlmIChkYXRhLmVycm9yKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFjZWJvb2sgQVBJIGVycm9yOiAke2RhdGEuZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgIH1cblxuICAgICAgLy8gVHJhbnNmb3JtIGluc2lnaHRzIGRhdGEgaW50byBhIG1vcmUgdXNhYmxlIGZvcm1hdFxuICAgICAgY29uc3QgaW5zaWdodHM6IGFueSA9IHt9O1xuICAgICAgaWYgKGRhdGEuZGF0YSkge1xuICAgICAgICBkYXRhLmRhdGEuZm9yRWFjaCgoaW5zaWdodDogYW55KSA9PiB7XG4gICAgICAgICAgaW5zaWdodHNbaW5zaWdodC5uYW1lXSA9IGluc2lnaHQudmFsdWVzLm1hcCgodmFsdWU6IGFueSkgPT4gKHtcbiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZS52YWx1ZSxcbiAgICAgICAgICAgIGVuZF90aW1lOiB2YWx1ZS5lbmRfdGltZVxuICAgICAgICAgIH0pKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBpbnNpZ2h0cztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcGFnZSBpbnNpZ2h0czonLCBlcnJvcik7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZXRQb3N0c1dpdGhFbmdhZ2VtZW50KFxuICAgIHBhZ2VJZDogc3RyaW5nLCBcbiAgICBhY2Nlc3NUb2tlbjogc3RyaW5nLCBcbiAgICBzdGFydERhdGU6IERhdGUsIFxuICAgIGVuZERhdGU6IERhdGVcbiAgKTogUHJvbWlzZTxGYWNlYm9va1Bvc3RbXT4ge1xuICAgIGNvbnN0IHNpbmNlID0gc3RhcnREYXRlLnRvSVNPU3RyaW5nKCk7XG4gICAgY29uc3QgZmllbGRzID0gJ2lkLG1lc3NhZ2UsY3JlYXRlZF90aW1lLGxpa2VzLnN1bW1hcnkodHJ1ZSksY29tbWVudHMuc3VtbWFyeSh0cnVlKSxzaGFyZXMnO1xuICAgIFxuICAgIGNvbnN0IHVybCA9IGAke3RoaXMuYmFzZVVSTH0vJHtwYWdlSWR9L3Bvc3RzP2ZpZWxkcz0ke2ZpZWxkc30mc2luY2U9JHtzaW5jZX0mYWNjZXNzX3Rva2VuPSR7YWNjZXNzVG9rZW59YDtcbiAgICBcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIFxuICAgICAgaWYgKGRhdGEuZXJyb3IpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWNlYm9vayBBUEkgZXJyb3I6ICR7ZGF0YS5lcnJvci5tZXNzYWdlfWApO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZGF0YS5kYXRhIHx8IFtdO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBwb3N0czonLCBlcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZXRGb2xsb3dlckNvdW50KHBhZ2VJZDogc3RyaW5nLCBhY2Nlc3NUb2tlbjogc3RyaW5nKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmJhc2VVUkx9LyR7cGFnZUlkfT9maWVsZHM9ZmFuX2NvdW50JmFjY2Vzc190b2tlbj0ke2FjY2Vzc1Rva2VufWA7XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBcbiAgICAgIGlmIChkYXRhLmVycm9yKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFjZWJvb2sgQVBJIGVycm9yOiAke2RhdGEuZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGRhdGEuZmFuX2NvdW50IHx8IDA7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGZvbGxvd2VyIGNvdW50OicsIGVycm9yKTtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVGb2xsb3dlckhpc3RvcnkoY3VycmVudEZvbGxvd2VyczogbnVtYmVyLCBzdGFydERhdGU6IERhdGUsIGVuZERhdGU6IERhdGUpOiBhbnlbXSB7XG4gICAgY29uc3QgZGF5cyA9IE1hdGguY2VpbCgoZW5kRGF0ZS5nZXRUaW1lKCkgLSBzdGFydERhdGUuZ2V0VGltZSgpKSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSk7XG4gICAgY29uc3QgaGlzdG9yeSA9IFtdO1xuICAgIFxuICAgIC8vIEdlbmVyYXRlIGEgcmVhbGlzdGljIGdyb3d0aCBwYXR0ZXJuIChpbiBwcm9kdWN0aW9uLCBzdG9yZSBhY3R1YWwgaGlzdG9yaWNhbCBkYXRhKVxuICAgIGxldCBjdXJyZW50Q291bnQgPSBNYXRoLm1heCgwLCBjdXJyZW50Rm9sbG93ZXJzIC0gTWF0aC5mbG9vcihkYXlzICogMikpOyAvLyBBc3N1bWUgfjIgbmV3IGZvbGxvd2VycyBwZXIgZGF5XG4gICAgXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gZGF5czsgaSsrKSB7XG4gICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoc3RhcnREYXRlLmdldFRpbWUoKSArIGkgKiAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICAgIFxuICAgICAgLy8gQWRkIHNvbWUgcmFuZG9tbmVzcyB0byBtYWtlIGl0IGxvb2sgcmVhbGlzdGljXG4gICAgICBjb25zdCBkYWlseUdyb3d0aCA9IE1hdGgucmFuZG9tKCkgPiAwLjMgPyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA1KSArIDEgOiAwO1xuICAgICAgY3VycmVudENvdW50ICs9IGRhaWx5R3Jvd3RoO1xuICAgICAgXG4gICAgICBoaXN0b3J5LnB1c2goe1xuICAgICAgICBkYXRlOiBkYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSxcbiAgICAgICAgZm9sbG93ZXJzOiBjdXJyZW50Q291bnRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gaGlzdG9yeTtcbiAgfVxuXG4gIGFzeW5jIGdldEluc3RhZ3JhbUFuYWx5dGljcyhcbiAgICBpbnN0YWdyYW1BY2NvdW50SWQ6IHN0cmluZyxcbiAgICBhY2Nlc3NUb2tlbjogc3RyaW5nLFxuICAgIHN0YXJ0RGF0ZTogRGF0ZSxcbiAgICBlbmREYXRlOiBEYXRlXG4gICk6IFByb21pc2U8RmFjZWJvb2tBbmFseXRpY3M+IHtcbiAgICB0cnkge1xuICAgICAgLy8gSW5zdGFncmFtIEJ1c2luZXNzIEFjY291bnQgYW5hbHl0aWNzXG4gICAgICBjb25zdCBpbnNpZ2h0cyA9IGF3YWl0IHRoaXMuZ2V0SW5zdGFncmFtSW5zaWdodHMoaW5zdGFncmFtQWNjb3VudElkLCBhY2Nlc3NUb2tlbiwgc3RhcnREYXRlLCBlbmREYXRlKTtcbiAgICAgIFxuICAgICAgLy8gR2V0IG1lZGlhIChwb3N0cykgd2l0aCBlbmdhZ2VtZW50XG4gICAgICBjb25zdCBtZWRpYSA9IGF3YWl0IHRoaXMuZ2V0SW5zdGFncmFtTWVkaWEoaW5zdGFncmFtQWNjb3VudElkLCBhY2Nlc3NUb2tlbiwgc3RhcnREYXRlLCBlbmREYXRlKTtcbiAgICAgIFxuICAgICAgLy8gR2V0IGZvbGxvd2VyIGNvdW50XG4gICAgICBjb25zdCBmb2xsb3dlcnMgPSBhd2FpdCB0aGlzLmdldEluc3RhZ3JhbUZvbGxvd2VyQ291bnQoaW5zdGFncmFtQWNjb3VudElkLCBhY2Nlc3NUb2tlbik7XG4gICAgICBcbiAgICAgIC8vIENhbGN1bGF0ZSBtZXRyaWNzXG4gICAgICBjb25zdCB0b3RhbEVuZ2FnZW1lbnQgPSBtZWRpYS5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4ge1xuICAgICAgICBjb25zdCBsaWtlcyA9IGl0ZW0ubGlrZV9jb3VudCB8fCAwO1xuICAgICAgICBjb25zdCBjb21tZW50cyA9IGl0ZW0uY29tbWVudHNfY291bnQgfHwgMDtcbiAgICAgICAgcmV0dXJuIHN1bSArIGxpa2VzICsgY29tbWVudHM7XG4gICAgICB9LCAwKTtcblxuICAgICAgY29uc3QgdG90YWxSZWFjaCA9IGluc2lnaHRzLmltcHJlc3Npb25zPy5bMF0/LnZhbHVlIHx8IDA7XG4gICAgICBcbiAgICAgIC8vIEdlbmVyYXRlIGZvbGxvd2VyIGhpc3RvcnlcbiAgICAgIGNvbnN0IGZvbGxvd2VySGlzdG9yeSA9IHRoaXMuZ2VuZXJhdGVGb2xsb3dlckhpc3RvcnkoZm9sbG93ZXJzLCBzdGFydERhdGUsIGVuZERhdGUpO1xuICAgICAgXG4gICAgICAvLyBHZXQgdG9wIHBlcmZvcm1pbmcgbWVkaWFcbiAgICAgIGNvbnN0IHRvcFBvc3RzID0gbWVkaWFcbiAgICAgICAgLm1hcChpdGVtID0+ICh7XG4gICAgICAgICAgaWQ6IGl0ZW0uaWQsXG4gICAgICAgICAgY29udGVudDogaXRlbS5jYXB0aW9uPy5zdWJzdHJpbmcoMCwgMTAwKSB8fCAnJyxcbiAgICAgICAgICBlbmdhZ2VtZW50OiAoaXRlbS5saWtlX2NvdW50IHx8IDApICsgKGl0ZW0uY29tbWVudHNfY291bnQgfHwgMCksXG4gICAgICAgICAgbGlrZXM6IGl0ZW0ubGlrZV9jb3VudCB8fCAwLFxuICAgICAgICAgIGNvbW1lbnRzOiBpdGVtLmNvbW1lbnRzX2NvdW50IHx8IDAsXG4gICAgICAgICAgc2hhcmVzOiAwLCAvLyBJbnN0YWdyYW0gZG9lc24ndCBoYXZlIHNoYXJlc1xuICAgICAgICAgIGNyZWF0ZWRfdGltZTogaXRlbS50aW1lc3RhbXBcbiAgICAgICAgfSkpXG4gICAgICAgIC5zb3J0KChhLCBiKSA9PiBiLmVuZ2FnZW1lbnQgLSBhLmVuZ2FnZW1lbnQpXG4gICAgICAgIC5zbGljZSgwLCA1KTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZm9sbG93ZXJzLFxuICAgICAgICB0b3RhbEVuZ2FnZW1lbnQsXG4gICAgICAgIHRvdGFsUmVhY2gsXG4gICAgICAgIGZvbGxvd2VySGlzdG9yeSxcbiAgICAgICAgcG9zdHM6IG1lZGlhLm1hcChpdGVtID0+ICh7XG4gICAgICAgICAgaWQ6IGl0ZW0uaWQsXG4gICAgICAgICAgY29udGVudDogaXRlbS5jYXB0aW9uPy5zdWJzdHJpbmcoMCwgMTAwKSB8fCAnJyxcbiAgICAgICAgICBsaWtlczogaXRlbS5saWtlX2NvdW50IHx8IDAsXG4gICAgICAgICAgY29tbWVudHM6IGl0ZW0uY29tbWVudHNfY291bnQgfHwgMCxcbiAgICAgICAgICBzaGFyZXM6IDAsXG4gICAgICAgICAgY3JlYXRlZF90aW1lOiBpdGVtLnRpbWVzdGFtcFxuICAgICAgICB9KSksXG4gICAgICAgIHRvcFBvc3RzXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBJbnN0YWdyYW0gYW5hbHl0aWNzOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2V0SW5zdGFncmFtSW5zaWdodHMoXG4gICAgaW5zdGFncmFtQWNjb3VudElkOiBzdHJpbmcsXG4gICAgYWNjZXNzVG9rZW46IHN0cmluZyxcbiAgICBzdGFydERhdGU6IERhdGUsXG4gICAgZW5kRGF0ZTogRGF0ZVxuICApOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IHNpbmNlID0gTWF0aC5mbG9vcihzdGFydERhdGUuZ2V0VGltZSgpIC8gMTAwMCk7XG4gICAgY29uc3QgdW50aWwgPSBNYXRoLmZsb29yKGVuZERhdGUuZ2V0VGltZSgpIC8gMTAwMCk7XG4gICAgXG4gICAgY29uc3QgbWV0cmljcyA9IFtcbiAgICAgICdpbXByZXNzaW9ucycsXG4gICAgICAncmVhY2gnLFxuICAgICAgJ3Byb2ZpbGVfdmlld3MnLFxuICAgICAgJ3dlYnNpdGVfY2xpY2tzJ1xuICAgIF0uam9pbignLCcpO1xuXG4gICAgY29uc3QgdXJsID0gYCR7dGhpcy5iYXNlVVJMfS8ke2luc3RhZ3JhbUFjY291bnRJZH0vaW5zaWdodHM/bWV0cmljPSR7bWV0cmljc30mc2luY2U9JHtzaW5jZX0mdW50aWw9JHt1bnRpbH0mcGVyaW9kPWRheSZhY2Nlc3NfdG9rZW49JHthY2Nlc3NUb2tlbn1gO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCk7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgXG4gICAgICBpZiAoZGF0YS5lcnJvcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluc3RhZ3JhbSBBUEkgZXJyb3I6ICR7ZGF0YS5lcnJvci5tZXNzYWdlfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBpbnNpZ2h0czogYW55ID0ge307XG4gICAgICBpZiAoZGF0YS5kYXRhKSB7XG4gICAgICAgIGRhdGEuZGF0YS5mb3JFYWNoKChpbnNpZ2h0OiBhbnkpID0+IHtcbiAgICAgICAgICBpbnNpZ2h0c1tpbnNpZ2h0Lm5hbWVdID0gaW5zaWdodC52YWx1ZXMubWFwKCh2YWx1ZTogYW55KSA9PiAoe1xuICAgICAgICAgICAgdmFsdWU6IHZhbHVlLnZhbHVlLFxuICAgICAgICAgICAgZW5kX3RpbWU6IHZhbHVlLmVuZF90aW1lXG4gICAgICAgICAgfSkpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGluc2lnaHRzO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBJbnN0YWdyYW0gaW5zaWdodHM6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2V0SW5zdGFncmFtTWVkaWEoXG4gICAgaW5zdGFncmFtQWNjb3VudElkOiBzdHJpbmcsXG4gICAgYWNjZXNzVG9rZW46IHN0cmluZyxcbiAgICBzdGFydERhdGU6IERhdGUsXG4gICAgZW5kRGF0ZTogRGF0ZVxuICApOiBQcm9taXNlPGFueVtdPiB7XG4gICAgY29uc3Qgc2luY2UgPSBzdGFydERhdGUudG9JU09TdHJpbmcoKTtcbiAgICBjb25zdCBmaWVsZHMgPSAnaWQsY2FwdGlvbixsaWtlX2NvdW50LGNvbW1lbnRzX2NvdW50LHRpbWVzdGFtcCxtZWRpYV90eXBlLG1lZGlhX3VybCc7XG4gICAgXG4gICAgY29uc3QgdXJsID0gYCR7dGhpcy5iYXNlVVJMfS8ke2luc3RhZ3JhbUFjY291bnRJZH0vbWVkaWE/ZmllbGRzPSR7ZmllbGRzfSZzaW5jZT0ke3NpbmNlfSZhY2Nlc3NfdG9rZW49JHthY2Nlc3NUb2tlbn1gO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCk7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgXG4gICAgICBpZiAoZGF0YS5lcnJvcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluc3RhZ3JhbSBBUEkgZXJyb3I6ICR7ZGF0YS5lcnJvci5tZXNzYWdlfWApO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZGF0YS5kYXRhIHx8IFtdO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBJbnN0YWdyYW0gbWVkaWE6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2V0SW5zdGFncmFtRm9sbG93ZXJDb3VudChpbnN0YWdyYW1BY2NvdW50SWQ6IHN0cmluZywgYWNjZXNzVG9rZW46IHN0cmluZyk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgY29uc3QgdXJsID0gYCR7dGhpcy5iYXNlVVJMfS8ke2luc3RhZ3JhbUFjY291bnRJZH0/ZmllbGRzPWZvbGxvd2Vyc19jb3VudCZhY2Nlc3NfdG9rZW49JHthY2Nlc3NUb2tlbn1gO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCk7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgXG4gICAgICBpZiAoZGF0YS5lcnJvcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEluc3RhZ3JhbSBBUEkgZXJyb3I6ICR7ZGF0YS5lcnJvci5tZXNzYWdlfWApO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZGF0YS5mb2xsb3dlcnNfY291bnQgfHwgMDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgSW5zdGFncmFtIGZvbGxvd2VyIGNvdW50OicsIGVycm9yKTtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfVxuXG4gIC8vIFV0aWxpdHkgbWV0aG9kIHRvIGNoZWNrIGlmIHRva2VuIGlzIHZhbGlkXG4gIGFzeW5jIHZhbGlkYXRlVG9rZW4oYWNjZXNzVG9rZW46IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IHVybCA9IGAke3RoaXMuYmFzZVVSTH0vbWU/YWNjZXNzX3Rva2VuPSR7YWNjZXNzVG9rZW59YDtcbiAgICBcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIFxuICAgICAgcmV0dXJuICFkYXRhLmVycm9yO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLy8gTWV0aG9kIHRvIHJlZnJlc2ggdG9rZW4gKGlmIHlvdSBoYXZlIHJlZnJlc2ggdG9rZW4gY2FwYWJpbGl0eSlcbiAgYXN5bmMgcmVmcmVzaFRva2VuKHJlZnJlc2hUb2tlbjogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgLy8gVGhpcyB3b3VsZCByZXF1aXJlIHlvdXIgYXBwIHRvIGhhdmUgb2ZmbGluZV9hY2Nlc3MgcGVybWlzc2lvblxuICAgIC8vIGFuZCBpbXBsZW1lbnQgdG9rZW4gcmVmcmVzaCBsb2dpY1xuICAgIC8vIEZvciBub3csIHJldHVybiBudWxsIHRvIGluZGljYXRlIHJlZnJlc2ggaXMgbm90IGF2YWlsYWJsZVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLy8gU2VuZCBhIG1lc3NhZ2UgdG8gYSB1c2VyXG4gIGFzeW5jIHNlbmRNZXNzYWdlKFxuICAgIGFjY291bnRJZDogc3RyaW5nLFxuICAgIHJlY2lwaWVudElkOiBzdHJpbmcsXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIHBsYXRmb3JtOiAnRkFDRUJPT0snIHwgJ0lOU1RBR1JBTSdcbiAgKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEdldCB0aGUgc29jaWFsIGFjY291bnQgdG8gcmV0cmlldmUgYWNjZXNzIHRva2VuXG4gICAgICBjb25zdCBzb2NpYWxBY2NvdW50ID0gYXdhaXQgZGIuc29jaWFsQWNjb3VudC5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxuICAgICAgICBzZWxlY3Q6IHsgYWNjZXNzVG9rZW46IHRydWUgfVxuICAgICAgfSk7XG5cbiAgICAgIGlmICghc29jaWFsQWNjb3VudD8uYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBY2Nlc3MgdG9rZW4gbm90IGZvdW5kIGZvciBhY2NvdW50Jyk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gc29jaWFsQWNjb3VudC5hY2Nlc3NUb2tlbjtcbiAgICAgIFxuICAgICAgLy8gRm9yIEZhY2Vib29rLCB3ZSB1c2UgdGhlIFNlbmQgQVBJXG4gICAgICBpZiAocGxhdGZvcm0gPT09ICdGQUNFQk9PSycpIHtcbiAgICAgICAgY29uc3QgdXJsID0gYCR7dGhpcy5iYXNlVVJMfS9tZS9tZXNzYWdlcz9hY2Nlc3NfdG9rZW49JHthY2Nlc3NUb2tlbn1gO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgcmVjaXBpZW50OiB7XG4gICAgICAgICAgICAgIGlkOiByZWNpcGllbnRJZFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgdGV4dDogbWVzc2FnZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoZGF0YS5lcnJvcikge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFjZWJvb2sgQVBJIGVycm9yOiAke2RhdGEuZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBGb3IgSW5zdGFncmFtLCB3ZSBuZWVkIHRvIHVzZSBJbnN0YWdyYW0gQmFzaWMgRGlzcGxheSBBUEkgb3IgSW5zdGFncmFtIEdyYXBoIEFQSVxuICAgICAgLy8gTm90ZTogSW5zdGFncmFtIG1lc3NhZ2luZyByZXF1aXJlcyBzcGVjaWFsIHBlcm1pc3Npb25zIGFuZCBzZXR1cFxuICAgICAgaWYgKHBsYXRmb3JtID09PSAnSU5TVEFHUkFNJykge1xuICAgICAgICAvLyBJbnN0YWdyYW0gbWVzc2FnaW5nIGlzIG1vcmUgY29tcGxleCBhbmQgcmVxdWlyZXMgc3BlY2lmaWMgc2V0dXBcbiAgICAgICAgLy8gRm9yIG5vdywgd2UnbGwgbG9nIHRoYXQgaXQncyBub3QgaW1wbGVtZW50ZWRcbiAgICAgICAgbG9nZ2VyLndhcm4oJ0luc3RhZ3JhbSBtZXNzYWdpbmcgbm90IHlldCBpbXBsZW1lbnRlZCcsIHsgYWNjb3VudElkLCByZWNpcGllbnRJZCB9KTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3Igc2VuZGluZyBtZXNzYWdlJywge1xuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgIGFjY291bnRJZCxcbiAgICAgICAgcmVjaXBpZW50SWQsXG4gICAgICAgIHBsYXRmb3JtXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbn0iXSwibmFtZXMiOlsiZGIiLCJsb2dnZXIiLCJGYWNlYm9va1NlcnZpY2UiLCJnZXRBY2NvdW50QW5hbHl0aWNzIiwiYWNjb3VudElkIiwiYWNjZXNzVG9rZW4iLCJzdGFydERhdGUiLCJlbmREYXRlIiwiaW5zaWdodHMiLCJnZXRQYWdlSW5zaWdodHMiLCJwb3N0cyIsImdldFBvc3RzV2l0aEVuZ2FnZW1lbnQiLCJmb2xsb3dlcnMiLCJnZXRGb2xsb3dlckNvdW50IiwidG90YWxFbmdhZ2VtZW50IiwicmVkdWNlIiwic3VtIiwicG9zdCIsImxpa2VzIiwic3VtbWFyeSIsInRvdGFsX2NvdW50IiwiY29tbWVudHMiLCJzaGFyZXMiLCJjb3VudCIsInRvdGFsUmVhY2giLCJwYWdlX2ltcHJlc3Npb25zIiwidmFsdWUiLCJmb2xsb3dlckhpc3RvcnkiLCJnZW5lcmF0ZUZvbGxvd2VySGlzdG9yeSIsInRvcFBvc3RzIiwibWFwIiwiaWQiLCJjb250ZW50IiwibWVzc2FnZSIsImVuZ2FnZW1lbnQiLCJjcmVhdGVkX3RpbWUiLCJzb3J0IiwiYSIsImIiLCJzbGljZSIsImVycm9yIiwiY29uc29sZSIsInBhZ2VJZCIsInNpbmNlIiwiTWF0aCIsImZsb29yIiwiZ2V0VGltZSIsInVudGlsIiwibWV0cmljcyIsImpvaW4iLCJ1cmwiLCJiYXNlVVJMIiwicmVzcG9uc2UiLCJmZXRjaCIsImRhdGEiLCJqc29uIiwiRXJyb3IiLCJmb3JFYWNoIiwiaW5zaWdodCIsIm5hbWUiLCJ2YWx1ZXMiLCJlbmRfdGltZSIsInRvSVNPU3RyaW5nIiwiZmllbGRzIiwiZmFuX2NvdW50IiwiY3VycmVudEZvbGxvd2VycyIsImRheXMiLCJjZWlsIiwiaGlzdG9yeSIsImN1cnJlbnRDb3VudCIsIm1heCIsImkiLCJkYXRlIiwiRGF0ZSIsImRhaWx5R3Jvd3RoIiwicmFuZG9tIiwicHVzaCIsInNwbGl0IiwiZ2V0SW5zdGFncmFtQW5hbHl0aWNzIiwiaW5zdGFncmFtQWNjb3VudElkIiwiZ2V0SW5zdGFncmFtSW5zaWdodHMiLCJtZWRpYSIsImdldEluc3RhZ3JhbU1lZGlhIiwiZ2V0SW5zdGFncmFtRm9sbG93ZXJDb3VudCIsIml0ZW0iLCJsaWtlX2NvdW50IiwiY29tbWVudHNfY291bnQiLCJpbXByZXNzaW9ucyIsImNhcHRpb24iLCJzdWJzdHJpbmciLCJ0aW1lc3RhbXAiLCJmb2xsb3dlcnNfY291bnQiLCJ2YWxpZGF0ZVRva2VuIiwicmVmcmVzaFRva2VuIiwic2VuZE1lc3NhZ2UiLCJyZWNpcGllbnRJZCIsInBsYXRmb3JtIiwic29jaWFsQWNjb3VudCIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsInNlbGVjdCIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInJlY2lwaWVudCIsInRleHQiLCJ3YXJuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/facebook-service.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/next-auth","vendor-chunks/@babel","vendor-chunks/jose","vendor-chunks/openid-client","vendor-chunks/bcryptjs","vendor-chunks/oauth","vendor-chunks/preact","vendor-chunks/preact-render-to-string","vendor-chunks/uuid","vendor-chunks/yallist","vendor-chunks/@auth","vendor-chunks/oidc-token-hash","vendor-chunks/@panva"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalytics%2Fdashboard%2Froute&page=%2Fapi%2Fanalytics%2Fdashboard%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalytics%2Fdashboard%2Froute.ts&appDir=I%3A%5CTRAE%20Solo%5CSocialPiloat%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=I%3A%5CTRAE%20Solo%5CSocialPiloat&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();